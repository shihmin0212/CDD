import{d as F,r as G,s as f,b as Q,w as H,c as d,f as t,x as w,h as c,t as s,y as C,g as J,v as R,n as m,F as U,A as V,B as h,H as k,k as D,e as n,R as j,T as W,z as r,D as T,E as M,S as K,J as v,K as p,_ as O}from"./index-tYXX4zXZ.js";import{_ as P}from"./Pagination.vue_vue_type_script_setup_true_lang-CTE3-Uu0.js";import{J as $}from"./JsonFormModal-D_HC101j.js";const X=()=>({modalId:"docTypeModal",title:"新增文件類型",showModal:!1,size:"modal-xl",staticBackdrop:!0,fieldGroups:[{title:"",gridClass:"col-12",fields:[{modelId:"permission",name:"permission",type:"radio",label:"文件類別權限",inline:!0,options:[{label:"不限制任何系統 (Public)",value:"0"},{label:"限制註冊系統 (Protect)",value:"1"},{label:"限制白名單系統 (ProtectInternal)",value:"2"},{label:"自己才可存取 (Private)",value:"3"}],required:!0},{modelId:"docName",name:"docName",type:"text",label:"文件名稱",placeholder:"請輸入文件名稱",required:!0,maxlength:50},{modelId:"description",name:"description",type:"text",label:"描述",placeholder:"請輸入描述",required:!1,maxlength:100}]}]}),Y=()=>({docType:null,docName:"",description:null,permission:"0"}),Z=()=>({modalId:"updateDocTypeModal",title:"修改文件類型",showModal:!1,size:"modal-xl",staticBackdrop:!0,fieldGroups:[{title:"",gridClass:"col-12",fields:[{modelId:"docType",name:"docType",type:"text",label:"文件類型代碼",placeholder:"請輸入文件類型代碼",required:!0,maxlength:1,disabled:!0},{modelId:"docName",name:"docName",type:"text",label:"文件名稱",placeholder:"請輸入文件名稱",required:!0,maxlength:50},{modelId:"description",name:"description",type:"text",label:"描述",placeholder:"請輸入描述",required:!1,maxlength:100},{modelId:"permission",name:"permission",type:"select",label:"權限",required:!0,options:[{label:"公開",value:"0"},{label:"保護",value:"1"},{label:"內部保護",value:"2"},{label:"私人",value:"3"}]},{modelId:"isDeleted",name:"isDeleted",type:"radio",label:"是否刪除",inline:!0,options:[{label:"刪除",value:!0},{label:"不刪除",value:!1}],required:!0}]}]}),_={class:"p-4 mt-5"},ee={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},te={class:"h2"},le={class:"btn-toolbar justify-content-end mb-3",role:"toolbar","aria-label":"Toolbar with button groups"},ae={class:"btn-group me-2",role:"group","aria-label":"First group"},oe={class:"input-group ms-3",style:{"max-width":"200px"}},se={class:"btn-group",role:"group"},ne={class:"card card-esun h-100 esun-animate-in"},re={class:"card-body"},de={class:"card-title"},ie={class:"card-text"},ue={class:"dropdown mt-3"},pe={class:"dropdown-menu w-100"},ce=["onClick"],me={key:0},be=["onClick"],ye={class:"table table-bordered table-hover align-middle"},ge={class:"dropdown"},ve={class:"dropdown-menu w-100"},fe=["onClick"],we={key:0},he=["onClick"],ke=F({__name:"DocTypeManagement",props:{collapsed:{type:Boolean},paginationType:{}},setup(De){const a=G({paginationType:"server",DocTypeDataList:[],totalItems:0,pageNumber:1,pageSize:10,displayMode:"card",searchQuery:"",createdTime:"",lastUpdate:""}),b=f(X()),q=f(Y()),y=new K,g=f(Z()),x=f({docType:0,docName:"",description:null,permission:"0",isDeleted:!1,createdTime:"",lastUpdate:""}),u=async()=>{var o;try{const e=await h.DocTypeManagementViewData(a.pageNumber,a.pageSize,a.searchQuery);e.status&&((o=e.result)!=null&&o.items)?(a.DocTypeDataList=e.result.items,a.totalItems=e.result.totalCount):k(e)}catch(e){D(e),console.error("Error fetching docTypes:",e)}};Q(async()=>{await u()}),H(()=>({pageNumber:a.pageNumber,pageSize:a.pageSize}),()=>{u()});function B(){b.value.showModal=!0}async function L(o){const e=o;try{const l=await h.DocTypeManagementCreate(e);l.status?y.showAlert(v.Success,"成功",'文件類型 "'.concat(e.docName,'" 已成功建立。'),[{id:"ok",type:p.callback,btnClass:"btn-success",resolveParam:"ok",title:"確定"}]).then(async()=>{await u()}):k(l)}catch(l){D(l)}b.value.showModal=!1}function S(o){switch(o){case"0":return"公開";case"1":return"保護";case"2":return"內部保護";case"3":return"私人";default:return"-"}}const N=W(()=>{a.searchQuery&&(a.pageNumber=1,u())},100),A=()=>{a.searchQuery="",a.pageNumber=1,u()};function I(o){x.value={...o},g.value.showModal=!0}async function E(o){const e=o;if((await y.showAlert(v.Warning,"警告",'確定要更新文件類型 "'.concat(e.docName,'" 嗎？'),[{id:"cancel",type:p.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:p.callback,btnClass:"btn-esun-primary",resolveParam:"confirm",title:"確定"}])).param==="confirm")try{const i=await h.DocTypeManagementUpdate(e);i.status?y.showAlert(v.Success,"成功",'文件類型 "'.concat(e.docName,'" 已成功更新。'),[{id:"ok",type:p.callback,btnClass:"btn-success",resolveParam:"ok",title:"確定"}]).then(async()=>{await u()}):k(i)}catch(i){D(i)}g.value.showModal=!1}async function z(o){if((await y.showAlert(v.Warning,"警告",'確定要刪除文件類型 "'.concat(o.docName,'" 嗎？此操作將進行軟刪除。'),[{id:"cancel",type:p.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:p.callback,btnClass:"btn-danger",resolveParam:"confirm",title:"確定刪除"}])).param==="confirm")try{const l=await h.DocTypeManagementDelete(o.docType);l.status?y.showAlert(v.Success,"成功",'文件類型 "'.concat(o.docName,'" 已成功刪除。'),[{id:"ok",type:p.callback,btnClass:"btn-success",resolveParam:"ok",title:"確定"}]).then(async()=>{await u()}):k(l)}catch(l){D(l)}}return(o,e)=>(n(),d("div",_,[t("div",ee,[t("h1",te,s(C(j).DocTypeManagement.label),1),t("div",le,[t("div",ae,[t("div",oe,[J(t("input",{type:"text",class:"form-control",placeholder:"搜尋文件名稱","onUpdate:modelValue":e[0]||(e[0]=l=>a.searchQuery=l)},null,512),[[R,a.searchQuery]]),t("div",{class:"btn-close position-absolute end-0 top-50 translate-middle cursor-pointer shadow-none",onClick:A,"aria-label":"清除搜尋"},e[11]||(e[11]=[t("button",{class:"btn btn-link p-0","aria-label":"Close"},null,-1)]))]),t("button",{class:"btn btn-sm btn-esun-outline ml-3",onClick:e[1]||(e[1]=(...l)=>C(N)&&C(N)(...l))},"搜尋"),t("button",{class:"btn btn-esun-primary ml-3",onClick:B},"新增文件類型")]),b.value.showModal?(n(),w($,{key:0,myModal:b.value,modelValue:q.value,onSubmit:L,onCancel:e[2]||(e[2]=l=>b.value.showModal=!1)},null,8,["myModal","modelValue"])):c("",!0),t("div",se,[t("button",{class:m(["btn btn-esun-outline",{active:a.displayMode==="card"}]),onClick:e[3]||(e[3]=l=>a.displayMode="card")}," 卡片模式 ",2),t("button",{class:m(["btn btn-esun-outline",{active:a.displayMode==="table"}]),onClick:e[4]||(e[4]=l=>a.displayMode="table")}," 表格模式 ",2)])])]),a.totalItems?(n(),w(P,{key:0,modelValue:a.pageNumber,"onUpdate:modelValue":e[5]||(e[5]=l=>a.pageNumber=l),pageSize:a.pageSize,"onUpdate:pageSize":e[6]||(e[6]=l=>a.pageSize=l),"total-items":a.totalItems},null,8,["modelValue","pageSize","total-items"])):c("",!0),a.displayMode==="card"?(n(),d("div",{key:1,class:m(["row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 active",{"fade-in":a.pageNumber}]),ref:"dataContainer"},[(n(!0),d(U,null,V(a.DocTypeDataList,l=>(n(),d("div",{class:"col",key:l.docType},[t("div",ne,[t("div",re,[t("h5",de,s(l.docName),1),t("p",ie,[e[12]||(e[12]=t("strong",null,"文件類型代碼:",-1)),r(" "+s(l.docType),1),e[13]||(e[13]=t("br",null,null,-1)),e[14]||(e[14]=t("strong",null,"描述:",-1)),r(" "+s(l.description||"-"),1),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=t("strong",null,"權限:",-1)),r(" "+s(S(l.permission)),1),e[17]||(e[17]=t("br",null,null,-1)),e[18]||(e[18]=t("strong",null,"是否軟刪除:",-1)),t("span",{class:m(l.isDeleted?"text-success":"text-danger")},s(l.isDeleted?"是":"否"),3),e[19]||(e[19]=t("br",null,null,-1)),e[20]||(e[20]=t("strong",null,"建立時間:",-1)),r(" "+s(T(l.createdTime)),1),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=t("strong",null,"更新時間:",-1)),r(" "+s(T(l.lastUpdate)),1)]),t("div",ue,[e[25]||(e[25]=t("button",{class:"btn btn-esun-outline dropdown-toggle w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"bi bi-gear me-1"}),r(" 操作選單 ")],-1)),t("ul",pe,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:M(i=>I(l),["prevent"])},e[23]||(e[23]=[t("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),r(" 修改 ")]),8,ce)]),l.isDeleted?c("",!0):(n(),d("li",me,[t("a",{class:"dropdown-item",href:"#",onClick:M(i=>z(l),["prevent"])},e[24]||(e[24]=[t("i",{class:"bi bi-trash me-1 text-danger"},null,-1),r(" 刪除 ")]),8,be)]))])])])])]))),128))],2)):(n(),d("div",{key:2,class:m([{"fade-in":a.pageNumber},"active"]),ref:"dataContainer",style:{overflow:"auto"}},[t("table",ye,[e[29]||(e[29]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"文件類型代碼"),t("th",null,"文件名稱"),t("th",null,"描述"),t("th",null,"權限"),t("th",null,"是否軟刪除"),t("th",null,"建立時間"),t("th",null,"更新時間"),t("th",null,"操作選單")])],-1)),t("tbody",null,[(n(!0),d(U,null,V(a.DocTypeDataList,l=>(n(),d("tr",{key:l.docType},[t("td",null,s(l.docType),1),t("td",null,s(l.docName),1),t("td",null,s(l.description||"-"),1),t("td",null,s(S(l.permission)),1),t("td",null,[t("span",{class:m(l.isDeleted?"text-success":"text-danger")},s(l.isDeleted?"是":"否"),3)]),t("td",null,s(T(l.createdTime)),1),t("td",null,s(T(l.lastUpdate)),1),t("td",null,[t("div",ge,[e[28]||(e[28]=t("button",{class:"btn dropdown-toggle w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"bi bi-gear me-1"}),r(" 操作選單 ")],-1)),t("ul",ve,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:M(i=>I(l),["prevent"])},e[26]||(e[26]=[t("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),r(" 修改 ")]),8,fe)]),l.isDeleted?c("",!0):(n(),d("li",we,[t("a",{class:"dropdown-item",href:"#",onClick:M(i=>z(l),["prevent"])},e[27]||(e[27]=[t("i",{class:"bi bi-trash me-1 text-danger"},null,-1),r(" 刪除 ")]),8,he)]))])])])]))),128))])])],2)),g.value.showModal?(n(),w($,{key:3,myModal:g.value,modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=l=>x.value=l),onSubmit:E,onCancel:e[8]||(e[8]=l=>g.value.showModal=!1)},null,8,["myModal","modelValue"])):c("",!0),a.totalItems?(n(),w(P,{key:4,modelValue:a.pageNumber,"onUpdate:modelValue":e[9]||(e[9]=l=>a.pageNumber=l),pageSize:a.pageSize,"onUpdate:pageSize":e[10]||(e[10]=l=>a.pageSize=l),"total-items":a.totalItems},null,8,["modelValue","pageSize","total-items"])):c("",!0)]))}}),Se=O(ke,[["__scopeId","data-v-8f4cafe1"]]);export{Se as default};
//# sourceMappingURL=DocTypeManagement-BJ7S-Tg5.js.map
