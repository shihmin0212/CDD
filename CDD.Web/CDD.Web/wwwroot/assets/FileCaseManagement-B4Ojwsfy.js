import{d as Q,s as w,r as G,c as p,e as r,F as W,h as y,x as z,n as P,f as e,t as h,E as L,z as M,g as C,v as F,U as E,B as S,H as $,_ as J,w as H,A as X,k as j,S as ae,J as q,K as N,b as oe,V as ne,y as K,R as ie,T as re,l as te}from"./index-tYXX4zXZ.js";import{_ as Y}from"./Pagination.vue_vue_type_script_setup_true_lang-CTE3-Uu0.js";import{S as Z}from"./SelectListModal-Bg0Ue-Pe.js";const de=["aria-labelledby","aria-hidden"],ue={class:"modal-content"},ce={class:"modal-header"},pe={class:"modal-title"},me={class:"modal-body"},be={class:"mb-3"},fe={class:"input-group"},ve={key:0,class:"invalid-feedback d-block"},ye={class:"mb-3"},ge={class:"mb-3"},he={class:"mb-3"},Me={class:"d-flex flex-column gap-2"},ke={class:"form-check"},Ce={class:"form-check"},we={class:"form-check"},Ie={class:"form-check"},Se={key:0,class:"invalid-feedback d-block"},Pe={class:"modal-footer"},$e=["disabled"],_e={key:0,class:"spinner-border spinner-border-sm me-2"},De=Q({__name:"FileCaseCreateModal",props:{onSubmit:{type:Function}},emits:["submit","cancel"],setup(O,{expose:c,emit:I}){const i=O,_=I,m=w({ModalInstance:{modalId:"fileCaseCreateModal",title:"新增文件類別",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!1,animateBackdrop:!1}}),l=G({business:"",uploadSystemID:null,uploadEmployeeNo:null,permission:null}),f=G({business:"",permission:""}),k=w(!1),d=w({ModalInstance:{modalId:"business-select-modal",title:"選擇業務別",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!0},PaginationType:"server",DisabledDataList:null,DataList:[],TotalItems:0,PageNumber:1,PageSize:10});function D(){B(),m.value.ModalInstance.showModal=!0}function v(){m.value.ModalInstance.showModal=!1,_("cancel")}function B(){l.business="",l.uploadSystemID=null,l.uploadEmployeeNo=null,l.permission=null,f.business="",f.permission="",k.value=!1}function x(n){n.target===n.currentTarget&&(m.value.ModalInstance.animateBackdrop=!0,setTimeout(()=>{m.value.ModalInstance.animateBackdrop=!1},150))}function A(){let n=!0;return f.business="",f.permission="",l.business.trim()||(f.business="請選擇業務別",n=!1),l.permission||(f.permission="請選擇文件類別權限",n=!1),n}async function U(){if(A()){k.value=!0;try{i.onSubmit&&await i.onSubmit(l),v()}catch(n){console.error("提交表單時發生錯誤:",n)}finally{k.value=!1}}}async function V(){var n;try{const a=await S.BusinessManagementViewData("",1,d.value.PageSize);if(a.status&&((n=a.result)!=null&&n.items))d.value.DataList=a.result.items.map(s=>({name:s.business,value:s.business})),d.value.TotalItems=a.result.totalCount;else{$(a);return}d.value.ModalInstance.showModal=!0}catch(a){console.error("載入業務別資料時發生錯誤:",a)}}const T=async(n,a,s)=>{var t;try{const o=await S.BusinessManagementViewData(n,a,s);o.status&&((t=o.result)!=null&&t.items)?(d.value.DataList=o.result.items.map(g=>({name:g.business,value:g.business})),d.value.TotalItems=o.result.totalCount,d.value.PageSize=s):$(o)}catch(o){console.error("載入業務別資料時發生錯誤:",o)}};function u(n){l.business=n,f.business="",d.value.ModalInstance.showModal=!1}function b(){d.value.ModalInstance.showModal=!1}return c({openModal:D,closeModal:v}),(n,a)=>(r(),p(W,null,[m.value.ModalInstance.showModal?(r(),p("div",{key:0,class:P(["modal show d-block",{"static-backdrop-animation":m.value.ModalInstance.animateBackdrop}]),tabindex:"-1","aria-labelledby":m.value.ModalInstance.modalId,"aria-hidden":!m.value.ModalInstance.showModal,onClick:x},[e("div",{class:P(["modal-dialog",[m.value.ModalInstance.size,m.value.ModalInstance.scrollable?"modal-dialog-scrollable":""]])},[e("div",ue,[e("div",ce,[e("h5",pe,h(m.value.ModalInstance.title),1),e("button",{type:"button",class:"btn-close",onClick:v})]),e("div",me,[e("form",{onSubmit:L(U,["prevent"])},[e("div",be,[a[7]||(a[7]=e("label",{for:"business",class:"form-label"},[M(" 業務別 "),e("span",{class:"text-danger"},"*")],-1)),e("div",fe,[C(e("input",{id:"business","onUpdate:modelValue":a[0]||(a[0]=s=>l.business=s),type:"text",class:"form-control",placeholder:"請選擇業務別",readonly:"",required:""},null,512),[[F,l.business]]),e("button",{type:"button",class:"btn btn-esun-outline",onClick:V}," 選擇 ")]),f.business?(r(),p("div",ve,h(f.business),1)):y("",!0)]),e("div",ye,[a[8]||(a[8]=e("label",{for:"uploadSystemID",class:"form-label"},"上傳系統代碼",-1)),C(e("input",{id:"uploadSystemID","onUpdate:modelValue":a[1]||(a[1]=s=>l.uploadSystemID=s),type:"text",class:"form-control",placeholder:"上傳者為系統時，請填入系統代碼 (如: OOA)",maxlength:"20",disabled:""},null,512),[[F,l.uploadSystemID]])]),e("div",ge,[a[9]||(a[9]=e("label",{for:"uploadEmployeeNo",class:"form-label"},"上傳員工代碼",-1)),C(e("input",{id:"uploadEmployeeNo","onUpdate:modelValue":a[2]||(a[2]=s=>l.uploadEmployeeNo=s),type:"text",class:"form-control",placeholder:"上傳者為員工時，請填入員工代碼 (如: S717XX)",maxlength:"20",disabled:""},null,512),[[F,l.uploadEmployeeNo]])]),e("div",he,[a[14]||(a[14]=e("label",{class:"form-label"},[M(" 文件類別權限 "),e("span",{class:"text-danger"},"*")],-1)),e("div",Me,[e("div",ke,[C(e("input",{id:"permission0","onUpdate:modelValue":a[3]||(a[3]=s=>l.permission=s),class:"form-check-input",type:"radio",value:"0",required:""},null,512),[[E,l.permission]]),a[10]||(a[10]=e("label",{class:"form-check-label",for:"permission0"}," 不限制任何系統 (Public) ",-1))]),e("div",Ce,[C(e("input",{id:"permission1","onUpdate:modelValue":a[4]||(a[4]=s=>l.permission=s),class:"form-check-input",type:"radio",value:"1",required:""},null,512),[[E,l.permission]]),a[11]||(a[11]=e("label",{class:"form-check-label",for:"permission1"}," 限制註冊系統 (Protect) ",-1))]),e("div",we,[C(e("input",{id:"permission2","onUpdate:modelValue":a[5]||(a[5]=s=>l.permission=s),class:"form-check-input",type:"radio",value:"2",required:""},null,512),[[E,l.permission]]),a[12]||(a[12]=e("label",{class:"form-check-label",for:"permission2"}," 限制白名單系統 (ProtectInternal) ",-1))]),e("div",Ie,[C(e("input",{id:"permission3","onUpdate:modelValue":a[6]||(a[6]=s=>l.permission=s),class:"form-check-input",type:"radio",value:"3",required:""},null,512),[[E,l.permission]]),a[13]||(a[13]=e("label",{class:"form-check-label",for:"permission3"}," 自己才可存取 (Private) ",-1))])]),f.permission?(r(),p("div",Se,h(f.permission),1)):y("",!0)])],32)]),e("div",Pe,[e("button",{type:"button",class:"btn btn-esun-outline",onClick:v},"取消"),e("button",{type:"button",class:"btn btn-esun-primary",onClick:U,disabled:k.value},[k.value?(r(),p("span",_e)):y("",!0),M(" "+h(k.value?"建立中...":"建立"),1)],8,$e)])])],2)],10,de)):y("",!0),d.value.ModalInstance.showModal?(r(),z(Z,{key:1,myModal:d.value.ModalInstance,paginationType:d.value.PaginationType,disabledDataList:[],selectedList:d.value.DataList,totalItems:d.value.TotalItems,onSelect:u,onCancel:b,onPageChange:T},null,8,["myModal","paginationType","selectedList","totalItems"])):y("",!0)],64))}}),xe=J(De,[["__scopeId","data-v-9cfb92d5"]]),Le=["aria-labelledby","aria-hidden"],Ne={class:"modal-content"},Te={class:"modal-header"},ze={class:"modal-title"},Be={class:"modal-body"},Ue={class:"btn-group me-2 mb-3",role:"group","aria-label":"First group"},Ve={key:0,class:"text-muted"},Fe={key:1,class:"d-flex flex-wrap w-100",style:{"min-height":"400px"}},Ee={class:"card"},We={class:"card-body p-2 d-flex flex-column justify-content-between",style:{height:"100px"}},Ae=["title"],Re=["onClick"],qe={key:2,style:{"min-height":"400px"}},Oe={class:"table table-bordered"},je=["onClick"],Ge={class:"modal-footer"},He=Q({__name:"FileCasePermissionWhiteListModal",props:{operateCaseNo:{}},setup(O,{expose:c}){const I=O,i=w(_());function _(){return{ModalInstance:{modalId:"FileCasePermissionWhiteListModal",title:"檔案案件 ".concat(I.operateCaseNo," 權限白名單管理"),showModal:!1,size:"modal-xl",staticBackdrop:!0,animateBackdrop:!1},PaginationType:"server",DisplayMode:"table",DataList:[],TotalItems:1,CurrentPage:1,PageSize:10}}H(()=>({currentPage:i.value.CurrentPage,pageSize:i.value.PageSize}),(u,b)=>{if(u.currentPage!==b.currentPage||u.pageSize!==b.pageSize){debugger;k()}}),H(()=>I.operateCaseNo,(u,b)=>{u!==b&&(i.value=_(),k())});async function m(){i.value=_(),await k(),i.value.ModalInstance.showModal=!0}function l(){i.value.ModalInstance.showModal=!1}function f(u){u.target===u.currentTarget&&(i.value.ModalInstance.animateBackdrop=!0,setTimeout(()=>{i.value.ModalInstance.animateBackdrop=!1},150))}const k=async()=>{try{const u=await S.FileCasePermissionWhiteListViewData(I.operateCaseNo);u.status?(i.value.DataList=u.result.items,i.value.TotalItems=u.result.totalCount):$(u)}catch(u){j(u),console.error("Error fetching FileCase permission white list:",u)}},d=new ae;async function D(u){if((await d.showAlert(q.Warning,"警告","確定要刪除白名單業務別 ".concat(u.business," 嗎？"),[{id:"cancel",type:N.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:N.callback,btnClass:"btn-info",resolveParam:"confirm",title:"確定"}])).param==="confirm"){const n=await S.FileCasePermissionWhiteListRemove(I.operateCaseNo,u.business);n.status?await k():$(n)}}const v=w(B());function B(){return{ModalInstance:{modalId:"filecase-whitelist-select-modal",title:"選擇白名單業務別",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!0},PaginationType:"server",DataList:[],TotalCount:0,PageSize:10}}function x(){v.value=B()}const A=async(u,b,n)=>{var a;try{const s=await S.BusinessManagementViewData(u,b,n);s.status&&((a=s.result)!=null&&a.items)?(v.value.DataList=s.result.items.map(t=>({name:t.business,value:t.business})),v.value.TotalCount=s.result.totalCount,v.value.PageSize=n):$(s)}catch(s){console.error("Error fetching business:",s)}};async function U(){x();const u=await S.BusinessManagementViewData("",1,v.value.PageSize);v.value.DataList=u.result.items.map(b=>({name:b.business,value:b.business})),v.value.TotalCount=u.result.totalCount,v.value.PageSize=1,v.value.ModalInstance.showModal=!0}async function V(u){let b=await d.showAlert(q.Warning,"提醒","確定要將 ".concat(u," 加入到文件類別 ").concat(I.operateCaseNo," 的權限白名單中嗎？"),[{id:"cancel",type:N.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:N.callback,btnClass:"btn-info",resolveParam:"confirm",title:"確定"}]);try{if(b.param==="confirm"){const n=await S.FileCasePermissionWhiteListAdd(I.operateCaseNo,u);n.status?(await k(),v.value.ModalInstance.showModal=!1):$(n)}}catch(n){console.error("Error during confirmation:",n)}}function T(){v.value.ModalInstance.showModal=!1}return c({openModal:m}),(u,b)=>(r(),p(W,null,[i.value.ModalInstance.showModal?(r(),p("div",{key:0,class:P(["modal show d-block",{"static-backdrop-animation":i.value.ModalInstance.animateBackdrop}]),tabindex:"-1","aria-labelledby":i.value.ModalInstance.modalId,"aria-hidden":!i.value.ModalInstance.showModal,onClick:f},[e("div",{class:P(["modal-dialog",[i.value.ModalInstance.size,i.value.ModalInstance.scrollable?"modal-dialog-scrollable":""]])},[e("div",Ne,[e("div",Te,[e("h5",ze,h(i.value.ModalInstance.title),1),e("button",{type:"button",class:"btn-close",onClick:l})]),e("div",Be,[e("div",Ue,[e("button",{type:"button",class:P(["btn btn-esun-outline",{active:i.value.DisplayMode==="card"}]),onClick:b[0]||(b[0]=n=>i.value.DisplayMode="card")}," 卡片顯示 ",2),e("button",{type:"button",class:P(["btn btn-esun-outline",{active:i.value.DisplayMode==="table"}]),onClick:b[1]||(b[1]=n=>i.value.DisplayMode="table")}," 表格顯示 ",2),e("button",{type:"button",class:"btn btn-esun-outline",onClick:U}," 新增白名單業務別 ")]),i.value.DataList.length===0?(r(),p("div",Ve,"無白名單項目")):y("",!0),i.value.DisplayMode==="card"?(r(),p("div",Fe,[(r(!0),p(W,null,X(i.value.DataList,(n,a)=>(r(),p("div",{key:a,class:"p-2",style:{flex:"1 1 0","min-width":"25%","max-width":"25%",width:"25%"}},[e("div",Ee,[e("div",We,[e("div",{class:"mb-2 text-truncate",title:n.business,style:{width:"100%"}},h(n.business),9,Ae),e("button",{type:"button",class:"btn btn-sm btn-danger align-self-end",onClick:s=>D(n)}," 移除 ",8,Re)])])]))),128))])):y("",!0),i.value.DisplayMode==="table"?(r(),p("div",qe,[e("table",Oe,[b[4]||(b[4]=e("thead",null,[e("tr",null,[e("th",null,"業務別"),e("th",null,"操作")])],-1)),e("tbody",null,[(r(!0),p(W,null,X(i.value.DataList,(n,a)=>(r(),p("tr",{key:a},[e("td",null,h(n.business),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-danger",onClick:s=>D(n)}," 移除 ",8,je)])]))),128))])])])):y("",!0),i.value.DataList.length>0?(r(),z(Y,{key:3,modelValue:i.value.CurrentPage,"onUpdate:modelValue":b[2]||(b[2]=n=>i.value.CurrentPage=n),pageSize:i.value.PageSize,"onUpdate:pageSize":b[3]||(b[3]=n=>i.value.PageSize=n),"total-items":i.value.TotalItems},null,8,["modelValue","pageSize","total-items"])):y("",!0)]),e("div",Ge,[e("button",{class:"btn btn-esun-outline",onClick:L(l,["prevent"])},"關閉")])])],2)],10,Le)):y("",!0),v.value.ModalInstance.showModal?(r(),z(Z,{key:1,myModal:v.value.ModalInstance,paginationType:v.value.PaginationType,disabledDataList:[],selectedList:v.value.DataList,totalItems:v.value.TotalCount,onSelect:V,onCancel:T,onPageChange:A},null,8,["myModal","paginationType","selectedList","totalItems"])):y("",!0)],64))}}),le=J(He,[["__scopeId","data-v-0e7faf77"]]),Xe=["aria-labelledby","aria-hidden"],Qe={class:"modal-content"},Je={class:"modal-header"},Ke={class:"modal-title"},Ye={class:"modal-body"},Ze={class:"mb-3"},es={class:"mb-3"},ss={class:"input-group"},ts={key:0,class:"invalid-feedback d-block"},as={class:"mb-3"},ls={class:"mb-3"},os={class:"mb-3"},ns={class:"d-flex flex-column gap-2"},is={class:"form-check"},rs={class:"form-check"},ds={class:"form-check"},us={class:"form-check"},cs={key:0,class:"invalid-feedback d-block"},ps={class:"modal-footer"},ms=["disabled"],bs={key:0,class:"spinner-border spinner-border-sm me-2"},fs=Q({__name:"FileCaseUpdateModal",props:{onSubmit:{type:Function}},emits:["submit","cancel"],setup(O,{expose:c,emit:I}){const i=O,_=I,m=w({ModalInstance:{modalId:"fileCaseUpdateModal",title:"修改文件類別",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!1,animateBackdrop:!1}}),l=G({caseNo:"",business:"",uploadSystemID:null,uploadEmployeeNo:null,permission:null}),f=G({business:"",permission:""}),k=w(!1),d=w({ModalInstance:{modalId:"business-select-modal",title:"選擇業務別",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!0},PaginationType:"server",DisabledDataList:null,DataList:[],TotalItems:0,PageNumber:1,PageSize:10}),D=w(!1),v=w();H(()=>l.permission,t=>{t!=="2"&&D.value&&(D.value=!1)});function B(t){A(),t&&Object.assign(l,t),m.value.ModalInstance.showModal=!0}function x(){m.value.ModalInstance.showModal=!1,D.value=!1,_("cancel")}function A(){l.caseNo="",l.business="",l.uploadSystemID=null,l.uploadEmployeeNo=null,l.permission=null,f.business="",f.permission="",k.value=!1}function U(t){t.target===t.currentTarget&&(m.value.ModalInstance.animateBackdrop=!0,setTimeout(()=>{m.value.ModalInstance.animateBackdrop=!1},150))}function V(){let t=!0;return f.business="",f.permission="",l.business.trim()||(f.business="請選擇業務別",t=!1),l.permission||(f.permission="請選擇文件類別權限",t=!1),t}async function T(){if(V()){k.value=!0;try{i.onSubmit?await i.onSubmit(l):_("submit",l),x()}catch(t){console.error("提交表單時發生錯誤:",t)}finally{k.value=!1}}}async function u(){var t;try{const o=await S.BusinessManagementViewData("",1,d.value.PageSize);if(o.status&&((t=o.result)!=null&&t.items))d.value.DataList=o.result.items.map(g=>({name:g.business,value:g.business})),d.value.TotalItems=o.result.totalCount;else{$(o);return}d.value.ModalInstance.showModal=!0}catch(o){j(o),console.error("載入業務別資料時發生錯誤:",o)}}const b=async(t,o,g)=>{var ee;try{const R=await S.BusinessManagementViewData(t,o,g);R.status&&((ee=R.result)!=null&&ee.items)?(d.value.DataList=R.result.items.map(se=>({name:se.business,value:se.business})),d.value.TotalItems=R.result.totalCount,d.value.PageSize=g):$(R)}catch(R){console.error("載入業務別資料時發生錯誤:",R)}};function n(t){l.business=t,f.business="",d.value.ModalInstance.showModal=!1}function a(){d.value.ModalInstance.showModal=!1}function s(){var t;l.permission==="2"&&l.caseNo&&(D.value=!0,(t=v.value)==null||t.openModal())}return c({openModal:B,closeModal:x}),(t,o)=>(r(),p(W,null,[m.value.ModalInstance.showModal?(r(),p("div",{key:0,class:P(["modal show d-block",{"static-backdrop-animation":m.value.ModalInstance.animateBackdrop}]),tabindex:"-1","aria-labelledby":m.value.ModalInstance.modalId,"aria-hidden":!m.value.ModalInstance.showModal,onClick:U},[e("div",{class:P(["modal-dialog",[m.value.ModalInstance.size,m.value.ModalInstance.scrollable?"modal-dialog-scrollable":""]])},[e("div",Qe,[e("div",Je,[e("h5",Ke,h(m.value.ModalInstance.title),1),e("button",{type:"button",class:"btn-close",onClick:x})]),e("div",Ye,[e("form",{onSubmit:L(T,["prevent"])},[e("div",Ze,[o[8]||(o[8]=e("label",{for:"caseNo",class:"form-label"},[M(" 文件類別序號 (GUID) "),e("span",{class:"text-danger"},"*")],-1)),C(e("input",{id:"caseNo","onUpdate:modelValue":o[0]||(o[0]=g=>l.caseNo=g),type:"text",class:"form-control",placeholder:"請輸入文件類別序號",maxlength:"36",disabled:"",required:""},null,512),[[F,l.caseNo]])]),e("div",es,[o[9]||(o[9]=e("label",{for:"business",class:"form-label"},[M(" 業務別 "),e("span",{class:"text-danger"},"*")],-1)),e("div",ss,[C(e("input",{id:"business","onUpdate:modelValue":o[1]||(o[1]=g=>l.business=g),type:"text",class:"form-control",placeholder:"請選擇業務別",readonly:"",required:""},null,512),[[F,l.business]]),e("button",{type:"button",class:"btn btn-esun-outline",onClick:u}," 選擇 "),l.permission==="2"?(r(),p("button",{key:0,type:"button",class:"btn btn-esun-outline",onClick:s}," 權限白名單 ")):y("",!0)]),f.business?(r(),p("div",ts,h(f.business),1)):y("",!0)]),e("div",as,[o[10]||(o[10]=e("label",{for:"uploadSystemID",class:"form-label"},"上傳系統代碼",-1)),C(e("input",{id:"uploadSystemID","onUpdate:modelValue":o[2]||(o[2]=g=>l.uploadSystemID=g),type:"text",class:"form-control",placeholder:"上傳者為系統時，請填入系統代碼 (如: OOA)",maxlength:"20",disabled:""},null,512),[[F,l.uploadSystemID]])]),e("div",ls,[o[11]||(o[11]=e("label",{for:"uploadEmployeeNo",class:"form-label"},"上傳員工代碼",-1)),C(e("input",{id:"uploadEmployeeNo","onUpdate:modelValue":o[3]||(o[3]=g=>l.uploadEmployeeNo=g),type:"text",class:"form-control",placeholder:"上傳者為員工時，請填入員工代碼 (如: S717XX)",maxlength:"20",disabled:""},null,512),[[F,l.uploadEmployeeNo]])]),e("div",os,[o[16]||(o[16]=e("label",{class:"form-label"},[M(" 文件類別權限 "),e("span",{class:"text-danger"},"*")],-1)),e("div",ns,[e("div",is,[C(e("input",{id:"permission0","onUpdate:modelValue":o[4]||(o[4]=g=>l.permission=g),class:"form-check-input",type:"radio",value:"0",required:""},null,512),[[E,l.permission]]),o[12]||(o[12]=e("label",{class:"form-check-label",for:"permission0"}," 不限制任何系統 (Public) ",-1))]),e("div",rs,[C(e("input",{id:"permission1","onUpdate:modelValue":o[5]||(o[5]=g=>l.permission=g),class:"form-check-input",type:"radio",value:"1",required:""},null,512),[[E,l.permission]]),o[13]||(o[13]=e("label",{class:"form-check-label",for:"permission1"}," 限制註冊系統 (Protect) ",-1))]),e("div",ds,[C(e("input",{id:"permission2","onUpdate:modelValue":o[6]||(o[6]=g=>l.permission=g),class:"form-check-input",type:"radio",value:"2",required:""},null,512),[[E,l.permission]]),o[14]||(o[14]=e("label",{class:"form-check-label",for:"permission2"}," 限制白名單系統 (ProtectInternal) ",-1))]),e("div",us,[C(e("input",{id:"permission3","onUpdate:modelValue":o[7]||(o[7]=g=>l.permission=g),class:"form-check-input",type:"radio",value:"3",required:""},null,512),[[E,l.permission]]),o[15]||(o[15]=e("label",{class:"form-check-label",for:"permission3"}," 自己才可存取 (Private) ",-1))])]),f.permission?(r(),p("div",cs,h(f.permission),1)):y("",!0)])],32)]),e("div",ps,[e("button",{type:"button",class:"btn btn-esun-outline",onClick:x},"取消"),e("button",{type:"button",class:"btn btn-esun-primary",onClick:T,disabled:k.value},[k.value?(r(),p("span",bs)):y("",!0),M(" "+h(k.value?"更新中...":"更新"),1)],8,ms)])])],2)],10,Xe)):y("",!0),d.value.ModalInstance.showModal?(r(),z(Z,{key:1,myModal:d.value.ModalInstance,paginationType:d.value.PaginationType,disabledDataList:[],selectedList:d.value.DataList,totalItems:d.value.TotalItems,onSelect:n,onCancel:a,onPageChange:b},null,8,["myModal","paginationType","selectedList","totalItems"])):y("",!0),D.value?(r(),z(le,{key:2,ref_key:"permissionWhiteListModalRef",ref:v,operateCaseNo:l.caseNo},null,8,["operateCaseNo"])):y("",!0)],64))}}),vs=J(fs,[["__scopeId","data-v-45537022"]]),ys={class:"p-4 mt-5"},gs={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},hs={class:"h2"},Ms={class:"btn-toolbar justify-content-end mb-3",role:"toolbar","aria-label":"Toolbar with button groups"},ks={class:"btn-group me-2",role:"group","aria-label":"First group"},Cs={class:"input-group ms-3",style:{"max-width":"200px"}},ws={class:"btn-group",role:"group"},Is={class:"card card-esun h-100 esun-animate-in"},Ss={class:"card-body"},Ps={class:"card-title"},$s={class:"card-text"},_s={class:"dropdown mt-3"},Ds={class:"dropdown-menu w-100"},xs=["onClick"],Ls=["onClick"],Ns={key:0},Ts=["onClick"],zs={key:1},Bs={class:"table table-bordered table-hover align-middle"},Us={class:"dropdown"},Vs={class:"dropdown-menu w-100"},Fs=["onClick"],Es=["onClick"],Ws={key:0},As=["onClick"],Rs={key:1},qs=Q({__name:"FileCaseManagement",props:{collapsed:{type:Boolean},paginationType:{}},setup(O){const c=G({items:[],totalItems:0,searchQuery:"",currentPage:1,pageSize:10,displayMode:"card"}),I=w(),i=new ae,_=w(null),m=G({showModal:!1}),l=async()=>{var a;try{const s=await S.FileCaseManagementViewData();if(s.status&&((a=s.result)!=null&&a.items))c.items=s.result.items,c.totalItems=s.result.totalItems||0;else{debugger;$(s)}}catch(s){j(s),console.error("Error fetching fileCases:",s)}finally{}};oe(async()=>{await l()}),H(()=>({currentPage:c.currentPage,pageSize:c.pageSize}),(a,s)=>{(a.currentPage!==s.currentPage||a.pageSize!==s.pageSize)&&l()});function f(){var a;(a=I.value)==null||a.openModal()}async function k(a){try{const s=await S.FileCaseManagementCreate(a);s.status?i.showAlert(q.Success,"成功",'文件類別 "'.concat(a.business,'" 已成功建立。'),[{id:"ok",type:N.callback,btnClass:"btn-success",resolveParam:"ok",title:"確定"}]).then(async()=>{await l()}):$(s)}catch(s){j(s)}}const d=w(""),v=re(()=>{d.value&&l()},100),B=()=>{d.value="",l()};function x(a){const s={caseNo:a.caseNo,business:a.business,uploadSystemID:a.uploadSystemID,uploadEmployeeNo:a.uploadEmployeeNo,permission:String(a.permission)};m.showModal=!0,te(()=>{var t;(t=_.value)==null||t.openModal(s)})}async function A(a){const s={caseNo:a.caseNo,business:a.business,uploadSystemID:a.uploadSystemID,uploadEmployeeNo:a.uploadEmployeeNo,permission:parseInt(a.permission||"0"),updateTime:new Date().toISOString()};if((await i.showAlert(q.Warning,"警告",'確定要更新文件類別 "'.concat(s.business,'" 嗎？'),[{id:"cancel",type:N.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:N.callback,btnClass:"btn-esun-primary",resolveParam:"confirm",title:"確定"}])).param==="confirm")try{const o=await S.FileCaseManagementUpdate(s);o.status?i.showAlert(q.Success,"成功",'文件類別 "'.concat(s.business,'" 已成功更新。'),[{id:"ok",type:N.callback,btnClass:"btn-success",resolveParam:"ok",title:"確定"}]).then(async()=>{await l(),m.showModal=!1}):$(o)}catch(o){j(o)}}function U(){m.showModal=!1}async function V(a){if((await i.showAlert(q.Warning,"警告",'確定要刪除文件類別 "'.concat(a.business,'" 嗎？此操作無法復原。'),[{id:"cancel",type:N.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:N.callback,btnClass:"btn-danger",resolveParam:"confirm",title:"確定刪除"}])).param==="confirm")try{const t=await S.FileCaseManagementDelete(a.caseNo);t.status?i.showAlert(q.Success,"成功",'文件類別 "'.concat(a.business,'" 已成功刪除。'),[{id:"ok",type:N.callback,btnClass:"btn-success",resolveParam:"ok",title:"確定"}]).then(async()=>{await l()}):$(t)}catch(t){j(t)}}function T(a){switch(String(a)){case"0":return"不限制任何系統 (Public)";case"1":return"限制註冊系統 (Protect)";case"2":return"限制白名單系統 (ProtectInternal)";case"3":return"自己才可存取 (Private)";default:return"-"}}const u=w(""),b=w(),n=(a,s)=>{u.value=a,te(()=>{var t;(t=b.value)==null||t.openModal()})};return(a,s)=>(r(),p(W,null,[e("div",ys,[e("div",gs,[e("h1",hs,h(K(ie).FileCaseManagement.label),1),e("div",Ms,[e("div",ks,[e("div",Cs,[C(e("input",{type:"text",class:"form-control",placeholder:"搜尋文件類別","onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t)},null,512),[[F,d.value]]),e("div",{class:"btn-close position-absolute end-0 top-50 translate-middle cursor-pointer shadow-none",onClick:B,"aria-label":"清除搜尋"},s[8]||(s[8]=[e("button",{class:"btn btn-link p-0","aria-label":"Close"},null,-1)]))]),e("button",{class:"btn btn-sm btn-esun-outline ml-3",onClick:s[1]||(s[1]=L((...t)=>K(v)&&K(v)(...t),["prevent"]))}," 搜尋 "),e("button",{class:"btn btn-esun-primary ml-3",onClick:L(f,["prevent"])},"新增文件類別")]),e("div",ws,[e("button",{class:P(["btn btn-esun-outline",{active:c.displayMode==="card"}]),onClick:s[2]||(s[2]=t=>c.displayMode="card")}," 卡片模式 ",2),e("button",{class:P(["btn btn-esun-outline",{active:c.displayMode==="table"}]),onClick:s[3]||(s[3]=t=>c.displayMode="table")}," 表格模式 ",2)])])]),c.totalItems?(r(),z(Y,{key:0,modelValue:c.currentPage,"onUpdate:modelValue":s[4]||(s[4]=t=>c.currentPage=t),pageSize:c.pageSize,"onUpdate:pageSize":s[5]||(s[5]=t=>c.pageSize=t),"total-items":c.totalItems},null,8,["modelValue","pageSize","total-items"])):y("",!0),c.displayMode==="card"?(r(),p("div",{key:1,class:P(["row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 active",{"fade-in":c.currentPage}]),ref:"dataContainer"},[(r(!0),p(W,null,X(c.items,t=>(r(),p("div",{class:"col",key:t.caseNo},[e("div",Is,[e("div",Ss,[e("h5",Ps,h(t.business),1),e("p",$s,[s[9]||(s[9]=e("strong",null,"文件類別序號:",-1)),M(" "+h(t.caseNo),1),s[10]||(s[10]=e("br",null,null,-1)),s[11]||(s[11]=e("strong",null,"上傳系統代碼:",-1)),M(" "+h(t.uploadSystemID||"-"),1),s[12]||(s[12]=e("br",null,null,-1)),s[13]||(s[13]=e("strong",null,"上傳員工代碼:",-1)),M(" "+h(t.uploadEmployeeNo||"-"),1),s[14]||(s[14]=e("br",null,null,-1)),s[15]||(s[15]=e("strong",null,"權限:",-1)),M(" "+h(T(t.permission)),1),s[16]||(s[16]=e("br",null,null,-1)),s[17]||(s[17]=e("strong",null,"更新時間:",-1)),M(" "+h(new Date(t.updateTime).toLocaleString()),1),s[18]||(s[18]=e("br",null,null,-1))]),e("div",_s,[s[23]||(s[23]=e("button",{class:"btn btn-esun-outline dropdown-toggle w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"bi bi-gear me-1"}),M(" 操作選單 ")],-1)),e("ul",Ds,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:L(o=>x(t),["prevent"])},s[19]||(s[19]=[e("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),M(" 修改 ")]),8,xs)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:L(o=>V(t),["prevent"])},s[20]||(s[20]=[e("i",{class:"bi bi-trash me-1 text-danger"},null,-1),M(" 刪除 ")]),8,Ls)]),t.permission===2?(r(),p("li",Ns,[e("a",{class:"dropdown-item",href:"#",onClick:L(o=>n(t.caseNo,t.business),["prevent"])},s[21]||(s[21]=[e("i",{class:"bi bi-shield-check me-1 text-info"},null,-1),M(" 權限白名單管理 ")]),8,Ts)])):y("",!0),t.permission!==2?(r(),p("li",zs,s[22]||(s[22]=[e("button",{class:"dropdown-item",disabled:""},[e("i",{class:"bi bi-shield-check me-1 text-info"}),M(" 權限白名單管理 ")],-1)]))):y("",!0)])])])])]))),128))],2)):(r(),p("div",{key:2,class:P([{"fade-in":c.currentPage},"active"]),ref:"dataContainer",style:{overflow:"auto"}},[e("table",Bs,[s[29]||(s[29]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"文件類別序號"),e("th",null,"業務別"),e("th",null,"上傳系統代碼"),e("th",null,"上傳員工代碼"),e("th",null,"權限"),e("th",null,"更新時間"),e("th",null,"操作選單")])],-1)),e("tbody",null,[(r(!0),p(W,null,X(c.items,t=>(r(),p("tr",{key:t.caseNo},[e("td",null,h(t.caseNo),1),e("td",null,h(t.business),1),e("td",null,h(t.uploadSystemID||"-"),1),e("td",null,h(t.uploadEmployeeNo||"-"),1),e("td",null,h(T(t.permission)),1),e("td",null,h(new Date(t.updateTime).toLocaleString()),1),e("td",null,[e("div",Us,[s[28]||(s[28]=e("button",{class:"btn btn-esun-outline dropdown-toggle w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"bi bi-gear me-1"}),M(" 操作選單 ")],-1)),e("ul",Vs,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:L(o=>x(t),["prevent"])},s[24]||(s[24]=[e("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),M(" 修改 ")]),8,Fs)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:L(o=>V(t),["prevent"])},s[25]||(s[25]=[e("i",{class:"bi bi-trash me-1 text-danger"},null,-1),M(" 刪除 ")]),8,Es)]),t.permission===2?(r(),p("li",Ws,[e("a",{class:"dropdown-item",href:"#",onClick:L(o=>n(t.caseNo,t.business),["prevent"])},s[26]||(s[26]=[e("i",{class:"bi bi-shield-check me-1 text-info"},null,-1),M(" 權限白名單管理 ")]),8,As)])):y("",!0),t.permission!==2?(r(),p("li",Rs,s[27]||(s[27]=[e("button",{class:"dropdown-item",disabled:""},[e("i",{class:"bi bi-shield-check me-1 text-info"}),M(" 權限白名單管理 ")],-1)]))):y("",!0)])])])]))),128))])])],2)),m.showModal?(r(),z(vs,{key:3,ref_key:"FileCaseUpdateModalRef",ref:_,onSubmit:A,onCancel:U},null,512)):y("",!0),c.totalItems?(r(),z(Y,{key:4,modelValue:c.currentPage,"onUpdate:modelValue":s[6]||(s[6]=t=>c.currentPage=t),pageSize:c.pageSize,"onUpdate:pageSize":s[7]||(s[7]=t=>c.pageSize=t),"total-items":c.totalItems},null,8,["modelValue","pageSize","total-items"])):y("",!0)]),u.value?(r(),z(le,{key:0,ref_key:"FileCasePermissionWhiteListModalRef",ref:b,operateCaseNo:u.value},null,8,["operateCaseNo"])):y("",!0),ne(xe,{ref_key:"FileCaseCreateModalRef",ref:I,onSubmit:k},null,512)],64))}}),Hs=J(qs,[["__scopeId","data-v-bf4383ee"]]);export{Hs as default};
//# sourceMappingURL=FileCaseManagement-B4Ojwsfy.js.map
