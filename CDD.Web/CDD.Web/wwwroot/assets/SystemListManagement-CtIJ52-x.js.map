{"version":3,"file":"SystemListManagement-CtIJ52-x.js","sources":["../../src/components/BackStage/2_Sys/CreateSystemModal.ts","../../src/components/BackStage/2_Sys/GenTokenModal.ts","../../src/libs/AES_Helper.ts","../../src/components/BackStage/2_Sys/UpdateSystemModal.ts","../../src/components/BackStage/2_Sys/SystemListManagement.vue"],"sourcesContent":["import { ref, onMounted, watch, computed } from 'vue';\r\nimport type { MyModal } from '@/components/modal/JsonFormModal/schema';\r\nimport * as Common from '@/libs/Common';\r\n\r\n// 定義測試欄位群組與欄位\r\nexport const GetCreateSystemModal = (): MyModal => {\r\n    return {\r\n        modalId: 'myModal',\r\n        title: '新增介接系統',\r\n        showModal: false,\r\n        size: 'modal-xl',\r\n        staticBackdrop: true,\r\n        fieldGroups: [\r\n            {\r\n                title: '',\r\n                gridClass: 'col-12  ',\r\n                fields: [\r\n                    {\r\n                        modelId: 'system',\r\n                        name: 'system',\r\n                        type: 'text',\r\n                        label: '系統代號(識別)',\r\n                        placeholder: '系統代號',\r\n                        required: true,\r\n                        maxlength: 10,\r\n                        onInputCallback: (value: string) => {\r\n                            return Common.ReplaceSpecialChar(value);\r\n                        },\r\n                        onSubmitCheckCallback: (value: string) => {\r\n                            if (!value) {\r\n                                return '系統代號(識別)為必填欄位';\r\n                            }\r\n                            if (value.length > 10) {\r\n                                return '系統代號(識別)長度不能超過10個字元';\r\n                            }\r\n                            return '';\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'apiKey',\r\n                        name: 'apiKey',\r\n                        type: 'text',\r\n                        label: 'ApiKey',\r\n                        hint: '(格式為UUID 選填，若空則系統自動產生)',\r\n                        maxlength: 36,\r\n                        required: false,\r\n                        onInputCallback: (value: string) => {\r\n                            return Common.ReplaceSpecialChar(value);\r\n                        },\r\n                        onSubmitCheckCallback: (value: string) => {\r\n                            if (value && value.length > 36) {\r\n                                return 'ApiKey長度不能超過36個字元';\r\n                            } else if (value && !Common.IsUUID(value)) {\r\n                                return 'ApiKey格式錯誤，應為UUID格式';\r\n                            }\r\n                            return '';\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'isActive',\r\n                        name: 'isActive',\r\n                        type: 'radio',\r\n                        label: '是否啟用',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '啟用', value: 'Y' },\r\n                            { label: '停用', value: 'N' }\r\n                        ],\r\n                        required: true\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n};\r\n\r\nexport interface FileFormData {\r\n    system: string;\r\n    apiKey: string | null;\r\n    isActive: 'Y' | 'N';\r\n}\r\nexport const GetDefaultFormData = (): FileFormData => {\r\n    return {\r\n        system: '',\r\n        apiKey: null,\r\n        isActive: 'Y'\r\n    };\r\n};\r\n","import { ref, onMounted, watch, computed } from 'vue';\r\nimport type { MyModal } from '@/components/modal/JsonFormModal/schema';\r\n// 定義測試欄位群組與欄位\r\n// AES-256{\"source_id\":\"System\", time: \"{yyyy/MM/dd HH:mm:ss}\", \"AES_key\": \"ApiKey\" }\r\nexport const GetGenTokenModal = (): MyModal => {\r\n    return {\r\n        modalId: 'GenTokenModal',\r\n        title: '產生 X-Source',\r\n        showModal: false,\r\n        size: 'modal-xl',\r\n        staticBackdrop: true,\r\n        scrollable: true,\r\n        fieldGroups: [\r\n            {\r\n                title: '',\r\n                gridClass: 'col-6  ',\r\n                fields: [\r\n                    {\r\n                        modelId: 'source_id',\r\n                        name: 'source_id',\r\n                        type: 'text',\r\n                        label: 'source_id 系統代號(識別)',\r\n                        placeholder: 'system',\r\n                        required: true,\r\n                        maxlength: 10,\r\n                        onInputCallback: (value: string) => {\r\n                            console.log(123);\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'time',\r\n                        name: 'time',\r\n                        type: 'text',\r\n                        label: 'time',\r\n                        hint: '(yyyy/MM/dd HH:mm:ss)',\r\n                        maxlength: 19,\r\n                        required: false,\r\n                        onChangeCallback: (value: string) => {\r\n                            if (!value) {\r\n                                value = getNowString();\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'AES_key',\r\n                        name: 'AES_key',\r\n                        type: 'text',\r\n                        label: 'AES_key(即ApiKey)',\r\n                        hint: '(ApiKey格式為UUID)',\r\n                        maxlength: 36,\r\n                        required: true\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                title: '',\r\n                gridClass: 'col-6  ',\r\n                fields: [\r\n                    {\r\n                        modelId: 'hash',\r\n                        name: 'hash',\r\n                        type: 'text',\r\n                        label: 'HashKey',\r\n                        placeholder: 'HashKey',\r\n                        required: true,\r\n                        maxlength: 32,\r\n                        onInputCallback: (value: string) => {\r\n                            console.log(123);\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'iv',\r\n                        name: 'iv',\r\n                        type: 'text',\r\n                        label: 'IVKey',\r\n                        placeholder: 'IVKey',\r\n                        required: true,\r\n                        maxlength: 16,\r\n                        onInputCallback: (value: string) => {\r\n                            console.log(123);\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                title: '',\r\n                gridClass: 'col-12  ',\r\n                fields: [\r\n                    {\r\n                        modelId: 'encrypted_source',\r\n                        name: 'Encrypted Source',\r\n                        type: 'textarea',\r\n                        label: 'Encrypted',\r\n                        placeholder: 'Encrypted',\r\n                        required: false,\r\n                        disabled: true,\r\n                        maxlength: 1000,\r\n                        rows: 5,\r\n                        onInputCallback: (value: string) => {\r\n                            console.log(123);\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'decrypted_source',\r\n                        name: 'Decrypted Source',\r\n                        type: 'textarea',\r\n                        label: 'Decrypted',\r\n                        placeholder: 'Decrypted',\r\n                        required: false,\r\n                        disabled: true,\r\n                        maxlength: 1000,\r\n                        rows: 5,\r\n                        onInputCallback: (value: string) => {\r\n                            console.log(123);\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n};\r\n\r\nexport interface GenTokenFormData {\r\n    source_id: string;\r\n    time: string | null;\r\n    AES_key: string;\r\n    hash: string;\r\n    iv: string;\r\n    encrypted_source: string;\r\n    decrypted_source: string;\r\n}\r\nexport const GetDefaultTokenFormData = (): GenTokenFormData => {\r\n    return {\r\n        source_id: '',\r\n        time: getNowString(),\r\n        AES_key: '',\r\n        hash: '',\r\n        iv: '',\r\n        encrypted_source: '',\r\n        decrypted_source: ''\r\n    };\r\n};\r\n\r\nexport function getNowString(): string {\r\n    const now = new Date();\r\n\r\n    const pad = (n: number) => n.toString().padStart(2, '0');\r\n\r\n    const yyyy = now.getFullYear();\r\n    const MM = pad(now.getMonth() + 1);\r\n    const dd = pad(now.getDate());\r\n\r\n    const HH = pad(now.getHours());\r\n    const mm = pad(now.getMinutes());\r\n    const ss = pad(now.getSeconds());\r\n\r\n    return `${yyyy}/${MM}/${dd} ${HH}:${mm}:${ss}`;\r\n}\r\n","// AES_Helper.ts\r\nimport CryptoJS from 'crypto-js';\r\n\r\ntype Encoding = 'utf8' | 'hex' | 'base64';\r\n\r\n/**\r\n * 將指定格式的字串轉為 WordArray（CryptoJS 使用格式）\r\n */\r\nfunction parseToWordArray(value: string, encoding: Encoding): CryptoJS.lib.WordArray {\r\n    switch (encoding) {\r\n        case 'utf8':\r\n            return CryptoJS.enc.Utf8.parse(value);\r\n        case 'hex':\r\n            return CryptoJS.enc.Hex.parse(value);\r\n        case 'base64':\r\n            return CryptoJS.enc.Base64.parse(value);\r\n        default:\r\n            throw new Error('Unsupported encoding type.');\r\n    }\r\n}\r\n\r\n/**\r\n * AES-CBC 加密任意物件，傳回 Base64 字串\r\n */\r\nexport function encryptObject<T extends object>(\r\n    obj: T,\r\n    keyStr: string,\r\n    ivStr: string,\r\n    encoding: Encoding = 'utf8'\r\n): string {\r\n    const key = parseToWordArray(keyStr, encoding);\r\n    const iv = parseToWordArray(ivStr, encoding);\r\n\r\n    if (![16, 24, 32].includes(key.sigBytes)) {\r\n        throw new Error(`Invalid AES key size: ${key.sigBytes} bytes`);\r\n    }\r\n    if (iv.sigBytes !== 16) {\r\n        throw new Error(`IV must be 16 bytes, got ${iv.sigBytes} bytes`);\r\n    }\r\n\r\n    const plaintext = JSON.stringify(obj);\r\n\r\n    const encrypted = CryptoJS.AES.encrypt(plaintext, key, {\r\n        iv,\r\n        mode: CryptoJS.mode.CBC,\r\n        padding: CryptoJS.pad.Pkcs7\r\n    });\r\n\r\n    return encrypted.toString(); // Base64 string\r\n}\r\n\r\n/**\r\n * AES-CBC 解密，回傳原始物件\r\n */\r\nexport function decryptObject<T>(\r\n    encryptedBase64: string,\r\n    keyStr: string,\r\n    ivStr: string,\r\n    encoding: Encoding = 'utf8'\r\n): T {\r\n    const key = parseToWordArray(keyStr, encoding);\r\n    const iv = parseToWordArray(ivStr, encoding);\r\n\r\n    if (![16, 24, 32].includes(key.sigBytes)) {\r\n        throw new Error(`Invalid AES key size: ${key.sigBytes} bytes`);\r\n    }\r\n    if (iv.sigBytes !== 16) {\r\n        throw new Error(`IV must be 16 bytes, got ${iv.sigBytes} bytes`);\r\n    }\r\n\r\n    const decrypted = CryptoJS.AES.decrypt(encryptedBase64, key, {\r\n        iv,\r\n        mode: CryptoJS.mode.CBC,\r\n        padding: CryptoJS.pad.Pkcs7\r\n    });\r\n\r\n    const jsonStr = decrypted.toString(CryptoJS.enc.Utf8);\r\n    return JSON.parse(jsonStr) as T;\r\n}\r\n","import { ref, onMounted, watch, computed } from 'vue';\r\nimport type { MyModal } from '@/components/modal/JsonFormModal/schema';\r\nimport * as Common from '@/libs/Common';\r\n\r\n// 定義測試欄位群組與欄位\r\nexport const GetUpdateSystemModal = (): MyModal => {\r\n    return {\r\n        modalId: 'sysUpdateModal',\r\n        title: '修改介接系統',\r\n        showModal: false,\r\n        size: 'modal-xl',\r\n        staticBackdrop: true,\r\n        fieldGroups: [\r\n            {\r\n                title: '',\r\n                gridClass: 'col-12  ',\r\n                fields: [\r\n                    {\r\n                        modelId: 'system',\r\n                        name: 'system',\r\n                        type: 'text',\r\n                        label: '系統代號(識別)',\r\n                        placeholder: '系統代號',\r\n                        required: true,\r\n                        maxlength: 10,\r\n                        onInputCallback: (value: string) => {\r\n                            return (value = Common.ReplaceSpecialChar(value));\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'apiKey',\r\n                        name: 'apiKey',\r\n                        type: 'text',\r\n                        label: 'ApiKey',\r\n                        hint: '(格式為UUID 選填，若空則系統自動產生)',\r\n                        maxlength: 36,\r\n                        required: false,\r\n                        onInputCallback: (value: string) => {\r\n                            value = Common.ReplaceSpecialChar(value);\r\n                        }\r\n                    },\r\n\r\n                    {\r\n                        modelId: 'hashKey',\r\n                        name: 'hashKey',\r\n                        type: 'text',\r\n                        label: 'hashKey',\r\n                        hint: '',\r\n                        maxlength: 36,\r\n                        required: false,\r\n                        onInputCallback: (value: string) => {\r\n                            value = Common.HtmlspecialChars(value);\r\n                        }\r\n                    },\r\n\r\n                    {\r\n                        modelId: 'iVKey',\r\n                        name: 'iVKey',\r\n                        type: 'text',\r\n                        label: 'iVKey',\r\n                        hint: ' ',\r\n                        maxlength: 16,\r\n                        required: false,\r\n                        onInputCallback: (value: string) => {\r\n                            value = Common.HtmlspecialChars(value);\r\n                        }\r\n                    },\r\n\r\n                    {\r\n                        modelId: 'isActive',\r\n                        name: 'isActive',\r\n                        type: 'radio',\r\n                        label: '是否啟用',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '啟用', value: 'Y' },\r\n                            { label: '停用', value: 'N' }\r\n                        ],\r\n                        required: true\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n};\r\n\r\nexport interface FileFormData {\r\n    system: string;\r\n    apiKey: string | null;\r\n    isActive: 'Y' | 'N';\r\n}\r\nexport const GetDefaultFormData = (): FileFormData => {\r\n    return {\r\n        system: '',\r\n        apiKey: null,\r\n        isActive: 'Y'\r\n    };\r\n};\r\n","<style scoped>\r\n.fade-in {\r\n    opacity: 0;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.fade-in.active {\r\n    opacity: 1;\r\n}\r\n</style>\r\n\r\n<template>\r\n    <div class=\"p-4 mt-5\">\r\n        <div\r\n            class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\"\r\n        >\r\n            <h1 class=\"h2\">{{ RouteUrlList.SysManagement.label }}</h1>\r\n            <!-- -->\r\n            <div class=\"btn-toolbar justify-content-end mb-3\" role=\"toolbar\" aria-label=\"Toolbar with button groups\">\r\n                <div class=\"btn-group me-2\" role=\"group\" aria-label=\"First group\">\r\n                    <!-- 新增搜尋輸入框 -->\r\n                    <div class=\"input-group ms-3\" style=\"max-width: 200px\">\r\n                        <input\r\n                            type=\"text\"\r\n                            class=\"form-control form-control-esun\"\r\n                            placeholder=\"搜尋系統...\"\r\n                            v-model=\"appData.searchQuery\"\r\n                        />\r\n                        <div\r\n                            class=\"btn-close position-absolute end-0 top-50 translate-middle cursor-pointer shadow-none\"\r\n                            @click=\"clearSearch\"\r\n                            aria-label=\"清除搜尋\"\r\n                        >\r\n                            <button class=\"btn btn-link p-0\" aria-label=\"Close\"></button>\r\n                        </div>\r\n                    </div>\r\n                    <button class=\"btn btn-sm btn-esun-primary ml-3\" @click=\"throttledHandleSearch\">\r\n                        <i class=\"bi bi-search me-1\"></i>搜尋\r\n                    </button>\r\n                    <button class=\"btn btn-sm btn-esun-outline ml-3\" @click=\"openCreateModal\">\r\n                        <i class=\"bi bi-plus-circle me-1\"></i>新增系統\r\n                    </button>\r\n                    <button class=\"btn btn-sm btn-esun-primary ml-3\" @click=\"openGenTokenModal\">\r\n                        <i class=\"bi bi-key me-1\"></i>產生系統界接token\r\n                    </button>\r\n                </div>\r\n                <JsonFormModal\r\n                    v-if=\"createModal.showModal\"\r\n                    :myModal=\"createModal\"\r\n                    v-model=\"data\"\r\n                    @submit=\"handleCreateSubmit\"\r\n                    @cancel=\"createModal.showModal = false\"\r\n                />\r\n\r\n                <JsonFormModal\r\n                    v-if=\"genTokenModal.showModal\"\r\n                    :myModal=\"genTokenModal\"\r\n                    v-model=\"genTokenData\"\r\n                    @submit=\"handleGenTokenSubmit\"\r\n                    @cancel=\"genTokenModal.showModal = false\"\r\n                />\r\n                <!-- 切換顯示模式 -->\r\n\r\n                <div class=\"btn-group\" role=\"group\">\r\n                    <button\r\n                        class=\"btn btn-sm btn-esun-outline\"\r\n                        :class=\"{ active: appData.displayMode === 'card' }\"\r\n                        @click=\"appData.displayMode = 'card'\"\r\n                    >\r\n                        <i class=\"bi bi-grid-3x3-gap me-1\"></i>卡片模式\r\n                    </button>\r\n                    <button\r\n                        class=\"btn btn-sm btn-esun-outline\"\r\n                        :class=\"{ active: appData.displayMode === 'table' }\"\r\n                        @click=\"appData.displayMode = 'table'\"\r\n                    >\r\n                        <i class=\"bi bi-table me-1\"></i>表格模式\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 顯示資料 -->\r\n        <Pagination\r\n            v-if=\"appData.totalItems\"\r\n            v-model:modelValue=\"appData.pageNumber\"\r\n            v-model:pageSize=\"appData.pageSize\"\r\n            :total-items=\"appData.totalItems\"\r\n        />\r\n        <div\r\n            v-if=\"appData.displayMode === 'card'\"\r\n            class=\"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 active\"\r\n            :class=\"{ 'fade-in': appData.pageNumber }\"\r\n            ref=\"dataContainer\"\r\n        >\r\n            <div class=\"col\" v-for=\"(item, index) in appData.systems\" :key=\"`${item.system}-${index}`\">\r\n                <div class=\"card card-esun h-100 esun-animate-in\">\r\n                    <div class=\"card-body\">\r\n                        <h5 class=\"card-title\">{{ item.system }}</h5>\r\n                        <p class=\"card-text\">\r\n                            <strong>ApiKey:</strong> {{ item.apiKey }}<br />\r\n                            <strong>HashKey:</strong> {{ item.hashKey }}<br />\r\n                            <strong>IVKey:</strong> {{ item.iVKey }}<br />\r\n                            <strong>啟用狀態:</strong>\r\n                            <span :class=\"item.isActive === 'Y' ? 'text-success' : 'text-danger'\">\r\n                                {{ item.isActive === 'Y' ? '啟用中' : '已停用' }} </span\r\n                            ><br />\r\n                            <strong>建立時間:</strong> {{ Common.FormatDate(item.createdTime) }}<br />\r\n                            <strong>更新時間:</strong> {{ Common.FormatDate(item.lastUpdate) }}\r\n                        </p>\r\n                        <!-- 按鈕群組 -->\r\n                        <!-- Dropdown 按鈕 -->\r\n                        <div class=\"dropdown mt-3\">\r\n                            <button\r\n                                class=\"btn btn-esun-outline dropdown-toggle w-100\"\r\n                                type=\"button\"\r\n                                data-bs-toggle=\"dropdown\"\r\n                                aria-expanded=\"false\"\r\n                            >\r\n                                <i class=\"bi bi-gear me-1\"></i> 操作選單\r\n                            </button>\r\n                            <ul class=\"dropdown-menu w-100\">\r\n                                <li>\r\n                                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleEdit(item)\">\r\n                                        <i class=\"bi bi-pencil-square me-1 text-primary\"></i> 修改\r\n                                    </a>\r\n                                </li>\r\n                                <li v-if=\"item.isActive === 'Y'\">\r\n                                    <a\r\n                                        class=\"dropdown-item\"\r\n                                        href=\"#\"\r\n                                        @click.prevent=\"handleDeactivate(item)\"\r\n                                        :class=\"{ disabled: !item.isActive }\"\r\n                                    >\r\n                                        <i class=\"bi bi-slash-circle me-1 text-warning\"></i> 停用\r\n                                    </a>\r\n                                </li>\r\n                                <li>\r\n                                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleGenerateToken(item)\">\r\n                                        <i class=\"bi bi-shield-lock me-1 text-success\"></i> 產生 Token\r\n                                    </a>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n                        <!-- Dropdown 按鈕 -->\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div\r\n            v-else\r\n            :class=\"{ 'fade-in': appData.pageNumber }\"\r\n            ref=\"dataContainer\"\r\n            style=\"overflow: auto\"\r\n            class=\"active\"\r\n        >\r\n            <table class=\"table table-bordered table-hover align-middle\">\r\n                <thead class=\"table-light\">\r\n                    <tr>\r\n                        <th>系統代號</th>\r\n                        <th>ApiKey</th>\r\n                        <th>HashKey</th>\r\n                        <th>IVKey</th>\r\n                        <th>是否啟用</th>\r\n                        <th>建立時間</th>\r\n                        <th>更新時間</th>\r\n                        <th>操作選單</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(item, index) in appData.systems\" :key=\"`${item.system}-${index}`\">\r\n                        <td>{{ item.system }}</td>\r\n                        <td>{{ item.apiKey }}</td>\r\n                        <td>{{ item.hashKey }}</td>\r\n                        <td>{{ item.iVKey }}</td>\r\n                        <td>\r\n                            <span :class=\"item.isActive === 'Y' ? 'text-success' : 'text-danger'\">\r\n                                {{ item.isActive === 'Y' ? '啟用中' : '已停用' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>{{ Common.FormatDate(item.createdTime) }}</td>\r\n                        <td>{{ Common.FormatDate(item.lastUpdate) }}</td>\r\n                        <td>\r\n                            <!-- Dropdown 按鈕 -->\r\n                            <div class=\"dropdown mt-3\">\r\n                                <button\r\n                                    class=\"btn btn-esun-outline dropdown-toggle w-100\"\r\n                                    type=\"button\"\r\n                                    data-bs-toggle=\"dropdown\"\r\n                                    aria-expanded=\"false\"\r\n                                >\r\n                                    <i class=\"bi bi-gear me-1\"></i> 操作選單\r\n                                </button>\r\n                                <ul class=\"dropdown-menu w-100\">\r\n                                    <li>\r\n                                        <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleEdit(item)\">\r\n                                            <i class=\"bi bi-pencil-square me-1 text-primary\"></i> 修改\r\n                                        </a>\r\n                                    </li>\r\n                                    <li v-if=\"item.isActive === 'Y'\">\r\n                                        <a\r\n                                            class=\"dropdown-item\"\r\n                                            href=\"#\"\r\n                                            @click.prevent=\"handleDeactivate(item)\"\r\n                                            :class=\"{ disabled: !item.isActive }\"\r\n                                        >\r\n                                            <i class=\"bi bi-slash-circle me-1 text-warning\"></i> 停用\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleGenerateToken(item)\">\r\n                                            <i class=\"bi bi-shield-lock me-1 text-success\"></i> 產生 Token\r\n                                        </a>\r\n                                    </li>\r\n                                </ul>\r\n                            </div>\r\n                            <!-- Dropdown 按鈕 -->\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n        <JsonFormModal\r\n            v-if=\"updateModal.showModal\"\r\n            :myModal=\"updateModal\"\r\n            v-model=\"updateData\"\r\n            @submit=\"handleUpdateSubmit\"\r\n            @cancel=\"updateModal.showModal = false\"\r\n        />\r\n\r\n        <Pagination\r\n            v-if=\"appData.totalItems\"\r\n            v-model:modelValue=\"appData.pageNumber\"\r\n            v-model:pageSize=\"appData.pageSize\"\r\n            :total-items=\"appData.totalItems\"\r\n        />\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, watch, computed, reactive } from 'vue';\r\ndefineProps<{ collapsed: boolean; paginationType?: 'client' | 'server' }>();\r\ndefineEmits(['toggleTheme']);\r\nimport Pagination from '@/components/pagination/Pagination.vue';\r\nimport * as Common from '@/libs/Common';\r\nimport type { SystemListManagementViewDataResp } from '@/api/v1/2_Sys/SystemListManagementViewData';\r\nimport type { SystemDTO } from '@/models/DTO/SystemDTO';\r\nimport * as ApiClient from '@/libs/ApiClient';\r\nimport API from '@/api/v1/';\r\nimport JsonFormModal from '@/components/modal/JsonFormModal/JsonFormModal.vue';\r\nimport { GetCreateSystemModal, GetDefaultFormData, type FileFormData } from './CreateSystemModal';\r\nimport type { MyModal } from '@/components/modal/JsonFormModal/schema';\r\nimport { RouteUrlList } from '@/libs/RouteList';\r\n\r\n// system 資料（ API 傳入）\r\ninterface IAppData {\r\n    systems: SystemDTO[];\r\n    searchQuery: string;\r\n    pageNumber: number;\r\n    pageSize: number;\r\n    totalItems: number;\r\n    displayMode: 'card' | 'table';\r\n    paginationType: 'server' | 'client';\r\n}\r\n\r\nconst appData = reactive<IAppData>({\r\n    systems: [],\r\n    searchQuery: '',\r\n    pageNumber: 1,\r\n    pageSize: 10,\r\n    totalItems: 0,\r\n    displayMode: 'card',\r\n    paginationType: 'client'\r\n});\r\n\r\n// 建立system 相關\r\nconst createModal = ref<MyModal>(GetCreateSystemModal());\r\nconst data = ref<FileFormData>(GetDefaultFormData());\r\n\r\n/**\r\n * @todo 載入資料\r\n */\r\nconst LoadViewData = async () => {\r\n    try {\r\n        const response = await API.SystemListManagementViewData(\r\n            appData.searchQuery,\r\n            appData.pageNumber,\r\n            appData.pageSize\r\n        );\r\n        if (response.status && response.result?.items) {\r\n            appData.systems = response.result.items;\r\n\r\n            appData.totalItems = response.result.totalCount;\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching systems:', error);\r\n        // Handle error (e.g., show an error message)\r\n        ApiClient.HandleError(error);\r\n    } finally {\r\n    }\r\n};\r\n\r\nonMounted(async () => {\r\n    await LoadViewData();\r\n});\r\n\r\nwatch(\r\n    () => ({\r\n        pageNumber: appData.pageNumber,\r\n        pageSize: appData.pageSize\r\n    }),\r\n    () => {\r\n        LoadViewData();\r\n    }\r\n);\r\n\r\n// 搜尋系統資料\r\nconst handleSearch = async () => {\r\n    if (!appData.searchQuery) {\r\n        return;\r\n    }\r\n    await LoadViewData();\r\n};\r\n// 使用節流函式包裝ionput事件處理器，提高效能\r\nconst throttledHandleSearch = Common.Throttle(handleSearch, 100);\r\n\r\nwatch(\r\n    () => ({\r\n        searchQuery: appData.searchQuery\r\n    }),\r\n    () => {\r\n        appData.pageNumber = 1;\r\n    }\r\n);\r\n\r\nconst clearSearch = () => {\r\n    appData.searchQuery = '';\r\n    LoadViewData();\r\n};\r\n\r\n/**\r\n * @todo 展開新增系統 Modal\r\n */\r\nfunction openCreateModal() {\r\n    createModal.value.showModal = true;\r\n}\r\nasync function handleCreateSubmit(formData: Record<string, any>) {\r\n    try {\r\n        createModal.value.showModal = false;\r\n\r\n        const item = formData as SystemDTO;\r\n        let action: SimplePopupResolveResult<string> = await simplePopUp.showAlert(\r\n            SimplePopUpModalType.Warning,\r\n            '警告',\r\n            `確定要新增系統 ${formData.system} 嗎？`,\r\n            [\r\n                {\r\n                    id: 'cancel',\r\n                    type: SimplePopUpBtnType.callback,\r\n                    btnClass: 'btn-esun-outline ',\r\n                    resolveParam: 'cancel',\r\n                    title: '取消'\r\n                },\r\n                {\r\n                    id: 'confirm',\r\n                    type: SimplePopUpBtnType.callback,\r\n                    btnClass: 'btn-info',\r\n                    resolveParam: 'confirm',\r\n                    title: '確定'\r\n                }\r\n            ]\r\n        );\r\n\r\n        if (action.param === 'confirm') {\r\n            // 更新邏輯\r\n            alert('更新資料：\\n' + JSON.stringify(formData, null, 2));\r\n\r\n            const response = await API.SystemListManagementCreate(item);\r\n            if (response.status) {\r\n                simplePopUp\r\n                    .showAlert(\r\n                        SimplePopUpModalType.Success,\r\n                        '成功',\r\n                        `系統 ${item.system} 已新增。`,\r\n                        [\r\n                            {\r\n                                id: 'ok',\r\n                                type: SimplePopUpBtnType.callback,\r\n                                btnClass: 'btn-info',\r\n                                resolveParam: 'ok',\r\n                                title: '確定'\r\n                            }\r\n                        ],\r\n                        SimplePopUpSize.lg\r\n                    )\r\n                    .then(async () => {\r\n                        await LoadViewData();\r\n                    });\r\n            } else {\r\n                ApiClient.HandleGeneralRespError(response);\r\n            }\r\n        }\r\n        createModal.value.showModal = false;\r\n    } catch (error) {\r\n        ApiClient.HandleError(error);\r\n        console.error('Error fetching business:', error);\r\n        // Handle error (e.g., show an error message)\r\n    }\r\n}\r\n\r\n// 產生token\r\nimport { GetDefaultTokenFormData, GetGenTokenModal, getNowString, type GenTokenFormData } from './GenTokenModal';\r\nconst genTokenModal = ref<MyModal>(GetGenTokenModal());\r\nconst genTokenData = ref<GenTokenFormData>(GetDefaultTokenFormData());\r\n\r\nimport { encryptObject, decryptObject } from '@/libs/AES_Helper';\r\nimport { type Source } from '@/models/DTO/Source';\r\nimport { GetUpdateSystemModal } from './UpdateSystemModal';\r\n/**\r\n * @todo 展開新增系統 Modal\r\n */\r\nfunction openGenTokenModal() {\r\n    genTokenModal.value.showModal = true;\r\n    genTokenData.value = GetDefaultTokenFormData();\r\n}\r\n\r\n/**\r\n * @todo 產生 Token\r\n * @param _formData 表單資料\r\n */\r\nfunction handleGenTokenSubmit(_formData: Record<string, any>) {\r\n    try {\r\n        if (!_formData) {\r\n            throw new Error('Form data is required');\r\n        }\r\n        const formData = _formData as GenTokenFormData;\r\n        if (!formData.time) {\r\n            formData.time = getNowString();\r\n        }\r\n        // alert('提交資料：\\n' + JSON.stringify(formData, null, 2));\r\n        // UTF-8 key/IV（測試用，生產建議用 hex）\r\n        const key = formData.hash; // 32 bytes for AES-256\r\n        const iv = formData.iv; // 16 bytes\r\n\r\n        // 加密\r\n        const source: Source = { source_id: formData.source_id, time: formData.time, AES_key: formData.AES_key };\r\n        const encrypted = encryptObject(source, key, iv, 'utf8');\r\n        console.log('Encrypted:', encrypted);\r\n        genTokenData.value.encrypted_source = encrypted;\r\n\r\n        // 解密\r\n        const decrypted = decryptObject<Source>(encrypted, key, iv, 'utf8');\r\n        console.log('Decrypted:', decrypted);\r\n        genTokenData.value.decrypted_source = JSON.stringify(decrypted, null, 2);\r\n\r\n        genTokenModal.value.showModal = true;\r\n    } catch (error) {\r\n        ApiClient.HandleError(error);\r\n    }\r\n}\r\n// 卡片 事件處理函式\r\n// 建立system 相關\r\nimport {\r\n    SimplePopUp,\r\n    SimplePopUpBtnType,\r\n    SimplePopUpModalType,\r\n    SimplePopUpSize,\r\n    type SimplePopupResolveResult\r\n} from '@/libs/SimplePopUp';\r\nconst simplePopUp = new SimplePopUp();\r\n\r\nconst updateModal = ref<MyModal>(GetUpdateSystemModal());\r\nconst updateData = ref<SystemDTO>({\r\n    system: '',\r\n    apiKey: '',\r\n    hashKey: '',\r\n    iVKey: '',\r\n    isActive: '',\r\n    createdTime: '',\r\n    lastUpdate: ''\r\n});\r\n\r\nfunction handleEdit(item: SystemDTO) {\r\n    // 編輯邏輯\r\n    updateData.value = { ...item }; // 深拷貝，避免直接修改原始資料\r\n    updateModal.value.showModal = true;\r\n}\r\n\r\nasync function handleUpdateSubmit(formData: Record<string, any>) {\r\n    try {\r\n        const item = formData as SystemDTO;\r\n        let action: SimplePopupResolveResult<string> = await simplePopUp.showAlert(\r\n            SimplePopUpModalType.Warning,\r\n            '警告',\r\n            `確定要更新系統 ${formData.system} 嗎？`,\r\n            [\r\n                {\r\n                    id: 'cancel',\r\n                    type: SimplePopUpBtnType.callback,\r\n                    btnClass: 'btn-esun-outline ',\r\n                    resolveParam: 'cancel',\r\n                    title: '取消'\r\n                },\r\n                {\r\n                    id: 'confirm',\r\n                    type: SimplePopUpBtnType.callback,\r\n                    btnClass: 'btn-info',\r\n                    resolveParam: 'confirm',\r\n                    title: '確定'\r\n                }\r\n            ]\r\n        );\r\n\r\n        if (action.param === 'confirm') {\r\n            // 更新邏輯\r\n            alert('更新資料：\\n' + JSON.stringify(formData, null, 2));\r\n\r\n            const response = await API.SystemListManagementUpdate(item);\r\n            if (response.status) {\r\n                simplePopUp\r\n                    .showAlert(\r\n                        SimplePopUpModalType.Success,\r\n                        '成功',\r\n                        `系統 ${item.system} 已更新。`,\r\n                        [\r\n                            {\r\n                                id: 'ok',\r\n                                type: SimplePopUpBtnType.callback,\r\n                                btnClass: 'btn-info',\r\n                                resolveParam: 'ok',\r\n                                title: '確定'\r\n                            }\r\n                        ],\r\n                        SimplePopUpSize.lg\r\n                    )\r\n                    .then(async () => {\r\n                        await LoadViewData();\r\n                    });\r\n            } else {\r\n                ApiClient.HandleGeneralRespError(response);\r\n            }\r\n        }\r\n        updateModal.value.showModal = false;\r\n    } catch (error) {\r\n        ApiClient.HandleError(error);\r\n    }\r\n}\r\n\r\n/**\r\n * @todo 停用 系統\r\n * @param item\r\n */\r\nasync function handleDeactivate(item: SystemDTO) {\r\n    // 停用邏輯\r\n    let action: SimplePopupResolveResult<string> = await simplePopUp.showAlert(\r\n        SimplePopUpModalType.Warning,\r\n        '警告',\r\n        `確定要停用系統 ${item.system} 嗎？`,\r\n        [\r\n            {\r\n                id: 'cancel',\r\n                type: SimplePopUpBtnType.callback,\r\n                btnClass: 'btn-esun-outline ',\r\n                resolveParam: 'cancel',\r\n                title: '取消'\r\n            },\r\n            {\r\n                id: 'confirm',\r\n                type: SimplePopUpBtnType.callback,\r\n                btnClass: 'btn-info',\r\n                resolveParam: 'confirm',\r\n                title: '確定'\r\n            }\r\n        ]\r\n    );\r\n\r\n    if (action.param === 'confirm') {\r\n        const response = await API.SystemDeactivate(item.system);\r\n        if (response.status) {\r\n            // 停用成功，Reload 資料\r\n            simplePopUp\r\n                .showAlert(\r\n                    SimplePopUpModalType.Success,\r\n                    '成功',\r\n                    `系統 ${item.system} 已停用。`,\r\n                    [\r\n                        {\r\n                            id: 'ok',\r\n                            type: SimplePopUpBtnType.callback,\r\n                            btnClass: 'btn-info',\r\n                            resolveParam: 'ok',\r\n                            title: '確定'\r\n                        }\r\n                    ],\r\n                    SimplePopUpSize.lg\r\n                )\r\n                .then(async () => {\r\n                    await LoadViewData();\r\n                });\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @todo 產生 token\r\n * @param item\r\n */\r\nfunction handleGenerateToken(item: SystemDTO) {\r\n    // 產生 token 邏輯\r\n    genTokenModal.value.showModal = true;\r\n    genTokenData.value = {\r\n        // 深拷貝，避免直接修改原始資料\r\n        source_id: item.system,\r\n        time: getNowString(),\r\n        AES_key: item.apiKey,\r\n        hash: item.hashKey,\r\n        iv: item.iVKey,\r\n        encrypted_source: '',\r\n        decrypted_source: ''\r\n    };\r\n}\r\n</script>\r\n"],"names":["GetCreateSystemModal","value","Common.ReplaceSpecialChar","Common.IsUUID","GetDefaultFormData","GetGenTokenModal","getNowString","GetDefaultTokenFormData","now","pad","n","yyyy","MM","dd","HH","mm","ss","parseToWordArray","encoding","CryptoJS","encryptObject","obj","keyStr","ivStr","key","iv","plaintext","decryptObject","encryptedBase64","jsonStr","GetUpdateSystemModal","Common.HtmlspecialChars","appData","reactive","createModal","ref","data","LoadViewData","response","API","_a","ApiClient.HandleGeneralRespError","error","ApiClient.HandleError","onMounted","watch","throttledHandleSearch","Common.Throttle","clearSearch","openCreateModal","handleCreateSubmit","formData","item","simplePopUp","SimplePopUpModalType","SimplePopUpBtnType","SimplePopUpSize","genTokenModal","genTokenData","openGenTokenModal","handleGenTokenSubmit","_formData","source","encrypted","decrypted","SimplePopUp","updateModal","updateData","handleEdit","handleUpdateSubmit","handleDeactivate","handleGenerateToken","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","_unref","_hoisted_4","_hoisted_5","_hoisted_6","_cache","$event","_vModelText","args","_createBlock","JsonFormModal","_hoisted_7","_normalizeClass","Pagination","_Fragment","index","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_createTextVNode","Common.FormatDate","_hoisted_12","_hoisted_13","_withModifiers","_hoisted_15","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_22"],"mappings":"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"}