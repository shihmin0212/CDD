import{d as G,s,b as $,w as q,c as m,f as a,x as C,h as F,t as i,y as V,g as E,v as H,n as L,F as z,A as _,B as D,H as S,T as J,e as o,R as P,z as T,D as M,_ as R}from"./index-tYXX4zXZ.js";import{_ as I}from"./Pagination.vue_vue_type_script_setup_true_lang-CTE3-Uu0.js";import{J as j}from"./JsonFormModal-D_HC101j.js";const Q=()=>({modalId:"createFileLabelModal",title:"新增檔案標籤",showModal:!1,size:"modal-lg",staticBackdrop:!0,fieldGroups:[{title:"",gridClass:"col-12",fields:[{modelId:"labelName",name:"labelName",type:"text",label:"標籤名稱",placeholder:"請輸入標籤名稱",required:!0,maxlength:50},{modelId:"description",name:"description",type:"textarea",label:"自訂描述",placeholder:"請輸入描述 (選填)",required:!1,maxlength:255,rows:5}]}]}),K=()=>({labelName:"",description:null}),W={class:"p-4 mt-5"},X={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},Y={class:"h2"},Z={class:"btn-toolbar justify-content-end mb-3",role:"toolbar","aria-label":"Toolbar with button groups"},ee={class:"btn-group me-2",role:"group","aria-label":"First group"},ae={class:"input-group ms-3",style:{"max-width":"200px"}},le={class:"btn-group",role:"group"},te={class:"card card-esun h-100 esun-animate-in"},se={class:"card-body"},oe={class:"card-title"},ne={class:"card-text"},re={class:"table table-bordered table-hover align-middle"},ie=G({__name:"FileLabelManagement",props:{collapsed:{type:Boolean},paginationType:{}},setup(ue){const d=s([]),n=s([]),b=s("client"),r=s(1),v=s(10),u=s(0),f=s("card"),N=s(!1),c=s(null),g=s(Q()),U=s(K()),x=async(p=!0)=>{var e,l;try{if(N.value=!0,c.value&&c.value.classList.remove("active"),p){const t=await D.FileLabelManagementViewData();t.status&&((e=t.data)!=null&&e.items)?(d.value=t.data.items,n.value=t.data.items,u.value=t.data.items.length):S(t),w()}if(b.value==="server"){const t=await D.FileLabelManagementViewData();t.status&&((l=t.data)!=null&&l.items)?(d.value=t.data.items,n.value=t.data.items,u.value=t.data.items.length):S(t),w()}else if(b.value==="client"){if(n.value.length===0){const t=await D.FileLabelManagementViewData();t.status&&Array.isArray(t.data.items)?(d.value=t.data.items,n.value=t.data.items):S(t)}if(d.value.length>0){const t=(r.value-1)*v.value,h=r.value*v.value;n.value=d.value.slice(t,h),u.value=d.value.length}w()}}catch(t){console.error("Error fetching fileLabelDTOs:",t)}finally{N.value=!1,c.value&&setTimeout(()=>{c.value&&c.value.classList.add("active")},300)}};$(async()=>{await x()}),q(()=>({currentPage:r.value,pageSize:v.value}),()=>{(b.value==="server"||b.value==="client"&&b.value==="client")&&x(!1)});function B(){g.value.showModal=!0}function O(p){alert("提交資料：\n"+JSON.stringify(p,null,2)),g.value.showModal=!1}const y=s(""),w=(p=!1)=>{if(!y.value||p)return;const e=y.value.toLowerCase();n.value=d.value.filter(l=>{var t,h;return l.labelName.toLowerCase().includes(e)||((h=(t=l.description)==null?void 0:t.toLowerCase())!=null?h:"").includes(e)}),u.value=n.value.length},k=J(w,100),A=()=>{y.value="",k()};return(p,e)=>(o(),m("div",W,[a("div",X,[a("h1",Y,i(V(P).FileLabelManagement.label),1),a("div",Z,[a("div",ee,[a("div",ae,[E(a("input",{type:"text",class:"form-control",placeholder:"搜尋檔案標籤","onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),onInput:e[1]||(e[1]=(...l)=>V(k)&&V(k)(...l))},null,544),[[H,y.value]]),a("div",{class:"btn-close position-absolute end-0 top-50 translate-middle cursor-pointer shadow-none",onClick:A,"aria-label":"清除搜尋"},e[9]||(e[9]=[a("button",{class:"btn btn-link p-0","aria-label":"Close"},null,-1)]))]),a("button",{class:"btn btn-esun-primary ml-3",onClick:B},"新增檔案標籤")]),g.value.showModal?(o(),C(j,{key:0,myModal:g.value,modelValue:U.value,onSubmit:O,onCancel:e[2]||(e[2]=l=>g.value.showModal=!1)},null,8,["myModal","modelValue"])):F("",!0),a("div",le,[a("button",{class:L(["btn btn-esun-outline",{active:f.value==="card"}]),onClick:e[3]||(e[3]=l=>f.value="card")}," 卡片模式 ",2),a("button",{class:L(["btn btn-esun-outline",{active:f.value==="table"}]),onClick:e[4]||(e[4]=l=>f.value="table")}," 表格模式 ",2)])])]),u.value?(o(),C(I,{key:0,modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=l=>r.value=l),pageSize:v.value,"onUpdate:pageSize":e[6]||(e[6]=l=>v.value=l),"total-items":u.value},null,8,["modelValue","pageSize","total-items"])):F("",!0),f.value==="card"?(o(),m("div",{key:1,class:L(["row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 active",{"fade-in":r.value}]),ref_key:"dataContainer",ref:c},[(o(!0),m(z,null,_(n.value,l=>(o(),m("div",{class:"col",key:l.labelName},[a("div",te,[a("div",se,[a("h5",oe,i(l.labelName),1),a("p",ne,[e[10]||(e[10]=a("strong",null,"自訂描述:",-1)),T(" "+i(l.description),1),e[11]||(e[11]=a("br",null,null,-1)),e[12]||(e[12]=a("strong",null,"建立時間:",-1)),T(" "+i(M(l.createdTime)),1),e[13]||(e[13]=a("br",null,null,-1)),e[14]||(e[14]=a("strong",null,"更新時間:",-1)),T(" "+i(M(l.lastUpdate)),1)])])])]))),128))],2)):(o(),m("div",{key:2,class:L([{"fade-in":r.value},"active"]),ref_key:"dataContainer",ref:c,style:{overflow:"auto"}},[a("table",re,[e[15]||(e[15]=a("thead",{class:"table-light"},[a("tr",null,[a("th",null,"標籤名稱"),a("th",null,"自訂描述"),a("th",null,"建立時間"),a("th",null,"更新時間")])],-1)),a("tbody",null,[(o(!0),m(z,null,_(n.value,l=>(o(),m("tr",{key:l.labelName},[a("td",null,i(l.labelName),1),a("td",null,i(l.description),1),a("td",null,i(M(l.createdTime)),1),a("td",null,i(M(l.lastUpdate)),1)]))),128))])])],2)),u.value?(o(),C(I,{key:3,modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=l=>r.value=l),pageSize:v.value,"onUpdate:pageSize":e[8]||(e[8]=l=>v.value=l),"total-items":u.value},null,8,["modelValue","pageSize","total-items"])):F("",!0)]))}}),me=R(ie,[["__scopeId","data-v-ecf40b44"]]);export{me as default};
//# sourceMappingURL=FileLabelManagement-BuR8oPKm.js.map
