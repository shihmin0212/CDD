import{X as ne,d as le,s as P,w as ie,c as h,h as $,e as f,n as z,f as e,t as d,x as K,g as re,v as de,Y as ue,F as O,A as W,E as j,B as E,H as J,T as ce,_ as te,z as L,Z as Se,S as Me,J as A,K as be,C as _e,r as Ue,b as Ne,y as fe,V as ae,$ as Y,a0 as Z,a1 as se,l as he,R as $e}from"./index-tYXX4zXZ.js";import{_ as ee}from"./Pagination.vue_vue_type_script_setup_true_lang-CTE3-Uu0.js";import{J as we}from"./JsonFormModal-D_HC101j.js";import"./lodash-CDcQ6YRL.js";const Pe=()=>({modalId:"fileInfosModal",title:"新增檔案資訊",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!0,fieldGroups:[{title:"",gridClass:"col-6",fields:[{modelId:"business",name:"business",type:"text",label:"選擇業務別",placeholder:"請選擇業務別",required:!1,maxlength:25,readonly:!0,onSubmitCheckCallback:(b,s)=>!b&&!s.caseNo?"業務別和檔案案件必須至少選擇一項":""},{modelId:"caseNo",name:"caseNo",type:"text",label:"選擇檔案案件",placeholder:"請選擇檔案案件",required:!1,maxlength:36,readonly:!0,onSubmitCheckCallback:(b,s)=>!b&&!s.business?"業務別和檔案案件必須至少選擇一項":""},{modelId:"docType",name:"docType",type:"text",label:"選擇文件類型",placeholder:"請選擇文件類型",required:!0,readonly:!0,maxlength:50},{modelId:"isForceFileUpload",name:"isForceFileUpload",type:"radio",label:"檔案名稱已存在時",inline:!0,options:[{label:"擋掉重複檔案",value:!0},{label:"允許同名檔案",value:!1}],required:!0},{modelId:"fileUpload",name:"fileUpload",type:"file",label:"上傳檔案",hint:"選擇要上傳的檔案，檔案名稱將自動填入",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar",maxSize:50*1024*1024,multiple:!1,required:!0,onInputCallback:b=>{}},{modelId:"fileName",name:"fileName",type:"text",label:"檔案名稱",placeholder:"將自動從上傳的檔案中填入",required:!1,maxlength:255,disabled:!0}]},{title:"",gridClass:"col-6",fields:[{modelId:"isActive",name:"isActive",type:"radio",label:"是否啟用（可否存取）",inline:!0,options:[{label:"啟用",value:!0},{label:"停用",value:!1}],required:!0},{modelId:"filePermission",name:"filePermission",type:"radio",label:"權限控制",inline:!0,options:[{label:"不限制任何系統都可以存取 (Public)",value:"0"},{label:"限制跟我所屬業務別註冊的業務別都可以存取 (Protect)",value:"1"},{label:"限制跟我註冊的業務別都可以存取 (Protect_Internal)",value:"2"},{label:"自己才可存取 (Private)",value:"3"}],required:!0},{modelId:"description",name:"description",type:"textarea",label:"自訂描述",placeholder:"請輸入描述",required:!1,maxlength:500,rows:3},{modelId:"isUseRetention",name:"isUseRetention",type:"radio",label:"是否啟用定期刪除",inline:!0,options:[{label:"啟用",value:!0},{label:"不啟用",value:!1}],required:!0},{modelId:"deleteTime",name:"deleteTime",type:"text",label:"定期刪除的時間點 (yyyy-MM-dd HH:mm:ss)",placeholder:"yyyy-MM-dd HH:mm:ss",required:!1,maxlength:20,disabled:!0,onSubmitCheckCallback:(b,s)=>{let u="";return(s==null?void 0:s.isUseRetention)===!0&&(b?ne(b)===!1&&(u="時間格式錯誤"):u="請填寫 定期刪除的時間點 "),u}},{modelId:"uploadDate",name:"uploadDate",type:"text",label:"上傳或覆蓋的時間點 (yyyy-MM-dd HH:mm:ss)",placeholder:"yyyy-MM-dd HH:mm:ss",required:!1,maxlength:20,disabled:!0,onSubmitCheckCallback:(b,s)=>{let u="";return(s==null?void 0:s.isUseRetention)===!0&&(b?ne(b)===!1&&(u="時間格式錯誤"):u="請填寫 上傳或覆蓋的時間點 "),u}}]}]}),ke=()=>({business:"",caseNo:"",docType:null,docName:"",fileNo:"",isForceFileUpload:!0,fileUpload:null,fileSrc:null,fileName:"",isActive:!0,filePermission:"3",description:null,filePath:"",isUseRetention:!1,deleteTime:null,uploadDate:null}),Te=()=>({modalId:"updateFileInfosModal",title:"編輯檔案資訊",showModal:!1,size:"modal-xl",staticBackdrop:!0,scrollable:!0,fieldGroups:[{title:"",gridClass:"col-6",fields:[{modelId:"business",name:"business",type:"text",label:"選擇業務別",placeholder:"請選擇業務別",required:!1,maxlength:25,readonly:!0,onSubmitCheckCallback:(b,s)=>!b&&!s.caseNo?"業務別和檔案案件必須至少選擇一項":""},{modelId:"caseNo",name:"caseNo",type:"text",label:"選擇檔案案件",placeholder:"請選擇檔案案件",required:!1,maxlength:36,readonly:!0,onSubmitCheckCallback:(b,s)=>!b&&!s.business?"業務別和檔案案件必須至少選擇一項":""},{modelId:"docType",name:"docType",type:"text",label:"選擇文件類型",placeholder:"請選擇文件類型",required:!0,readonly:!0,maxlength:50},{modelId:"fileNo",name:"fileNo",type:"text",label:"檔案序號",placeholder:"檔案序號",required:!0,maxlength:36,readonly:!0},{modelId:"isForceFileUpload",name:"isForceFileUpload",type:"radio",label:"檔案名稱已存在時",inline:!0,options:[{label:"擋掉重複檔案",value:!0},{label:"允許同名檔案",value:!1}],required:!0},{modelId:"fileUpload",name:"fileUpload",type:"file",label:"上傳檔案",hint:"選擇要上傳的檔案，檔案名稱將自動填入",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar",maxSize:50*1024*1024,multiple:!1,required:!1,onInputCallback:b=>{}},{modelId:"fileName",name:"fileName",type:"text",label:"檔案名稱",placeholder:"將自動從上傳的檔案中填入",required:!0,maxlength:255,disabled:!0},{modelId:"filePath",name:"filePath",type:"text",label:"檔案路徑",placeholder:"檔案儲存路徑",required:!1,maxlength:500,disabled:!0}]},{title:"",gridClass:"col-6",fields:[{modelId:"isActive",name:"isActive",type:"radio",label:"是否啟用（可否存取）",inline:!0,options:[{label:"啟用",value:!0},{label:"停用",value:!1}],required:!0},{modelId:"filePermission",name:"filePermission",type:"radio",label:"權限控制",inline:!0,options:[{label:"不限制任何系統都可以存取 (Public)",value:"0"},{label:"限制跟我所屬業務別註冊的業務別都可以存取 (Protect)",value:"1"},{label:"限制跟我註冊的業務別都可以存取 (Protect_Internal)",value:"2"},{label:"自己才可存取 (Private)",value:"3"}],required:!0},{modelId:"description",name:"description",type:"textarea",label:"自訂描述",placeholder:"請輸入描述",required:!1,maxlength:500,rows:3},{modelId:"isUseRetention",name:"isUseRetention",type:"radio",label:"是否啟用定期刪除",inline:!0,options:[{label:"啟用",value:!0},{label:"不啟用",value:!1}],required:!0},{modelId:"deleteTime",name:"deleteTime",type:"text",label:"定期刪除的時間點 (yyyy-MM-dd)",required:!1,maxlength:20,onSubmitCheckCallback:(b,s)=>{let u="";return(s==null?void 0:s.isUseRetention)===!0&&(b?ne(b)===!1&&(u="時間格式錯誤"):u="請填寫 定期刪除的時間點 "),u}},{modelId:"uploadDate",name:"uploadDate",type:"text",label:"上傳或覆蓋的時間點 (yyyy-MM-dd)",required:!1,maxlength:20,onSubmitCheckCallback:(b,s)=>{let u="";return(s==null?void 0:s.isUseRetention)===!0&&(b?ne(b)===!1&&(u="時間格式錯誤"):u="請填寫 上傳或覆蓋的時間點 "),u}}]}]}),De=()=>({fileNo:"",business:"",caseNo:"",docType:null,docName:"",isForceFileUpload:null,fileUpload:null,fileSrc:"",fileName:"",isActive:null,filePermission:"3",description:null,filePath:"",isUseRetention:null,deleteTime:null,uploadDate:null});function G(b,s){for(const u of b.fieldGroups)for(const l of u.fields)if(l.modelId===s)return l;return null}const Fe=["aria-labelledby","aria-hidden"],ze={class:"modal-content"},Re={class:"modal-header"},Le={class:"modal-title"},Ae={class:"modal-body"},Be={class:"mb-3"},Ve={class:"input-group"},qe={class:"btn-group me-2 mb-3",role:"group","aria-label":"First group"},Ee={key:0,class:"text-muted"},je={key:1,class:"d-flex flex-wrap w-100",style:{"min-height":"400px"}},Qe={class:"card"},Ge={class:"card-body p-2 d-flex flex-column justify-content-between",style:{height:"140px"}},Oe={class:"mb-2"},We=["title"],He={class:"text-muted small"},Ye={class:"text-muted small"},Ke={class:"text-muted small"},Je=["onClick","disabled"],Xe={key:2,style:{"min-height":"400px"}},Ze={class:"table table-bordered table-hover"},el=["onClick","disabled"],ll={class:"modal-footer"},tl=le({__name:"BusinessSelectModal",emits:["select"],setup(b,{expose:s,emit:u}){const l=P(m()),k=P("");function m(){return{ModalInstance:{modalId:"BusinessSelectModal",title:"選擇業務別",showModal:!1,size:"modal-xl",staticBackdrop:!0,animateBackdrop:!1,scrollable:!0},PaginationType:"server",DisplayMode:"table",DataList:[],TotalItems:0,CurrentPage:1,PageSize:10,SearchQuery:""}}ie(()=>({currentPage:l.value.CurrentPage,pageSize:l.value.PageSize}),()=>{v()});async function N(){l.value=m(),k.value="",await v(),l.value.ModalInstance.showModal=!0}function T(){l.value.ModalInstance.showModal=!1}function R(M){M.target===M.currentTarget&&(l.value.ModalInstance.animateBackdrop=!0,setTimeout(()=>{l.value.ModalInstance.animateBackdrop=!1},150))}const v=async()=>{try{const M=await E.BusinessManagementViewData(l.value.SearchQuery,l.value.CurrentPage,l.value.PageSize);M&&M.status?(l.value.DataList=M.result.items.filter(i=>i.isActive==="Y"&&i.isDeleted!=="Y"),l.value.TotalItems=M.result.totalCount):J(M)}catch(M){console.error("Error fetching Business data:",M)}},C=ce(v,300);function D(M){I("select",M.business),T()}function x(M){if(!M)return"";try{return new Date(M).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(i){return M}}function y(){l.value.SearchQuery=k.value,l.value.CurrentPage=1,C()}function _(){k.value="",l.value.SearchQuery="",l.value.CurrentPage=1,C()}const I=u;return s({openModal:N}),(M,i)=>l.value.ModalInstance.showModal?(f(),h("div",{key:0,class:z(["modal show d-block",{"static-backdrop-animation":l.value.ModalInstance.animateBackdrop}]),tabindex:"-1","aria-labelledby":l.value.ModalInstance.modalId,"aria-hidden":!l.value.ModalInstance.showModal,onClick:R},[e("div",{class:z(["modal-dialog",[l.value.ModalInstance.size,l.value.ModalInstance.scrollable?"modal-dialog-scrollable":""]])},[e("div",ze,[e("div",Re,[e("h5",Le,d(l.value.ModalInstance.title),1),e("button",{type:"button",class:"btn-close",onClick:T})]),e("div",Ae,[e("div",Be,[e("div",Ve,[i[5]||(i[5]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),re(e("input",{type:"text",class:"form-control",placeholder:"搜尋業務別代號...","onUpdate:modelValue":i[0]||(i[0]=o=>k.value=o),onKeyup:ue(y,["enter"])},null,544),[[de,k.value]]),e("button",{class:"btn btn-esun-primary",type:"button",onClick:y},"搜尋"),l.value.SearchQuery?(f(),h("button",{key:0,class:"btn btn-esun-outline",type:"button",onClick:_}," 清除 ")):$("",!0)])]),e("div",qe,[e("button",{type:"button",class:z(["btn btn-esun-outline",{active:l.value.DisplayMode==="card"}]),onClick:i[1]||(i[1]=o=>l.value.DisplayMode="card")}," 卡片顯示 ",2),e("button",{type:"button",class:z(["btn btn-esun-outline",{active:l.value.DisplayMode==="table"}]),onClick:i[2]||(i[2]=o=>l.value.DisplayMode="table")}," 表格顯示 ",2)]),l.value.DataList.length===0?(f(),h("div",Ee,"無業務別資料")):$("",!0),l.value.DisplayMode==="card"?(f(),h("div",je,[(f(!0),h(O,null,W(l.value.DataList,(o,w)=>(f(),h("div",{key:w,class:"p-2",style:{flex:"1 1 0","min-width":"33.33%","max-width":"33.33%",width:"33.33%"}},[e("div",Qe,[e("div",Ge,[e("div",Oe,[e("div",{class:"text-truncate fw-bold",title:o.business,style:{width:"100%"}},d(o.business),9,We),e("div",He,"系統: "+d(o.system),1),e("div",Ye," 狀態: "+d(o.isActive==="Y"?"啟用":"停用"),1),e("div",Ke,"建立時間: "+d(x(o.createdTime)),1)]),e("button",{type:"button",class:"btn btn-sm btn-esun-primary align-self-end",onClick:V=>D(o),disabled:o.isActive!=="Y"}," 選擇 ",8,Je)])])]))),128))])):$("",!0),l.value.DisplayMode==="table"?(f(),h("div",Xe,[e("table",Ze,[i[6]||(i[6]=e("thead",null,[e("tr",null,[e("th",null,"業務別代號"),e("th",null,"系統代號"),e("th",null,"狀態"),e("th",null,"建立時間"),e("th",null,"操作")])],-1)),e("tbody",null,[(f(!0),h(O,null,W(l.value.DataList,(o,w)=>(f(),h("tr",{key:w},[e("td",null,d(o.business),1),e("td",null,d(o.system),1),e("td",null,[e("span",{class:z(o.isActive==="Y"?"text-success":"text-danger")},d(o.isActive==="Y"?"啟用":"停用"),3)]),e("td",null,d(x(o.createdTime)),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-esun-primary",onClick:V=>D(o),disabled:o.isActive!=="Y"}," 選擇 ",8,el)])]))),128))])])])):$("",!0),l.value.DataList.length>0?(f(),K(ee,{key:3,modelValue:l.value.CurrentPage,"onUpdate:modelValue":i[3]||(i[3]=o=>l.value.CurrentPage=o),pageSize:l.value.PageSize,"onUpdate:pageSize":i[4]||(i[4]=o=>l.value.PageSize=o),"total-items":l.value.TotalItems},null,8,["modelValue","pageSize","total-items"])):$("",!0)]),e("div",ll,[e("button",{class:"btn btn-esun-outline",onClick:j(T,["prevent"])},"取消")])])],2)],10,Fe)):$("",!0)}}),al=te(tl,[["__scopeId","data-v-20959250"]]),sl=["aria-labelledby","aria-hidden"],ol={class:"modal-content"},nl={class:"modal-header"},il={class:"modal-title"},rl={class:"modal-body"},dl={class:"mb-3"},ul={class:"input-group"},cl={class:"btn-group me-2 mb-3",role:"group","aria-label":"First group"},pl={key:0,class:"text-muted"},fl={key:1,class:"d-flex flex-wrap w-100",style:{"min-height":"400px"}},bl={class:"card"},ml={class:"card-body p-2 d-flex flex-column justify-content-between",style:{height:"140px"}},vl={class:"mb-2"},yl=["title"],gl={class:"text-muted small"},hl={class:"text-muted small"},wl={class:"text-muted small"},kl=["onClick"],Ml={key:2,style:{"min-height":"400px"}},Cl={class:"table table-bordered table-hover"},xl=["onClick"],Il={class:"modal-footer"},Sl=le({__name:"FileCaseSelectModal",emits:["select"],setup(b,{expose:s,emit:u}){const l=P(m()),k=P("");function m(){return{ModalInstance:{modalId:"FileCaseSelectModal",title:"選擇檔案案件",showModal:!1,size:"modal-xl",staticBackdrop:!0,animateBackdrop:!1,scrollable:!0},PaginationType:"server",DisplayMode:"table",DataList:[],TotalItems:0,CurrentPage:1,PageSize:10,SearchQuery:""}}ie(()=>({currentPage:l.value.CurrentPage,pageSize:l.value.PageSize}),()=>{v()});async function N(){l.value=m(),k.value="",await v(),l.value.ModalInstance.showModal=!0}function T(){l.value.ModalInstance.showModal=!1}function R(i){i.target===i.currentTarget&&(l.value.ModalInstance.animateBackdrop=!0,setTimeout(()=>{l.value.ModalInstance.animateBackdrop=!1},150))}const v=async()=>{var i;try{const o=await E.FileCaseManagementViewData({pageNumber:l.value.CurrentPage,pageSize:l.value.PageSize,searchQuery:l.value.SearchQuery});o&&o.status?(l.value.DataList=o.result.items,l.value.TotalItems=(i=o.result.totalItems)!=null?i:0):J(o)}catch(o){console.error("Error fetching FileCase data:",o)}},C=ce(v,300);function D(i){M("select",i.caseNo),T()}function x(i){return{0:"不限制任何系統 (Public)",1:"限制註冊系統 (Protect)",2:"限制白名單系統 (ProtectInternal)",3:"自己才可存取 (Private)"}[i]||"未知"}function y(i){if(!i)return"";try{return new Date(i).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(o){return i}}function _(){l.value.SearchQuery=k.value,l.value.CurrentPage=1,C()}function I(){k.value="",l.value.SearchQuery="",l.value.CurrentPage=1,C()}const M=u;return s({openModal:N}),(i,o)=>l.value.ModalInstance.showModal?(f(),h("div",{key:0,class:z(["modal show d-block",{"static-backdrop-animation":l.value.ModalInstance.animateBackdrop}]),tabindex:"-1","aria-labelledby":l.value.ModalInstance.modalId,"aria-hidden":!l.value.ModalInstance.showModal,onClick:R},[e("div",{class:z(["modal-dialog",[l.value.ModalInstance.size,l.value.ModalInstance.scrollable?"modal-dialog-scrollable":""]])},[e("div",ol,[e("div",nl,[e("h5",il,d(l.value.ModalInstance.title),1),e("button",{type:"button",class:"btn-close",onClick:T})]),e("div",rl,[e("div",dl,[e("div",ul,[o[5]||(o[5]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),re(e("input",{type:"text",class:"form-control",placeholder:"搜尋文件類別序號、業務別...","onUpdate:modelValue":o[0]||(o[0]=w=>k.value=w),onKeyup:ue(_,["enter"])},null,544),[[de,k.value]]),e("button",{class:"btn btn-esun-primary",type:"button",onClick:_},"搜尋"),l.value.SearchQuery?(f(),h("button",{key:0,class:"btn btn-esun-outline",type:"button",onClick:I}," 清除 ")):$("",!0)])]),e("div",cl,[e("button",{type:"button",class:z(["btn btn-esun-outline",{active:l.value.DisplayMode==="card"}]),onClick:o[1]||(o[1]=w=>l.value.DisplayMode="card")}," 卡片顯示 ",2),e("button",{type:"button",class:z(["btn btn-esun-outline",{active:l.value.DisplayMode==="table"}]),onClick:o[2]||(o[2]=w=>l.value.DisplayMode="table")}," 表格顯示 ",2)]),l.value.DataList.length===0?(f(),h("div",pl,"無檔案案件資料")):$("",!0),l.value.DisplayMode==="card"?(f(),h("div",fl,[(f(!0),h(O,null,W(l.value.DataList,(w,V)=>(f(),h("div",{key:V,class:"p-2",style:{flex:"1 1 0","min-width":"33.33%","max-width":"33.33%",width:"33.33%"}},[e("div",bl,[e("div",ml,[e("div",vl,[e("div",{class:"text-truncate fw-bold",title:w.caseNo,style:{width:"100%"}},d(w.caseNo),9,yl),e("div",gl,"業務別: "+d(w.business),1),e("div",hl," 權限: "+d(x(w.permission)),1),e("div",wl,"更新時間: "+d(y(w.updateTime)),1)]),e("button",{type:"button",class:"btn btn-sm btn-esun-primary align-self-end",onClick:pe=>D(w)}," 選擇 ",8,kl)])])]))),128))])):$("",!0),l.value.DisplayMode==="table"?(f(),h("div",Ml,[e("table",Cl,[o[6]||(o[6]=e("thead",null,[e("tr",null,[e("th",null,"文件類別序號"),e("th",null,"業務別"),e("th",null,"權限"),e("th",null,"更新時間"),e("th",null,"操作")])],-1)),e("tbody",null,[(f(!0),h(O,null,W(l.value.DataList,(w,V)=>(f(),h("tr",{key:V},[e("td",null,d(w.caseNo),1),e("td",null,d(w.business),1),e("td",null,d(x(w.permission)),1),e("td",null,d(y(w.updateTime)),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-esun-primary",onClick:pe=>D(w)}," 選擇 ",8,xl)])]))),128))])])])):$("",!0),l.value.DataList.length>0?(f(),K(ee,{key:3,modelValue:l.value.CurrentPage,"onUpdate:modelValue":o[3]||(o[3]=w=>l.value.CurrentPage=w),pageSize:l.value.PageSize,"onUpdate:pageSize":o[4]||(o[4]=w=>l.value.PageSize=w),"total-items":l.value.TotalItems},null,8,["modelValue","pageSize","total-items"])):$("",!0)]),e("div",Il,[e("button",{class:"btn btn-esun-outline",onClick:j(T,["prevent"])},"取消")])])],2)],10,sl)):$("",!0)}}),_l=te(Sl,[["__scopeId","data-v-5d86ea9c"]]),Ul=["aria-labelledby","aria-hidden"],Nl={class:"modal-content"},$l={class:"modal-header"},Pl={class:"modal-title"},Tl={class:"modal-body"},Dl={class:"mb-3"},Fl={class:"input-group"},zl={class:"btn-group me-2 mb-3",role:"group","aria-label":"First group"},Rl={key:0,class:"text-muted"},Ll={key:1,class:"d-flex flex-wrap w-100",style:{"min-height":"400px"}},Al={class:"card"},Bl={class:"card-body p-2 d-flex flex-column justify-content-between",style:{height:"140px"}},Vl={class:"mb-2"},ql=["title"],El={class:"text-muted small"},jl={class:"text-muted small"},Ql={class:"text-muted small"},Gl=["onClick"],Ol={key:2,style:{"min-height":"400px"}},Wl={class:"table table-bordered table-hover"},Hl=["onClick"],Yl={class:"modal-footer"},Kl=le({__name:"DocTypeSelectModal",emits:["select"],setup(b,{expose:s,emit:u}){const l=P(m()),k=P("");function m(){return{ModalInstance:{modalId:"DocTypeSelectModal",title:"選擇文件類型",showModal:!1,size:"modal-xl",staticBackdrop:!0,animateBackdrop:!1,scrollable:!0},PaginationType:"server",DisplayMode:"table",DataList:[],TotalItems:0,CurrentPage:1,PageSize:10,SearchQuery:""}}ie(()=>({currentPage:l.value.CurrentPage,pageSize:l.value.PageSize}),()=>{v()});async function N(){l.value=m(),k.value="",await v(),l.value.ModalInstance.showModal=!0}function T(){l.value.ModalInstance.showModal=!1}function R(M){M.target===M.currentTarget&&(l.value.ModalInstance.animateBackdrop=!0,setTimeout(()=>{l.value.ModalInstance.animateBackdrop=!1},150))}const v=async()=>{var M;try{const i=await E.DocTypeManagementViewData(l.value.CurrentPage,l.value.PageSize,l.value.SearchQuery);i&&i.status?(l.value.DataList=i.result.items,l.value.TotalItems=(M=i.result.totalCount)!=null?M:0):J(i)}catch(i){console.error("Error fetching DocType data:",i)}},C=ce(v,300);function D(M){I("select",M.docType,M.docName),T()}function x(M){return{0:"不限制任何系統 (Public)",1:"限制註冊系統 (Protect)",2:"限制白名單系統 (ProtectInternal)",3:"自己才可存取 (Private)"}[M]||"未知"}function y(){l.value.SearchQuery=k.value,l.value.CurrentPage=1,C()}function _(){k.value="",l.value.SearchQuery="",l.value.CurrentPage=1,C()}const I=u;return s({openModal:N}),(M,i)=>l.value.ModalInstance.showModal?(f(),h("div",{key:0,class:z(["modal show d-block",{"static-backdrop-animation":l.value.ModalInstance.animateBackdrop}]),tabindex:"-1","aria-labelledby":l.value.ModalInstance.modalId,"aria-hidden":!l.value.ModalInstance.showModal,onClick:R},[e("div",{class:z(["modal-dialog",[l.value.ModalInstance.size,l.value.ModalInstance.scrollable?"modal-dialog-scrollable":""]])},[e("div",Nl,[e("div",$l,[e("h5",Pl,d(l.value.ModalInstance.title),1),e("button",{type:"button",class:"btn-close",onClick:T})]),e("div",Tl,[e("div",Dl,[e("div",Fl,[i[5]||(i[5]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),re(e("input",{type:"text",class:"form-control",placeholder:"搜尋文件類型名稱...","onUpdate:modelValue":i[0]||(i[0]=o=>k.value=o),onKeyup:ue(y,["enter"])},null,544),[[de,k.value]]),e("button",{class:"btn btn-esun-primary",type:"button",onClick:y},"搜尋"),l.value.SearchQuery?(f(),h("button",{key:0,class:"btn btn-esun-outline",type:"button",onClick:_}," 清除 ")):$("",!0)])]),e("div",zl,[e("button",{type:"button",class:z(["btn btn-esun-outline",{active:l.value.DisplayMode==="card"}]),onClick:i[1]||(i[1]=o=>l.value.DisplayMode="card")}," 卡片顯示 ",2),e("button",{type:"button",class:z(["btn btn-esun-outline",{active:l.value.DisplayMode==="table"}]),onClick:i[2]||(i[2]=o=>l.value.DisplayMode="table")}," 表格顯示 ",2)]),l.value.DataList.length===0?(f(),h("div",Rl,"無文件類型資料")):$("",!0),l.value.DisplayMode==="card"?(f(),h("div",Ll,[(f(!0),h(O,null,W(l.value.DataList,(o,w)=>(f(),h("div",{key:w,class:"p-2",style:{flex:"1 1 0","min-width":"33.33%","max-width":"33.33%",width:"33.33%"}},[e("div",Al,[e("div",Bl,[e("div",Vl,[e("div",{class:"text-truncate fw-bold",title:o.docName,style:{width:"100%"}},d(o.docName),9,ql),e("div",El,"編號: "+d(o.docType),1),e("div",jl," 權限: "+d(x(o.permission)),1),e("div",Ql,"描述: "+d(o.description||"-"),1)]),e("button",{type:"button",class:"btn btn-sm btn-esun-primary align-self-end",onClick:V=>D(o)}," 選擇 ",8,Gl)])])]))),128))])):$("",!0),l.value.DisplayMode==="table"?(f(),h("div",Ol,[e("table",Wl,[i[6]||(i[6]=e("thead",null,[e("tr",null,[e("th",null,"文件類型編號"),e("th",null,"文件類型名稱"),e("th",null,"權限"),e("th",null,"描述"),e("th",null,"操作")])],-1)),e("tbody",null,[(f(!0),h(O,null,W(l.value.DataList,(o,w)=>(f(),h("tr",{key:w},[e("td",null,d(o.docType),1),e("td",null,d(o.docName),1),e("td",null,d(x(o.permission)),1),e("td",null,d(o.description||"-"),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-esun-primary",onClick:V=>D(o)}," 選擇 ",8,Hl)])]))),128))])])])):$("",!0),l.value.DataList.length>0?(f(),K(ee,{key:3,modelValue:l.value.CurrentPage,"onUpdate:modelValue":i[3]||(i[3]=o=>l.value.CurrentPage=o),pageSize:l.value.PageSize,"onUpdate:pageSize":i[4]||(i[4]=o=>l.value.PageSize=o),"total-items":l.value.TotalItems},null,8,["modelValue","pageSize","total-items"])):$("",!0)]),e("div",Yl,[e("button",{class:"btn btn-esun-outline",onClick:j(T,["prevent"])},"取消")])])],2)],10,Ul)):$("",!0)}}),Jl=te(Kl,[["__scopeId","data-v-241fc820"]]),Xl={class:"modal-dialog modal-xl modal-dialog-centered"},Zl={class:"modal-content"},et={class:"modal-header"},lt={class:"modal-title"},tt={class:"modal-body text-center",style:{"max-height":"70vh",overflow:"auto"}},at={key:0,class:"d-flex justify-content-center align-items-center",style:{height:"300px"}},st={key:1,class:"alert alert-danger"},ot={key:2},nt=["src","alt"],it={class:"modal-footer"},rt=["disabled"],dt=le({__name:"ImagePreviewModal",setup(b,{expose:s}){const u=P(!1),l=P(!1),k=P(!1),m=P(""),N=P(""),T=P(""),R=P(null);async function v(y){R.value=y,T.value=y.fileName,u.value=!0,k.value=!0,m.value="",N.value="";try{const _=await E.GetFileContent({business:y.business,fileNo:y.fileNo}),I=URL.createObjectURL(_);N.value=I}catch(_){console.error("獲取圖片失敗:",_),m.value="無法載入圖片，請稍後再試。"}finally{k.value=!1}}function C(){u.value=!1,N.value&&(URL.revokeObjectURL(N.value),N.value=""),R.value=null,T.value="",m.value=""}async function D(){if(!(!R.value||!N.value))try{const y=await E.GetFileContent({business:R.value.business,fileNo:R.value.fileNo}),_=URL.createObjectURL(y),I=document.createElement("a");I.href=_,I.download=R.value.fileName,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(_)}catch(y){console.error("下載圖片失敗:",y)}}function x(y){y.target===y.currentTarget&&(l.value=!0,setTimeout(()=>{l.value=!1},150))}return s({openModal:v}),(y,_)=>u.value?(f(),h("div",{key:0,class:z(["modal show d-block",{"static-backdrop-animation":l.value}]),tabindex:"-1","aria-hidden":"false",onClick:x},[e("div",Xl,[e("div",Zl,[e("div",et,[e("h5",lt,"圖片預覽 - "+d(T.value),1),e("button",{type:"button",class:"btn-close",onClick:C})]),e("div",tt,[k.value?(f(),h("div",at,_[0]||(_[0]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"載入中...")],-1)]))):m.value?(f(),h("div",st,d(m.value),1)):N.value?(f(),h("div",ot,[e("img",{src:N.value,alt:T.value,class:"img-fluid",style:{"max-width":"100%","max-height":"60vh","object-fit":"contain"}},null,8,nt)])):$("",!0)]),e("div",it,[e("button",{type:"button",class:"btn btn-esun-primary",onClick:D,disabled:!N.value},_[1]||(_[1]=[e("i",{class:"bi bi-download me-1"},null,-1),L("下載圖片 ")]),8,rt),e("button",{type:"button",class:"btn btn-esun-outline",onClick:C},"關閉")])])])],2)):$("",!0)}}),ut=te(dt,[["__scopeId","data-v-87118645"]]),ct=new Me;async function pt(b,s,u,l=2048,k=2048,m=.8,N=8,T="image/jpeg",R=!0){try{if(b==="blob"&&(u=await mt(s)),!u)throw new Error("Base64 source is null.");const v=await Se(u),C=document.createElement("canvas");v.width>v.height&&v.width>l?(v.height*=l/v.width,v.width=l):v.height>k&&(v.width*=k/v.height,v.height=k),C.width=v.width,C.height=v.height;const D=C.getContext("2d");if(!D)throw new Error("Cannot get canvas 2D context.");D.clearRect(0,0,v.width,v.height),D.drawImage(v,0,0,v.width,v.height);const x=C.toDataURL(T,m),y=bt(x),_=N*1024*1024;return y>_?(R&&ct.showAlert(A.Warning,"錯誤","很抱歉您上傳的照片大小超過".concat(N,"MB請重新上傳，敬請見諒。"),[{id:"confirm",type:be.callback,btnClass:"btn-info",resolveParam:"confirm",title:"確認"}]),null):x}catch(v){return _e(v instanceof Error?v.message:v),null}}async function oe(b,s=2048,u=2048,l=.8,k=8,m="image/jpeg",N=!0){return pt("blob",b,null,s,u,l,k,m,N)}const ft=b=>{const s=";base64,";if(b.includes(s)){let u=b.indexOf(s)+s.length;return b.substring(u)}return b};function bt(b){let s=b;const u=b.indexOf(",");u!==-1&&(s=b.substring(u+1));const l=(s.match(/=+$/)||[""])[0].length;return s.length*3/4-l}const mt=b=>new Promise((s,u)=>{const l=new FileReader;l.readAsDataURL(b),l.onload=k=>{var m;s((m=k.target)==null?void 0:m.result)},l.onerror=k=>{u(k)}}),vt={class:"p-4 mt-5"},yt={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},gt={class:"h2"},ht={class:"btn-toolbar justify-content-end mb-3",role:"toolbar","aria-label":"Toolbar with button groups"},wt={class:"btn-group me-2",role:"group","aria-label":"First group"},kt={class:"input-group ms-3",style:{"max-width":"300px"}},Mt={class:"btn-group",role:"group"},Ct={class:"card card-esun h-100 esun-animate-in"},xt={class:"card-body"},It={class:"card-title"},St={class:"card-text"},_t={class:"dropdown mt-3"},Ut={class:"dropdown-menu w-100"},Nt=["onClick"],$t=["onClick"],Pt=["onClick"],Tt={class:"table table-bordered table-hover align-middle"},Dt={class:"dropdown"},Ft={class:"dropdown-menu"},zt=["onClick"],Rt=["onClick"],Lt=["onClick"],At=le({__name:"FileInfosManagement",props:{collapsed:{type:Boolean},paginationType:{}},setup(b){const s=Ue({DataList:[],searchQuery:"",currentPage:1,pageSize:10,totalItems:0,displayMode:"card"}),u=async()=>{var r;try{const t=await E.FileInfosManagementViewData({pageNumber:s.currentPage,pageSize:s.pageSize,searchQuery:s.searchQuery});t.status&&((r=t.result)!=null&&r.items)?(s.DataList=t.result.items,s.totalItems=t.result.totalCount||0):J(t)}catch(t){console.error("Error fetching fileInfos:",t)}};Ne(async()=>{await u()}),ie(()=>({currentPage:s.currentPage,pageSize:s.pageSize}),()=>{u()});async function l(r){var t;try{const a=r.fileName.toLowerCase();Y(a)?(t=v.value)==null||t.openModal(r):await k(r)}catch(a){console.error("處理檔案預覽/下載時發生錯誤:",a),I.showAlert(A.Warning,"錯誤","處理檔案時發生錯誤，請稍後再試。")}}async function k(r){try{const t=I.showAlert(A.Info,"下載中","檔案下載中，請稍候..."),a=await E.GetFileContent({business:r.business,fileNo:r.fileNo}),n=URL.createObjectURL(a),S=document.createElement("a");S.href=n,S.download=r.fileName,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(n),await I.showAlert(A.Success,"下載完成","檔案「".concat(r.fileName,"」下載完成！"))}catch(t){console.error("下載檔案失敗:",t),await I.showAlert(A.Warning,"下載失敗","檔案「".concat(r.fileName,"」下載失敗，請稍後再試。"))}}const m=P(ke()),N=P(),T=P(),R=P(),v=P(),C=P(Pe()),D=P(),x=P(De()),y=P(Te()),_=P(),I=new Me;async function M(){m.value=ke();const r=G(C.value,"fileUpload");r&&r.type==="file"&&(r.onInputCallback=async g=>{var U,B;const c=Array.isArray(g)?g[0]:g;if(c&&Y(c.name)){const q=await oe(c,4096,4096,.8,8,"image/jpeg",!0);if(!q)return;let p=(U=await Z(q))!=null?U:"";m.value.fileSrc=p,m.value.fileName=c.name}else if(c&&!Y(c.name)){let q=(B=await se(c))!=null?B:"";m.value.fileSrc=Z(q),m.value.fileName=c.name}else m.value.fileSrc="",m.value.fileName=""});const t=G(C.value,"business");t&&t.type==="text"&&(t.onClickCallback=()=>{var g;if(t.disabled){I.showAlert(A.Warning,"提醒","業務別和檔案案件只能選擇一項");return}(g=N.value)==null||g.openModal()},t.onClearInput=()=>{V("business","create")});const a=G(C.value,"caseNo");a&&a.type==="text"&&(a.onClickCallback=()=>{var g;if(a.disabled){I.showAlert(A.Warning,"提醒","業務別和檔案案件只能選擇一項");return}(g=T.value)==null||g.openModal()},a.onClearInput=()=>{V("caseNo","create")});const n=G(C.value,"docType");n&&n.type==="text"&&(n.onClickCallback=()=>{var g;(g=R.value)==null||g.openModal()});const S=G(C.value,"isUseRetention");S&&S.type==="radio"&&(S.onChangeCallback=g=>{const c=g===!0||g==="true"||g===1||g==="1";setTimeout(()=>{const U=document.querySelector("#deleteTime"),B=document.querySelector("#uploadDate");U&&(U.disabled=!c),B&&(B.disabled=!c)},50)}),C.value.showModal=!0,w("create"),he()}function i(r){var t,a,n,S;C.value.showModal?(m.value.business=r,m.value.caseNo="",w("create"),(t=D.value)==null||t.clearFieldError("business"),(a=D.value)==null||a.clearFieldError("caseNo")):y.value.showModal&&(x.value.business=r,x.value.caseNo="",w("update"),(n=_.value)==null||n.clearFieldError("business"),(S=_.value)==null||S.clearFieldError("caseNo"))}function o(r){var t,a,n,S;C.value.showModal?(m.value.caseNo=r,m.value.business="",w("create"),(t=D.value)==null||t.clearFieldError("caseNo"),(a=D.value)==null||a.clearFieldError("business")):y.value.showModal&&(x.value.caseNo=r,x.value.business="",w("update"),(n=_.value)==null||n.clearFieldError("caseNo"),(S=_.value)==null||S.clearFieldError("business"))}function w(r){r==="create"?C.value:y.value;const t=r==="create"?m.value:x.value,a=document.querySelector("#business"),n=document.querySelector("#caseNo");a&&n&&(t.business?(n.disabled=!0,a.disabled=!1):t.caseNo?(a.disabled=!0,n.disabled=!1):(a.disabled=!1,n.disabled=!1))}function V(r,t){const a=t==="create"?m.value:x.value,n=t==="create"?D.value:_.value;r==="business"?(a.business="",n==null||n.clearFieldError("business")):(a.caseNo="",n==null||n.clearFieldError("caseNo")),w(t)}function pe(r,t){var a,n;C.value.showModal?(m.value.docType=r,m.value.docName=t,(a=D.value)==null||a.clearFieldError("docType")):y.value.showModal&&(x.value.docType=r,x.value.docName=t,(n=_.value)==null||n.clearFieldError("docType"))}async function Ce(r){var t,a;try{const n=r;if(n.fileUpload)if(console.log("上傳的檔案:",n.fileUpload),console.log("檔案名稱:",n.fileUpload.name),console.log("檔案大小:",n.fileUpload.size),console.log("檔案類型:",n.fileUpload.type),n.fileSrc)n.fileSrc=(a=await Z(n.fileSrc))!=null?a:"";else try{let g;const c=n.fileUpload.name.toLowerCase();if(Y(c)){console.log("處理圖片檔案:",c);const U=await oe(n.fileUpload,4096,4096,.8,8,"image/jpeg",!1);if(!U){await I.showAlert(A.Warning,"錯誤","圖片處理失敗，請檢查圖片格式或大小");return}g=Z(U),n.fileSrc=g}else console.log("處理非圖片檔案:",c),g=(t=await se(n.fileUpload))!=null?t:"",n.fileSrc=Z(g)}catch(g){console.error("檔案處理失敗:",g),await I.showAlert(A.Warning,"錯誤","檔案處理失敗，請稍後再試");return}const S=await E.FileInfosManagementCreate({business:n.business,caseNo:n.caseNo,docType:n.docType||1,fileName:n.fileName,fileSrc:n.fileSrc,isActive:n.isActive,filePermission:n.filePermission,description:n.description,isUseRetention:n.isUseRetention,deleteTime:n.deleteTime,uploadDate:n.uploadDate,isForceFileUpload:n.isForceFileUpload});if(S.status){let g="檔案資訊新增成功！";if(S.result&&S.result.fileInfo&&S.result.fileInfo.length>0){const c=S.result.fileInfo[0];if(c.processOk){if(g+="\n檔案序號: ".concat(c.fileNo),c.moveFileTask){const U=c.moveFileTask;U.insertOrUpdateRes&&U.moveToNasRes?g+="\n檔案已成功上傳至系統":U.insertOrUpdateRes?U.moveToNasRes||(g+="\n警告: 檔案移動失敗"):g+="\n警告: 資料庫操作失敗"}}else g+="\n注意: 檔案處理過程中發生問題"}await I.showAlert(A.Success,"成功",g),C.value.showModal=!1,await u()}else J(S)}catch(n){console.error("Error creating file info:",n)}}const me=async()=>{s.currentPage=1,await u()},ve=ce(me,300),xe=async()=>{s.searchQuery="",s.currentPage=1,await u()};async function ye(r){x.value={fileNo:r.fileNo,business:r.business,caseNo:r.caseNo,docType:r.docType||null,docName:r.docName,isForceFileUpload:r.isForceFileUpload,fileUpload:null,fileSrc:null,fileName:r.fileName,isActive:r.isActive,filePermission:r.filePermission,description:r.description,filePath:r.filePath,isUseRetention:r.isUseRetention,deleteTime:r.deleteTime,uploadDate:r.uploadDate};const t=G(y.value,"fileUpload");t&&t.type==="file"&&(t.onInputCallback=async c=>{const U=Array.isArray(c)?c[0]:c;if(U&&Y(U.name)){const B=await oe(U,4096,4096,.8,8,"image/jpeg",!0);if(!B)return;x.value.fileSrc=B,x.value.fileName=U.name}else U&&!Y(U.name)?(x.value.fileSrc=await se(U),x.value.fileName=U.name):(x.value.fileSrc="",x.value.fileName="")});const a=G(y.value,"business");a&&a.type==="text"&&(a.onClickCallback=()=>{var c;a.disabled||(c=N.value)==null||c.openModal()},a.onClearInput=()=>{V("business","update")});const n=G(y.value,"caseNo");n&&n.type==="text"&&(n.onClickCallback=()=>{var c;n.disabled||(c=T.value)==null||c.openModal()},n.onClearInput=()=>{V("caseNo","update")});const S=y.value.fieldGroups[0].fields.find(c=>c.modelId==="docType");S&&S.type==="text"&&(S.onClickCallback=()=>{var c;(c=R.value)==null||c.openModal()});const g=y.value.fieldGroups[1].fields.find(c=>c.modelId==="isUseRetention");g&&g.type==="radio"&&(g.onChangeCallback=c=>{const U=c===!0||c==="true"||c===1||c==="1";setTimeout(()=>{const B=document.querySelector("#deleteTime"),q=document.querySelector("#uploadDate");B&&(B.disabled=!U),q&&(q.disabled=!U)},50)}),y.value.showModal=!0,w("update"),he()}async function Ie(r){var t,a,n,S,g,c,U,B,q;try{const p=r;if(p.fileUpload&&(console.log("上傳的檔案:",p.fileUpload),console.log("檔案名稱:",p.fileUpload.name),console.log("檔案大小:",p.fileUpload.size),console.log("檔案類型:",p.fileUpload.type),!p.fileSrc))try{let F;const Q=p.fileUpload.name.toLowerCase();if(Y(Q)){console.log("處理圖片檔案:",Q);const H=await oe(p.fileUpload,4096,4096,.8,8,"image/jpeg",!1);if(!H){await I.showAlert(A.Warning,"錯誤","圖片處理失敗，請檢查圖片格式或大小");return}F=ft(H)}else console.log("處理非圖片檔案:",Q),p.fileSrc=(t=await se(p.fileUpload))!=null?t:""}catch(F){console.error("檔案處理失敗:",F),await I.showAlert(A.Warning,"錯誤","檔案處理失敗，請稍後再試");return}if(p.fileUpload){console.log("更新時上傳的檔案:",p.fileUpload),console.log("檔案名稱:",p.fileUpload.name),console.log("檔案大小:",p.fileUpload.size),console.log("檔案類型:",p.fileUpload.type);const F=new FormData;F.append("file",p.fileUpload),F.append("fileName",p.fileName),F.append("caseNo",p.caseNo),F.append("fileNo",p.fileNo),F.append("isActive",(n=(a=p.isActive)==null?void 0:a.toString())!=null?n:""),F.append("isForceFileUpload",(g=(S=p.isForceFileUpload)==null?void 0:S.toString())!=null?g:""),F.append("isUseRetention",(U=(c=p.isUseRetention)==null?void 0:c.toString())!=null?U:""),F.append("filePermission",(q=(B=p.filePermission)==null?void 0:B.toString())!=null?q:0),p.description&&F.append("description",p.description),p.deleteTime&&F.append("deleteTime",p.deleteTime),p.uploadDate&&F.append("uploadDate",p.uploadDate)}const X=await E.FileInfosManagementUpdate({business:p.business,caseNo:p.caseNo,docType:p.docType||1,fileSrc:p.fileSrc?Z(p.fileSrc):"",fileNo:p.fileNo,fileName:p.fileName,isActive:p.isActive,filePermission:p.filePermission,description:p.description,isUseRetention:p.isUseRetention,deleteTime:p.deleteTime});if(X.status){let F="檔案資訊新增成功！";if(X.result&&X.result.fileInfo&&X.result.fileInfo.length>0){const Q=X.result.fileInfo[0];if(Q.processOk){if(F+="\n檔案序號: ".concat(Q.fileNo),Q.moveFileTask){const H=Q.moveFileTask;H.insertOrUpdateRes&&H.moveToNasRes?F+="\n檔案已成功上傳至系統":H.insertOrUpdateRes?H.moveToNasRes||(F+="\n警告: 檔案移動失敗"):F+="\n警告: 資料庫操作失敗"}}else F+="\n注意: 檔案處理過程中發生問題"}await I.showAlert(A.Success,"成功",F),y.value.showModal=!1,await u()}else J(X)}catch(p){console.error("更新檔案資訊時發生錯誤:",p),await I.showAlert(A.Warning,"錯誤","更新檔案資訊時發生錯誤，請稍後再試。")}}async function ge(r){if((await I.showAlert(A.Warning,"確認刪除","確定要刪除檔案「".concat(r.fileName,"」嗎？此操作無法復原。"),[{id:"cancel",type:be.callback,btnClass:"btn-esun-outline",resolveParam:"cancel",title:"取消"},{id:"confirm",type:be.callback,btnClass:"btn-danger",resolveParam:"confirm",title:"確定刪除"}])).param==="confirm")try{const a=await E.FileInfosManagementDelete(r.fileNo);a.status?(await I.showAlert(A.Success,"成功","檔案資訊刪除成功！"),await u()):J(a)}catch(a){console.error("刪除檔案資訊時發生錯誤:",a),await I.showAlert(A.Warning,"錯誤","刪除檔案資訊時發生錯誤，請稍後再試。")}}return(r,t)=>(f(),h("div",vt,[e("div",yt,[e("h1",gt,d(fe($e).FileInfosManagement.label),1),e("div",ht,[e("div",wt,[e("div",kt,[t[11]||(t[11]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),re(e("input",{type:"text",class:"form-control",placeholder:"搜尋檔案名稱、序號...","onUpdate:modelValue":t[0]||(t[0]=a=>s.searchQuery=a),onKeyup:ue(me,["enter"])},null,544),[[de,s.searchQuery]]),e("button",{class:"btn btn-esun-primary",type:"button",onClick:t[1]||(t[1]=(...a)=>fe(ve)&&fe(ve)(...a))},"搜尋"),e("button",{class:"btn btn-esun-outline",type:"button",onClick:xe},"清除")])]),e("div",{class:"btn-group me-2"},[e("button",{class:"btn btn-esun-primary ml-3",onClick:M},"新增檔案資訊")]),C.value.showModal?(f(),K(we,{key:0,ref_key:"createModalRef",ref:D,myModal:C.value,modelValue:m.value,onSubmit:Ce,onCancel:t[2]||(t[2]=a=>C.value.showModal=!1)},null,8,["myModal","modelValue"])):$("",!0),y.value.showModal?(f(),K(we,{key:1,ref_key:"updateModalRef",ref:_,myModal:y.value,modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=a=>x.value=a),onSubmit:Ie,onCancel:t[4]||(t[4]=a=>y.value.showModal=!1)},null,8,["myModal","modelValue"])):$("",!0),ae(al,{ref_key:"businessSelectModal",ref:N,onSelect:i},null,512),ae(_l,{ref_key:"fileCaseSelectModal",ref:T,onSelect:o},null,512),ae(Jl,{ref_key:"docTypeSelectModal",ref:R,onSelect:pe},null,512),ae(ut,{ref_key:"imagePreviewModal",ref:v},null,512),e("div",Mt,[e("button",{class:z(["btn btn-esun-outline",{active:s.displayMode==="card"}]),onClick:t[5]||(t[5]=a=>s.displayMode="card")}," 卡片模式 ",2),e("button",{class:z(["btn btn-esun-outline",{active:s.displayMode==="table"}]),onClick:t[6]||(t[6]=a=>s.displayMode="table")}," 表格模式 ",2)])])]),s.totalItems?(f(),K(ee,{key:0,modelValue:s.currentPage,"onUpdate:modelValue":t[7]||(t[7]=a=>s.currentPage=a),pageSize:s.pageSize,"onUpdate:pageSize":t[8]||(t[8]=a=>s.pageSize=a),"total-items":s.totalItems,"go-to-page":u},null,8,["modelValue","pageSize","total-items"])):$("",!0),s.displayMode==="card"?(f(),h("div",{key:1,class:z(["row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 active",{"fade-in":s.currentPage}]),ref:"dataContainer"},[(f(!0),h(O,null,W(s.DataList,a=>(f(),h("div",{class:"col",key:a.fileNo},[e("div",Ct,[e("div",xt,[e("h5",It,d(a.fileName),1),e("p",St,[t[12]||(t[12]=e("strong",null,"檔案序號:",-1)),L(" "+d(a.fileNo),1),t[13]||(t[13]=e("br",null,null,-1)),t[14]||(t[14]=e("strong",null,"案件序號:",-1)),L(" "+d(a.caseNo),1),t[15]||(t[15]=e("br",null,null,-1)),t[16]||(t[16]=e("strong",null,"文件類型:",-1)),L(" "+d(a.docType||"-"),1),t[17]||(t[17]=e("br",null,null,-1)),t[18]||(t[18]=e("strong",null,"啟用狀態:",-1)),e("span",{class:z(a.isActive?"text-success":"text-danger")},d(a.isActive?"啟用中":"已停用"),3),t[19]||(t[19]=e("br",null,null,-1)),t[20]||(t[20]=e("strong",null,"權限:",-1)),L(" "+d(a.filePermission),1),t[21]||(t[21]=e("br",null,null,-1)),t[22]||(t[22]=e("strong",null,"檔案路徑:",-1)),L(" "+d(a.filePath),1),t[23]||(t[23]=e("br",null,null,-1)),t[24]||(t[24]=e("strong",null,"定期刪除:",-1)),e("span",{class:z(a.isUseRetention?"text-success":"text-danger")},d(a.isUseRetention?"啟用":"未啟用"),3),t[25]||(t[25]=e("br",null,null,-1)),t[26]||(t[26]=e("strong",null,"刪除時間:",-1)),L(" "+d(a.deleteTime||"-"),1),t[27]||(t[27]=e("br",null,null,-1)),t[28]||(t[28]=e("strong",null,"上傳/覆蓋時間:",-1)),L(" "+d(a.uploadDate||"-"),1),t[29]||(t[29]=e("br",null,null,-1)),t[30]||(t[30]=e("strong",null,"描述:",-1)),L(" "+d(a.description||"-"),1)]),e("div",_t,[t[34]||(t[34]=e("button",{class:"btn btn-esun-outline dropdown-toggle w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"bi bi-gear me-1"}),L(" 操作選單 ")],-1)),e("ul",Ut,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j(n=>l(a),["prevent"])},t[31]||(t[31]=[e("i",{class:"bi bi-download me-1 text-info"},null,-1),L(" 預覽或下載 ")]),8,Nt)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j(n=>ye(a),["prevent"])},t[32]||(t[32]=[e("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),L(" 編輯 ")]),8,$t)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j(n=>ge(a),["prevent"])},t[33]||(t[33]=[e("i",{class:"bi bi-trash me-1 text-danger"},null,-1),L(" 刪除 ")]),8,Pt)])])])])])]))),128))],2)):(f(),h("div",{key:2,class:z([{"fade-in":s.currentPage},"active"]),ref:"dataContainer",style:{overflow:"auto"}},[e("table",Tt,[t[39]||(t[39]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"檔案名稱"),e("th",null,"檔案序號"),e("th",null,"案件序號"),e("th",null,"文件類型"),e("th",null,"啟用狀態"),e("th",null,"權限"),e("th",null,"檔案路徑"),e("th",null,"定期刪除"),e("th",null,"刪除時間"),e("th",null,"上傳/覆蓋時間"),e("th",null,"描述"),e("th",null,"操作")])],-1)),e("tbody",null,[(f(!0),h(O,null,W(s.DataList,a=>(f(),h("tr",{key:a.fileNo},[e("td",null,d(a.fileName),1),e("td",null,d(a.fileNo),1),e("td",null,d(a.caseNo),1),e("td",null,d(a.docType||"-"),1),e("td",null,[e("span",{class:z(a.isActive?"text-success":"text-danger")},d(a.isActive?"啟用中":"已停用"),3)]),e("td",null,d(a.filePermission),1),e("td",null,d(a.filePath),1),e("td",null,[e("span",{class:z(a.isUseRetention?"text-success":"text-danger")},d(a.isUseRetention?"啟用":"未啟用"),3)]),e("td",null,d(a.deleteTime||"-"),1),e("td",null,d(a.uploadDate||"-"),1),e("td",null,d(a.description||"-"),1),e("td",null,[e("div",Dt,[t[38]||(t[38]=e("button",{class:"btn btn-esun-outline dropdown-toggle btn-sm",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"bi bi-gear me-1"}),L(" 操作 ")],-1)),e("ul",Ft,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j(n=>l(a),["prevent"])},t[35]||(t[35]=[e("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),L(" 預覽或下載 ")]),8,zt)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j(n=>ye(a),["prevent"])},t[36]||(t[36]=[e("i",{class:"bi bi-pencil-square me-1 text-primary"},null,-1),L(" 編輯 ")]),8,Rt)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j(n=>ge(a),["prevent"])},t[37]||(t[37]=[e("i",{class:"bi bi-trash me-1 text-danger"},null,-1),L(" 刪除 ")]),8,Lt)])])])])]))),128))])])],2)),s.totalItems?(f(),K(ee,{key:3,modelValue:s.currentPage,"onUpdate:modelValue":t[9]||(t[9]=a=>s.currentPage=a),pageSize:s.pageSize,"onUpdate:pageSize":t[10]||(t[10]=a=>s.pageSize=a),"total-items":s.totalItems,"go-to-page":u},null,8,["modelValue","pageSize","total-items"])):$("",!0)]))}}),jt=te(At,[["__scopeId","data-v-5bd73a01"]]);export{jt as default};
//# sourceMappingURL=FileInfosManagement-BdRDIEmv.js.map
