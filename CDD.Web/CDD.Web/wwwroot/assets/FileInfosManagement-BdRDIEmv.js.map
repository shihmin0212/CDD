{"version":3,"file":"FileInfosManagement-BdRDIEmv.js","sources":["../../src/components/BackStage/6_FileInfos/CreateFileInfosModal.ts","../../src/components/BackStage/6_FileInfos/UpdateFileInfosModal.ts","../../src/components/modal/JsonFormModal/schema.ts","../../src/components/BackStage/6_FileInfos/BusinessSelectModal.vue","../../src/components/BackStage/6_FileInfos/FileCaseSelectModal.vue","../../src/components/BackStage/6_FileInfos/DocTypeSelectModal.vue","../../src/components/BackStage/6_FileInfos/ImagePreviewModal.vue","../../src/libs/ImageHelper.ts","../../src/components/BackStage/6_FileInfos/FileInfosManagement.vue"],"sourcesContent":["import type { MyModal } from '@/components/modal/JsonFormModal/schema';\r\nimport * as Common from '@/libs/Common';\r\n\r\n/**\r\n * 建立 FileInfos Modal 結構\r\n */\r\nexport const GetCreateFileInfosModal = (): MyModal => {\r\n    return {\r\n        modalId: 'fileInfosModal',\r\n        title: '新增檔案資訊',\r\n        showModal: false,\r\n        size: 'modal-xl',\r\n        staticBackdrop: true,\r\n        scrollable: true,\r\n        fieldGroups: [\r\n            {\r\n                title: '',\r\n                gridClass: 'col-6',\r\n                fields: [\r\n                    {\r\n                        modelId: 'business',\r\n                        name: 'business',\r\n                        type: 'text',\r\n                        label: '選擇業務別',\r\n                        placeholder: '請選擇業務別',\r\n                        required: false,\r\n                        maxlength: 25,\r\n                        readonly: true,\r\n                        onSubmitCheckCallback: (value: string, formData: any) => {\r\n                            // 驗證business和caseNo必須至少有一項有值\r\n                            if (!value && !formData.caseNo) {\r\n                                return '業務別和檔案案件必須至少選擇一項';\r\n                            }\r\n                            return '';\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'caseNo',\r\n                        name: 'caseNo',\r\n                        type: 'text',\r\n                        label: '選擇檔案案件',\r\n                        placeholder: '請選擇檔案案件',\r\n                        required: false,\r\n                        maxlength: 36,\r\n                        readonly: true,\r\n                        onSubmitCheckCallback: (value: string, formData: any) => {\r\n                            // 驗證business和caseNo必須至少有一項有值\r\n                            if (!value && !formData.business) {\r\n                                return '業務別和檔案案件必須至少選擇一項';\r\n                            }\r\n                            return '';\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'docType',\r\n                        name: 'docType',\r\n                        type: 'text',\r\n                        label: '選擇文件類型',\r\n                        placeholder: '請選擇文件類型',\r\n                        required: true,\r\n                        readonly: true,\r\n                        maxlength: 50\r\n                    },\r\n                    {\r\n                        modelId: 'isForceFileUpload',\r\n                        name: 'isForceFileUpload',\r\n                        type: 'radio',\r\n                        label: '檔案名稱已存在時',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '擋掉重複檔案', value: true },\r\n                            { label: '允許同名檔案', value: false }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'fileUpload',\r\n                        name: 'fileUpload',\r\n                        type: 'file',\r\n                        label: '上傳檔案',\r\n                        hint: '選擇要上傳的檔案，檔案名稱將自動填入',\r\n                        accept: '.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar',\r\n                        maxSize: 50 * 1024 * 1024, // 50MB\r\n                        multiple: false,\r\n                        required: true,\r\n                        onInputCallback: (value: File | File[] | null) => {\r\n                            // 當選擇檔案時，自動填入檔案名稱\r\n                            // 這個 callback 會在 Vue 組件中動態設定\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'fileName',\r\n                        name: 'fileName',\r\n                        type: 'text',\r\n                        label: '檔案名稱',\r\n                        placeholder: '將自動從上傳的檔案中填入',\r\n                        required: false,\r\n                        maxlength: 255,\r\n                        disabled: true\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                title: '',\r\n                gridClass: 'col-6',\r\n                fields: [\r\n                    {\r\n                        modelId: 'isActive',\r\n                        name: 'isActive',\r\n                        type: 'radio',\r\n                        label: '是否啟用（可否存取）',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '啟用', value: true },\r\n                            { label: '停用', value: false }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'filePermission',\r\n                        name: 'filePermission',\r\n                        type: 'radio',\r\n                        label: '權限控制',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '不限制任何系統都可以存取 (Public)', value: '0' },\r\n                            { label: '限制跟我所屬業務別註冊的業務別都可以存取 (Protect)', value: '1' },\r\n                            { label: '限制跟我註冊的業務別都可以存取 (Protect_Internal)', value: '2' },\r\n                            { label: '自己才可存取 (Private)', value: '3' }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'description',\r\n                        name: 'description',\r\n                        type: 'textarea',\r\n                        label: '自訂描述',\r\n                        placeholder: '請輸入描述',\r\n                        required: false,\r\n                        maxlength: 500,\r\n                        rows: 3\r\n                    },\r\n                    {\r\n                        modelId: 'isUseRetention',\r\n                        name: 'isUseRetention',\r\n                        type: 'radio',\r\n                        label: '是否啟用定期刪除',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '啟用', value: true },\r\n                            { label: '不啟用', value: false }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'deleteTime',\r\n                        name: 'deleteTime',\r\n                        type: 'text',\r\n                        label: '定期刪除的時間點 (yyyy-MM-dd HH:mm:ss)',\r\n                        placeholder: 'yyyy-MM-dd HH:mm:ss',\r\n                        required: false,\r\n                        maxlength: 20,\r\n                        disabled: true,\r\n                        onSubmitCheckCallback: (value: string, formData) => {\r\n                            let error = '';\r\n                            if (formData?.isUseRetention === true) {\r\n                                if (!value) {\r\n                                    error = '請填寫 定期刪除的時間點 ';\r\n                                } else if (Common.IsValidDateTime(value) === false) {\r\n                                    error = '時間格式錯誤';\r\n                                }\r\n                            }\r\n\r\n                            return error;\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'uploadDate',\r\n                        name: 'uploadDate',\r\n                        type: 'text',\r\n                        label: '上傳或覆蓋的時間點 (yyyy-MM-dd HH:mm:ss)',\r\n                        placeholder: 'yyyy-MM-dd HH:mm:ss',\r\n                        required: false,\r\n                        maxlength: 20,\r\n                        disabled: true,\r\n                        onSubmitCheckCallback: (value: string, formData) => {\r\n                            let error = '';\r\n                            if (formData?.isUseRetention === true) {\r\n                                if (!value) {\r\n                                    error = '請填寫 上傳或覆蓋的時間點 ';\r\n                                } else if (Common.IsValidDateTime(value) === false) {\r\n                                    error = '時間格式錯誤';\r\n                                }\r\n                            }\r\n\r\n                            return error;\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n};\r\n\r\nexport interface FileInfosFormData {\r\n    business: string;\r\n    caseNo: string;\r\n    docType: number | null;\r\n    docName: string;\r\n    fileNo: string;\r\n    isForceFileUpload: boolean;\r\n    fileUpload: File | null;\r\n    fileSrc: string | null;\r\n    fileName: string;\r\n    isActive: boolean;\r\n    filePermission: string;\r\n    description?: string | null;\r\n    filePath: string;\r\n    isUseRetention: boolean;\r\n    deleteTime?: string | null;\r\n    uploadDate?: string | null;\r\n}\r\n\r\nexport const GetDefaultFormData = (): FileInfosFormData => {\r\n    return {\r\n        business: '',\r\n        caseNo: '',\r\n        docType: null,\r\n        docName: '',\r\n        fileNo: '',\r\n        isForceFileUpload: true,\r\n        fileUpload: null,\r\n        fileSrc: null,\r\n        fileName: '',\r\n        isActive: true,\r\n        filePermission: '3',\r\n        description: null,\r\n        filePath: '',\r\n        isUseRetention: false,\r\n        deleteTime: null,\r\n        uploadDate: null\r\n    };\r\n};\r\n","import type { MyModal } from '@/components/modal/JsonFormModal/schema';\r\nimport * as Common from '@/libs/Common';\r\n\r\n/**\r\n * 建立 FileInfos 更新 Modal 結構\r\n */\r\nexport const GetUpdateFileInfosModal = (): MyModal => {\r\n    return {\r\n        modalId: 'updateFileInfosModal',\r\n        title: '編輯檔案資訊',\r\n        showModal: false,\r\n        size: 'modal-xl',\r\n        staticBackdrop: true,\r\n        scrollable: true,\r\n        fieldGroups: [\r\n            {\r\n                title: '',\r\n                gridClass: 'col-6',\r\n                fields: [\r\n                    {\r\n                        modelId: 'business',\r\n                        name: 'business',\r\n                        type: 'text',\r\n                        label: '選擇業務別',\r\n                        placeholder: '請選擇業務別',\r\n                        required: false,\r\n                        maxlength: 25,\r\n                        readonly: true,\r\n                        onSubmitCheckCallback: (value: string, formData: any) => {\r\n                            // 驗證business和caseNo必須至少有一項有值\r\n                            if (!value && !formData.caseNo) {\r\n                                return '業務別和檔案案件必須至少選擇一項';\r\n                            }\r\n                            return '';\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'caseNo',\r\n                        name: 'caseNo',\r\n                        type: 'text',\r\n                        label: '選擇檔案案件',\r\n                        placeholder: '請選擇檔案案件',\r\n                        required: false,\r\n                        maxlength: 36,\r\n                        readonly: true,\r\n                        onSubmitCheckCallback: (value: string, formData: any) => {\r\n                            // 驗證business和caseNo必須至少有一項有值\r\n                            if (!value && !formData.business) {\r\n                                return '業務別和檔案案件必須至少選擇一項';\r\n                            }\r\n                            return '';\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'docType',\r\n                        name: 'docType',\r\n                        type: 'text',\r\n                        label: '選擇文件類型',\r\n                        placeholder: '請選擇文件類型',\r\n                        required: true,\r\n                        readonly: true,\r\n                        maxlength: 50\r\n                    },\r\n                    {\r\n                        modelId: 'fileNo',\r\n                        name: 'fileNo',\r\n                        type: 'text',\r\n                        label: '檔案序號',\r\n                        placeholder: '檔案序號',\r\n                        required: true,\r\n                        maxlength: 36,\r\n                        readonly: true\r\n                    },\r\n                    {\r\n                        modelId: 'isForceFileUpload',\r\n                        name: 'isForceFileUpload',\r\n                        type: 'radio',\r\n                        label: '檔案名稱已存在時',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '擋掉重複檔案', value: true },\r\n                            { label: '允許同名檔案', value: false }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'fileUpload',\r\n                        name: 'fileUpload',\r\n                        type: 'file',\r\n                        label: '上傳檔案',\r\n                        hint: '選擇要上傳的檔案，檔案名稱將自動填入',\r\n                        accept: '.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar',\r\n                        maxSize: 50 * 1024 * 1024, // 50MB\r\n                        multiple: false,\r\n                        required: false,\r\n                        onInputCallback: (value: File | File[] | null) => {\r\n                            // 當選擇檔案時，自動填入檔案名稱\r\n                            // 這個 callback 會在 Vue 組件中動態設定\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'fileName',\r\n                        name: 'fileName',\r\n                        type: 'text',\r\n                        label: '檔案名稱',\r\n                        placeholder: '將自動從上傳的檔案中填入',\r\n                        required: true,\r\n                        maxlength: 255,\r\n                        disabled: true\r\n                    },\r\n                    {\r\n                        modelId: 'filePath',\r\n                        name: 'filePath',\r\n                        type: 'text',\r\n                        label: '檔案路徑',\r\n                        placeholder: '檔案儲存路徑',\r\n                        required: false,\r\n                        maxlength: 500,\r\n                        disabled: true\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                title: '',\r\n                gridClass: 'col-6',\r\n                fields: [\r\n                    {\r\n                        modelId: 'isActive',\r\n                        name: 'isActive',\r\n                        type: 'radio',\r\n                        label: '是否啟用（可否存取）',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '啟用', value: true },\r\n                            { label: '停用', value: false }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'filePermission',\r\n                        name: 'filePermission',\r\n                        type: 'radio',\r\n                        label: '權限控制',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '不限制任何系統都可以存取 (Public)', value: '0' },\r\n                            { label: '限制跟我所屬業務別註冊的業務別都可以存取 (Protect)', value: '1' },\r\n                            { label: '限制跟我註冊的業務別都可以存取 (Protect_Internal)', value: '2' },\r\n                            { label: '自己才可存取 (Private)', value: '3' }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'description',\r\n                        name: 'description',\r\n                        type: 'textarea',\r\n                        label: '自訂描述',\r\n                        placeholder: '請輸入描述',\r\n                        required: false,\r\n                        maxlength: 500,\r\n                        rows: 3\r\n                    },\r\n                    {\r\n                        modelId: 'isUseRetention',\r\n                        name: 'isUseRetention',\r\n                        type: 'radio',\r\n                        label: '是否啟用定期刪除',\r\n                        inline: true,\r\n                        options: [\r\n                            { label: '啟用', value: true },\r\n                            { label: '不啟用', value: false }\r\n                        ],\r\n                        required: true\r\n                    },\r\n                    {\r\n                        modelId: 'deleteTime',\r\n                        name: 'deleteTime',\r\n                        type: 'text',\r\n                        label: '定期刪除的時間點 (yyyy-MM-dd)',\r\n                        required: false,\r\n                        maxlength: 20,\r\n                        onSubmitCheckCallback: (value: string, formData) => {\r\n                            let error = '';\r\n                            if (formData?.isUseRetention === true) {\r\n                                if (!value) {\r\n                                    error = '請填寫 定期刪除的時間點 ';\r\n                                } else if (Common.IsValidDateTime(value) === false) {\r\n                                    error = '時間格式錯誤';\r\n                                }\r\n                            }\r\n                            return error;\r\n                        }\r\n                    },\r\n                    {\r\n                        modelId: 'uploadDate',\r\n                        name: 'uploadDate',\r\n                        type: 'text',\r\n                        label: '上傳或覆蓋的時間點 (yyyy-MM-dd)',\r\n                        required: false,\r\n                        maxlength: 20,\r\n                        onSubmitCheckCallback: (value: string, formData) => {\r\n                            let error = '';\r\n                            if (formData?.isUseRetention === true) {\r\n                                if (!value) {\r\n                                    error = '請填寫 上傳或覆蓋的時間點 ';\r\n                                } else if (Common.IsValidDateTime(value) === false) {\r\n                                    error = '時間格式錯誤';\r\n                                }\r\n                            }\r\n\r\n                            return error;\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    };\r\n};\r\n\r\nexport interface UpdateFileInfosFormData {\r\n    fileNo: string;\r\n    business: string;\r\n    caseNo: string;\r\n    docType: number | null;\r\n    docName: string;\r\n    isForceFileUpload: boolean | null;\r\n    fileUpload: File | null;\r\n    fileSrc: string | null;\r\n    fileName: string;\r\n    isActive: boolean | null;\r\n    filePermission: string;\r\n    description?: string | null;\r\n    filePath: string;\r\n    isUseRetention: boolean | null;\r\n    deleteTime?: string | null;\r\n    uploadDate?: string | null;\r\n}\r\n\r\nexport const GetDefaultUpdateFormData = (): UpdateFileInfosFormData => {\r\n    return {\r\n        fileNo: '',\r\n        business: '',\r\n        caseNo: '',\r\n        docType: null,\r\n        docName: '',\r\n        isForceFileUpload: null,\r\n        fileUpload: null,\r\n        fileSrc: '',\r\n        fileName: '',\r\n        isActive: null,\r\n        filePermission: '3',\r\n        description: null,\r\n        filePath: '',\r\n        isUseRetention: null,\r\n        deleteTime: null,\r\n        uploadDate: null\r\n    };\r\n};\r\n","// schema.ts\r\nexport type FieldType = 'text' | 'select' | 'checkbox' | 'radio' | 'textarea' | 'file' | 'datetime';\r\nexport type ModalSize = 'modal-sm' | 'modal-lg' | 'modal-xl' | 'modal-fullscreen';\r\nexport interface MyModal {\r\n    modalId: string;\r\n    title: string;\r\n    showModal: boolean;\r\n    size: ModalSize;\r\n    staticBackdrop: boolean;\r\n    scrollable?: boolean;\r\n    fieldGroups: FieldsGridGroup[];\r\n    methods?: {\r\n        Check: (value: string) => void;\r\n    };\r\n}\r\n\r\nexport interface FieldsGridGroup {\r\n    gridClass: string;\r\n    title?: string | null;\r\n    fields: Field[];\r\n}\r\n\r\n// 擴充 CheckboxField / RadioField 的 options\r\nexport interface FieldOption {\r\n    label: string;\r\n    value: string | boolean | number;\r\n    disabled?: boolean;\r\n    tooltip?: string;\r\n    hint?: string;\r\n}\r\n\r\ntype IBaseField = {\r\n    type: FieldType;\r\n    label: string;\r\n    hint?: string;\r\n    name: string;\r\n    modelId: string;\r\n\r\n    required?: boolean;\r\n    disabled?: boolean;\r\n    placeholder?: string;\r\n    error?: string;\r\n};\r\n\r\nexport interface TextField extends IBaseField {\r\n    type: 'text';\r\n    maxlength: number;\r\n    readonly?: boolean;\r\n    onChangeCallback?: (value: string) => void;\r\n    onInputCallback?: (value: string) => void;\r\n    onClickCallback?: () => void;\r\n    onSubmitCheckCallback?: (value: string, formData?: Record<string, any>) => string;\r\n    onClearInput?: () => void;\r\n}\r\n\r\nexport interface TextareaField extends IBaseField {\r\n    type: 'textarea';\r\n    rows: number | 50;\r\n    maxlength: number;\r\n    onChangeCallback?: (value: string) => void;\r\n    onInputCallback?: (value: string) => void;\r\n    onSubmitCheckCallback?: (value: string) => string;\r\n}\r\n\r\nexport interface RadioField extends IBaseField {\r\n    type: 'radio';\r\n    options: FieldOption[];\r\n    inline?: boolean;\r\n    onChangeCallback?: (value: string | boolean | number) => void;\r\n    onInputCallback?: (value: string | boolean | number) => void;\r\n    onSubmitCheckCallback?: (value: string | boolean | number) => string;\r\n}\r\n\r\nexport interface SelectField extends IBaseField {\r\n    type: 'select';\r\n    options: FieldOption[];\r\n    onChangeCallback?: (value: string) => void;\r\n    onInputCallback?: (value: string) => void;\r\n    onSubmitCheckCallback?: (value: string) => string;\r\n}\r\n\r\nexport interface CheckboxField extends IBaseField {\r\n    type: 'checkbox';\r\n    options: FieldOption[];\r\n    inline?: boolean;\r\n    onChangeCallback?: (value: string[] | number[]) => void;\r\n    onInputCallback?: (value: string[] | number[]) => void;\r\n    onSubmitCheckCallback?: (value: string[] | number[]) => string;\r\n}\r\n\r\nexport interface FileField extends IBaseField {\r\n    type: 'file';\r\n    accept?: string; // 檔案格式限制，例如: '.pdf,.doc,.docx' 或 'image/*'\r\n    multiple?: boolean; // 是否允許多檔案上傳\r\n    maxSize?: number; // 檔案大小限制 (bytes)\r\n    maxFiles?: number; // 最大檔案數量\r\n    onChangeCallback?: (value: File[] | File | null) => void;\r\n    onInputCallback?: (value: File[] | File | null) => void;\r\n    onSubmitCheckCallback?: (value: File[] | File | null) => string;\r\n}\r\n\r\nexport interface DatetimeField extends IBaseField {\r\n    type: 'datetime';\r\n    minDate?: string; // 最小日期時間，格式: YYYY-MM-DDTHH:MM\r\n    maxDate?: string; // 最大日期時間，格式: YYYY-MM-DDTHH:MM\r\n    onChangeCallback?: (value: Date | null) => void;\r\n    onInputCallback?: (value: Date | null) => void;\r\n    onSubmitCheckCallback?: (value: Date | null) => string;\r\n}\r\n\r\nexport type Field = CheckboxField | TextField | RadioField | SelectField | TextareaField | FileField | DatetimeField;\r\nexport type FieldValue<T extends Field> = T extends TextField | TextareaField | RadioField | SelectField\r\n    ? string\r\n    : T extends CheckboxField\r\n      ? string[]\r\n      : T extends FileField\r\n        ? File[] | File | null\r\n        : T extends DatetimeField\r\n          ? Date | null\r\n          : never;\r\n\r\n// Type-safe overloads\r\nexport function createField(field: TextField): TextField;\r\nexport function createField(field: CheckboxField): CheckboxField;\r\nexport function createField(field: SelectField): SelectField;\r\nexport function createField(field: RadioField): RadioField;\r\nexport function createField(field: TextareaField): TextareaField;\r\nexport function createField(field: FileField): FileField;\r\nexport function createField(field: DatetimeField): DatetimeField;\r\n\r\n// 通用 callback\r\nexport function createField<T extends Field>(field: T): T {\r\n    return field;\r\n}\r\n\r\n/**\r\n * @todo 尋找Field by Id\r\n * @param myModal\r\n * @param lookupId\r\n * @returns\r\n */\r\nexport function getFieldsGridGroupById(myModal: MyModal, lookupId: string): Field | null {\r\n    for (const group of myModal.fieldGroups) {\r\n        for (const field of group.fields) {\r\n            if (field.modelId === lookupId) {\r\n                return field;\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n","<template>\r\n    <div\r\n        v-if=\"SelectModal.ModalInstance.showModal\"\r\n        class=\"modal show d-block\"\r\n        tabindex=\"-1\"\r\n        :aria-labelledby=\"SelectModal.ModalInstance.modalId\"\r\n        :aria-hidden=\"!SelectModal.ModalInstance.showModal\"\r\n        @click=\"handleBackgroundClick\"\r\n        :class=\"{ 'static-backdrop-animation': SelectModal.ModalInstance.animateBackdrop }\"\r\n    >\r\n        <div\r\n            class=\"modal-dialog\"\r\n            :class=\"[\r\n                SelectModal.ModalInstance.size,\r\n                SelectModal.ModalInstance.scrollable ? 'modal-dialog-scrollable' : ''\r\n            ]\"\r\n        >\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">{{ SelectModal.ModalInstance.title }}</h5>\r\n                    <button type=\"button\" class=\"btn-close\" @click=\"closeModal\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <!-- 搜尋輸入框 -->\r\n                    <div class=\"mb-3\">\r\n                        <div class=\"input-group\">\r\n                            <span class=\"input-group-text\">\r\n                                <i class=\"bi bi-search\"></i>\r\n                            </span>\r\n                            <input\r\n                                type=\"text\"\r\n                                class=\"form-control\"\r\n                                placeholder=\"搜尋業務別代號...\"\r\n                                v-model=\"searchInput\"\r\n                                @keyup.enter=\"handleSearch\"\r\n                            />\r\n                            <button class=\"btn btn-esun-primary\" type=\"button\" @click=\"handleSearch\">搜尋</button>\r\n                            <button\r\n                                class=\"btn btn-esun-outline\"\r\n                                type=\"button\"\r\n                                @click=\"clearSearch\"\r\n                                v-if=\"SelectModal.SearchQuery\"\r\n                            >\r\n                                清除\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"btn-group me-2 mb-3\" role=\"group\" aria-label=\"First group\">\r\n                        <button\r\n                            type=\"button\"\r\n                            class=\"btn btn-esun-outline\"\r\n                            :class=\"{ active: SelectModal.DisplayMode === 'card' }\"\r\n                            @click=\"SelectModal.DisplayMode = 'card'\"\r\n                        >\r\n                            卡片顯示\r\n                        </button>\r\n                        <button\r\n                            type=\"button\"\r\n                            class=\"btn btn-esun-outline\"\r\n                            :class=\"{ active: SelectModal.DisplayMode === 'table' }\"\r\n                            @click=\"SelectModal.DisplayMode = 'table'\"\r\n                        >\r\n                            表格顯示\r\n                        </button>\r\n                    </div>\r\n                    <div v-if=\"SelectModal.DataList.length === 0\" class=\"text-muted\">無業務別資料</div>\r\n\r\n                    <div\r\n                        v-if=\"SelectModal.DisplayMode === 'card'\"\r\n                        class=\"d-flex flex-wrap w-100\"\r\n                        style=\"min-height: 400px\"\r\n                    >\r\n                        <div\r\n                            v-for=\"(item, index) in SelectModal.DataList\"\r\n                            :key=\"index\"\r\n                            class=\"p-2\"\r\n                            style=\"flex: 1 1 0; min-width: 33.33%; max-width: 33.33%; width: 33.33%\"\r\n                        >\r\n                            <div class=\"card\">\r\n                                <div\r\n                                    class=\"card-body p-2 d-flex flex-column justify-content-between\"\r\n                                    style=\"height: 140px\"\r\n                                >\r\n                                    <div class=\"mb-2\">\r\n                                        <div class=\"text-truncate fw-bold\" :title=\"item.business\" style=\"width: 100%\">\r\n                                            {{ item.business }}\r\n                                        </div>\r\n                                        <div class=\"text-muted small\">系統: {{ item.system }}</div>\r\n                                        <div class=\"text-muted small\">\r\n                                            狀態: {{ item.isActive === 'Y' ? '啟用' : '停用' }}\r\n                                        </div>\r\n                                        <div class=\"text-muted small\">建立時間: {{ formatDate(item.createdTime) }}</div>\r\n                                    </div>\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        class=\"btn btn-sm btn-esun-primary align-self-end\"\r\n                                        @click=\"selectBusiness(item)\"\r\n                                        :disabled=\"item.isActive !== 'Y'\"\r\n                                    >\r\n                                        選擇\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div v-if=\"SelectModal.DisplayMode === 'table'\" style=\"min-height: 400px\">\r\n                        <table class=\"table table-bordered table-hover\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>業務別代號</th>\r\n                                    <th>系統代號</th>\r\n                                    <th>狀態</th>\r\n                                    <th>建立時間</th>\r\n                                    <th>操作</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"(item, index) in SelectModal.DataList\" :key=\"index\">\r\n                                    <td>{{ item.business }}</td>\r\n                                    <td>{{ item.system }}</td>\r\n                                    <td>\r\n                                        <span :class=\"item.isActive === 'Y' ? 'text-success' : 'text-danger'\">\r\n                                            {{ item.isActive === 'Y' ? '啟用' : '停用' }}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td>{{ formatDate(item.createdTime) }}</td>\r\n                                    <td>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            class=\"btn btn-sm btn-esun-primary\"\r\n                                            @click=\"selectBusiness(item)\"\r\n                                            :disabled=\"item.isActive !== 'Y'\"\r\n                                        >\r\n                                            選擇\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <Pagination\r\n                        v-if=\"SelectModal.DataList.length > 0\"\r\n                        v-model:modelValue=\"SelectModal.CurrentPage\"\r\n                        v-model:pageSize=\"SelectModal.PageSize\"\r\n                        :total-items=\"SelectModal.TotalItems\"\r\n                    />\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button class=\"btn btn-esun-outline\" @click.prevent=\"closeModal\">取消</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, watch } from 'vue';\r\nimport type { MyBaseModal } from '@/components/modal/BaseModal/schema';\r\nimport Pagination from '@/components/pagination/Pagination.vue';\r\nimport * as ApiClient from '@/libs/ApiClient';\r\nimport API from '@/api/v1/';\r\nimport type { BusinessDTO } from '@/models/DTO/BusinessDTO';\r\nimport * as Common from '@/libs/Common';\r\n\r\nexport interface SelectModal {\r\n    ModalInstance: MyBaseModal;\r\n    PaginationType: 'server' | 'client';\r\n    DisplayMode: 'table' | 'card';\r\n    DataList: BusinessDTO[];\r\n    TotalItems: number;\r\n    CurrentPage: number;\r\n    PageSize: number;\r\n    SearchQuery: string;\r\n}\r\n\r\nconst SelectModal = ref<SelectModal>(GetDefaultSelectModal());\r\n\r\n// 搜尋輸入框的值（與實際搜尋條件分離）\r\nconst searchInput = ref('');\r\n\r\nfunction GetDefaultSelectModal(): SelectModal {\r\n    return {\r\n        ModalInstance: {\r\n            modalId: 'BusinessSelectModal',\r\n            title: '選擇業務別',\r\n            showModal: false,\r\n            size: 'modal-xl',\r\n            staticBackdrop: true,\r\n            animateBackdrop: false,\r\n            scrollable: true\r\n        },\r\n        PaginationType: 'server',\r\n        DisplayMode: 'table',\r\n        DataList: [],\r\n        TotalItems: 0,\r\n        CurrentPage: 1,\r\n        PageSize: 10,\r\n        SearchQuery: ''\r\n    };\r\n}\r\n\r\n// 分頁監聽\r\nwatch(\r\n    () => ({\r\n        currentPage: SelectModal.value.CurrentPage,\r\n        pageSize: SelectModal.value.PageSize\r\n    }),\r\n    () => {\r\n        LoadViewData();\r\n    }\r\n);\r\n\r\n/**\r\n * 展開Modal\r\n */\r\nasync function openModal() {\r\n    SelectModal.value = GetDefaultSelectModal();\r\n    searchInput.value = ''; // 清空搜尋輸入框\r\n    await LoadViewData();\r\n    SelectModal.value.ModalInstance.showModal = true;\r\n}\r\n\r\n/**\r\n * 關閉Modal\r\n */\r\nfunction closeModal() {\r\n    SelectModal.value.ModalInstance.showModal = false;\r\n}\r\n\r\n/**\r\n * 處理點擊背景事件，觸發背景動畫\r\n */\r\nfunction handleBackgroundClick(event: MouseEvent) {\r\n    if (event.target === event.currentTarget) {\r\n        SelectModal.value.ModalInstance.animateBackdrop = true;\r\n        setTimeout(() => {\r\n            SelectModal.value.ModalInstance.animateBackdrop = false;\r\n        }, 150);\r\n    }\r\n}\r\n\r\n/**\r\n * 載入業務別資料\r\n */\r\nconst LoadViewData = async () => {\r\n    try {\r\n        // 呼叫業務別管理API，包含搜尋參數\r\n        const response = await API.BusinessManagementViewData(\r\n            SelectModal.value.SearchQuery,\r\n            SelectModal.value.CurrentPage,\r\n            SelectModal.value.PageSize\r\n        );\r\n\r\n        if (response && response.status) {\r\n            SelectModal.value.DataList = response.result.items.filter(\r\n                (item) => item.isActive === 'Y' && item.isDeleted !== 'Y'\r\n            );\r\n            SelectModal.value.TotalItems = response.result.totalCount;\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching Business data:', error);\r\n    }\r\n};\r\n\r\n// 節流處理LoadViewData，避免按鈕被連續點擊\r\nconst throttledLoadViewData = Common.Throttle(LoadViewData, 300);\r\n\r\n/**\r\n * 選擇業務別\r\n */\r\nfunction selectBusiness(item: BusinessDTO) {\r\n    emit('select', item.business);\r\n    closeModal();\r\n}\r\n\r\n/**\r\n * 格式化日期\r\n */\r\nfunction formatDate(dateString: string): string {\r\n    if (!dateString) return '';\r\n    try {\r\n        const date = new Date(dateString);\r\n        return date.toLocaleDateString('zh-TW', {\r\n            year: 'numeric',\r\n            month: '2-digit',\r\n            day: '2-digit'\r\n        });\r\n    } catch {\r\n        return dateString;\r\n    }\r\n}\r\n\r\n/**\r\n * 處理搜尋按鈕點擊\r\n */\r\nfunction handleSearch() {\r\n    // 更新搜尋條件並重置到第一頁\r\n    SelectModal.value.SearchQuery = searchInput.value;\r\n    SelectModal.value.CurrentPage = 1;\r\n    throttledLoadViewData();\r\n}\r\n\r\n/**\r\n * 清除搜尋\r\n */\r\nfunction clearSearch() {\r\n    searchInput.value = '';\r\n    SelectModal.value.SearchQuery = '';\r\n    SelectModal.value.CurrentPage = 1;\r\n    throttledLoadViewData();\r\n}\r\n\r\n// 定義事件發射器\r\nconst emit = defineEmits<{\r\n    select: [business: string];\r\n}>();\r\n\r\n// 將方法暴露給父元件使用\r\ndefineExpose({ openModal });\r\n</script>\r\n\r\n<style scoped>\r\n.modal {\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n.modal-dialog {\r\n    background-color: transparent;\r\n}\r\n\r\n.static-backdrop-animation {\r\n    animation: staticBackdropAnimation 0.15s ease-in-out;\r\n}\r\n\r\n.modal-dialog-scrollable .modal-body {\r\n    max-height: calc(100vh - 200px);\r\n    overflow-y: auto;\r\n}\r\n\r\n@keyframes staticBackdropAnimation {\r\n    0% {\r\n        transform: scale(1);\r\n    }\r\n    50% {\r\n        transform: scale(1.02);\r\n    }\r\n    100% {\r\n        transform: scale(1);\r\n    }\r\n}\r\n</style>\r\n","<template>\r\n    <div\r\n        v-if=\"SelectModal.ModalInstance.showModal\"\r\n        class=\"modal show d-block\"\r\n        tabindex=\"-1\"\r\n        :aria-labelledby=\"SelectModal.ModalInstance.modalId\"\r\n        :aria-hidden=\"!SelectModal.ModalInstance.showModal\"\r\n        @click=\"handleBackgroundClick\"\r\n        :class=\"{ 'static-backdrop-animation': SelectModal.ModalInstance.animateBackdrop }\"\r\n    >\r\n        <div\r\n            class=\"modal-dialog\"\r\n            :class=\"[\r\n                SelectModal.ModalInstance.size,\r\n                SelectModal.ModalInstance.scrollable ? 'modal-dialog-scrollable' : ''\r\n            ]\"\r\n        >\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">{{ SelectModal.ModalInstance.title }}</h5>\r\n                    <button type=\"button\" class=\"btn-close\" @click=\"closeModal\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <!-- 搜尋輸入框 -->\r\n                    <div class=\"mb-3\">\r\n                        <div class=\"input-group\">\r\n                            <span class=\"input-group-text\">\r\n                                <i class=\"bi bi-search\"></i>\r\n                            </span>\r\n                            <input\r\n                                type=\"text\"\r\n                                class=\"form-control\"\r\n                                placeholder=\"搜尋文件類別序號、業務別...\"\r\n                                v-model=\"searchInput\"\r\n                                @keyup.enter=\"handleSearch\"\r\n                            />\r\n                            <button class=\"btn btn-esun-primary\" type=\"button\" @click=\"handleSearch\">搜尋</button>\r\n                            <button\r\n                                class=\"btn btn-esun-outline\"\r\n                                type=\"button\"\r\n                                @click=\"clearSearch\"\r\n                                v-if=\"SelectModal.SearchQuery\"\r\n                            >\r\n                                清除\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"btn-group me-2 mb-3\" role=\"group\" aria-label=\"First group\">\r\n                        <button\r\n                            type=\"button\"\r\n                            class=\"btn btn-esun-outline\"\r\n                            :class=\"{ active: SelectModal.DisplayMode === 'card' }\"\r\n                            @click=\"SelectModal.DisplayMode = 'card'\"\r\n                        >\r\n                            卡片顯示\r\n                        </button>\r\n                        <button\r\n                            type=\"button\"\r\n                            class=\"btn btn-esun-outline\"\r\n                            :class=\"{ active: SelectModal.DisplayMode === 'table' }\"\r\n                            @click=\"SelectModal.DisplayMode = 'table'\"\r\n                        >\r\n                            表格顯示\r\n                        </button>\r\n                    </div>\r\n                    <div v-if=\"SelectModal.DataList.length === 0\" class=\"text-muted\">無檔案案件資料</div>\r\n\r\n                    <div\r\n                        v-if=\"SelectModal.DisplayMode === 'card'\"\r\n                        class=\"d-flex flex-wrap w-100\"\r\n                        style=\"min-height: 400px\"\r\n                    >\r\n                        <div\r\n                            v-for=\"(item, index) in SelectModal.DataList\"\r\n                            :key=\"index\"\r\n                            class=\"p-2\"\r\n                            style=\"flex: 1 1 0; min-width: 33.33%; max-width: 33.33%; width: 33.33%\"\r\n                        >\r\n                            <div class=\"card\">\r\n                                <div\r\n                                    class=\"card-body p-2 d-flex flex-column justify-content-between\"\r\n                                    style=\"height: 140px\"\r\n                                >\r\n                                    <div class=\"mb-2\">\r\n                                        <div class=\"text-truncate fw-bold\" :title=\"item.caseNo\" style=\"width: 100%\">\r\n                                            {{ item.caseNo }}\r\n                                        </div>\r\n                                        <div class=\"text-muted small\">業務別: {{ item.business }}</div>\r\n                                        <div class=\"text-muted small\">\r\n                                            權限: {{ getPermissionText(item.permission) }}\r\n                                        </div>\r\n                                        <div class=\"text-muted small\">更新時間: {{ formatDate(item.updateTime) }}</div>\r\n                                    </div>\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        class=\"btn btn-sm btn-esun-primary align-self-end\"\r\n                                        @click=\"selectFileCase(item)\"\r\n                                    >\r\n                                        選擇\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div v-if=\"SelectModal.DisplayMode === 'table'\" style=\"min-height: 400px\">\r\n                        <table class=\"table table-bordered table-hover\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>文件類別序號</th>\r\n                                    <th>業務別</th>\r\n                                    <th>權限</th>\r\n                                    <th>更新時間</th>\r\n                                    <th>操作</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"(item, index) in SelectModal.DataList\" :key=\"index\">\r\n                                    <td>{{ item.caseNo }}</td>\r\n                                    <td>{{ item.business }}</td>\r\n                                    <td>{{ getPermissionText(item.permission) }}</td>\r\n                                    <td>{{ formatDate(item.updateTime) }}</td>\r\n                                    <td>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            class=\"btn btn-sm btn-esun-primary\"\r\n                                            @click=\"selectFileCase(item)\"\r\n                                        >\r\n                                            選擇\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <Pagination\r\n                        v-if=\"SelectModal.DataList.length > 0\"\r\n                        v-model:modelValue=\"SelectModal.CurrentPage\"\r\n                        v-model:pageSize=\"SelectModal.PageSize\"\r\n                        :total-items=\"SelectModal.TotalItems\"\r\n                    />\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button class=\"btn btn-esun-outline\" @click.prevent=\"closeModal\">取消</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, watch } from 'vue';\r\nimport type { MyBaseModal } from '@/components/modal/BaseModal/schema';\r\nimport Pagination from '@/components/pagination/Pagination.vue';\r\nimport * as ApiClient from '@/libs/ApiClient';\r\nimport API from '@/api/v1/';\r\nimport type { FileCase } from '@/models/DTO/FileCase';\r\nimport * as Common from '@/libs/Common';\r\n\r\nexport interface SelectModal {\r\n    ModalInstance: MyBaseModal;\r\n    PaginationType: 'server' | 'client';\r\n    DisplayMode: 'table' | 'card';\r\n    DataList: FileCase[];\r\n    TotalItems: number;\r\n    CurrentPage: number;\r\n    PageSize: number;\r\n    SearchQuery: string;\r\n}\r\n\r\nconst SelectModal = ref<SelectModal>(GetDefaultSelectModal());\r\n\r\n// 搜尋輸入框的值（與實際搜尋條件分離）\r\nconst searchInput = ref('');\r\n\r\nfunction GetDefaultSelectModal(): SelectModal {\r\n    return {\r\n        ModalInstance: {\r\n            modalId: 'FileCaseSelectModal',\r\n            title: '選擇檔案案件',\r\n            showModal: false,\r\n            size: 'modal-xl',\r\n            staticBackdrop: true,\r\n            animateBackdrop: false,\r\n            scrollable: true\r\n        },\r\n        PaginationType: 'server',\r\n        DisplayMode: 'table',\r\n        DataList: [],\r\n        TotalItems: 0,\r\n        CurrentPage: 1,\r\n        PageSize: 10,\r\n        SearchQuery: ''\r\n    };\r\n}\r\n\r\n// 分頁監聽\r\nwatch(\r\n    () => ({\r\n        currentPage: SelectModal.value.CurrentPage,\r\n        pageSize: SelectModal.value.PageSize\r\n    }),\r\n    () => {\r\n        LoadViewData();\r\n    }\r\n);\r\n\r\n// 移除搜尋監聽器，改用按鈕觸發\r\n\r\n/**\r\n * 展開Modal\r\n */\r\nasync function openModal() {\r\n    SelectModal.value = GetDefaultSelectModal();\r\n    searchInput.value = ''; // 清空搜尋輸入框\r\n    await LoadViewData();\r\n    SelectModal.value.ModalInstance.showModal = true;\r\n}\r\n\r\n/**\r\n * 關閉Modal\r\n */\r\nfunction closeModal() {\r\n    SelectModal.value.ModalInstance.showModal = false;\r\n}\r\n\r\n/**\r\n * 處理點擊背景事件，觸發背景動畫\r\n */\r\nfunction handleBackgroundClick(event: MouseEvent) {\r\n    if (event.target === event.currentTarget) {\r\n        SelectModal.value.ModalInstance.animateBackdrop = true;\r\n        setTimeout(() => {\r\n            SelectModal.value.ModalInstance.animateBackdrop = false;\r\n        }, 150);\r\n    }\r\n}\r\n\r\n/**\r\n * 載入檔案案件資料\r\n */\r\nconst LoadViewData = async () => {\r\n    try {\r\n        // 呼叫後端分頁 API，包含搜尋參數\r\n        const response = await API.FileCaseManagementViewData({\r\n            pageNumber: SelectModal.value.CurrentPage,\r\n            pageSize: SelectModal.value.PageSize,\r\n            searchQuery: SelectModal.value.SearchQuery\r\n        });\r\n\r\n        if (response && response.status) {\r\n            SelectModal.value.DataList = response.result.items;\r\n            SelectModal.value.TotalItems = response.result.totalItems ?? 0;\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching FileCase data:', error);\r\n    }\r\n};\r\n\r\n// 節流處理LoadViewData，避免按鈕被連續點擊\r\nconst throttledLoadViewData = Common.Throttle(LoadViewData, 300);\r\n\r\n/**\r\n * 選擇檔案案件\r\n */\r\nfunction selectFileCase(item: FileCase) {\r\n    emit('select', item.caseNo);\r\n    closeModal();\r\n}\r\n\r\n/**\r\n * 格式化權限顯示文字\r\n */\r\nfunction getPermissionText(permission: number): string {\r\n    const permissionMap: { [key: string]: string } = {\r\n        0: '不限制任何系統 (Public)',\r\n        1: '限制註冊系統 (Protect)',\r\n        2: '限制白名單系統 (ProtectInternal)',\r\n        3: '自己才可存取 (Private)'\r\n    };\r\n    return permissionMap[permission] || '未知';\r\n}\r\n\r\n/**\r\n * 格式化日期\r\n */\r\nfunction formatDate(dateString: string): string {\r\n    if (!dateString) return '';\r\n    try {\r\n        const date = new Date(dateString);\r\n        return date.toLocaleDateString('zh-TW', {\r\n            year: 'numeric',\r\n            month: '2-digit',\r\n            day: '2-digit'\r\n        });\r\n    } catch {\r\n        return dateString;\r\n    }\r\n}\r\n\r\n/**\r\n * 處理搜尋按鈕點擊\r\n */\r\nfunction handleSearch() {\r\n    // 更新搜尋條件並重置到第一頁\r\n    SelectModal.value.SearchQuery = searchInput.value;\r\n    SelectModal.value.CurrentPage = 1;\r\n    throttledLoadViewData();\r\n}\r\n\r\n/**\r\n * 清除搜尋\r\n */\r\nfunction clearSearch() {\r\n    searchInput.value = '';\r\n    SelectModal.value.SearchQuery = '';\r\n    SelectModal.value.CurrentPage = 1;\r\n    throttledLoadViewData();\r\n}\r\n\r\n// 定義事件發射器\r\nconst emit = defineEmits<{\r\n    select: [caseNo: string];\r\n}>();\r\n\r\n// 將方法暴露給父元件使用\r\ndefineExpose({ openModal });\r\n</script>\r\n\r\n<style scoped>\r\n.modal {\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n.modal-dialog {\r\n    background-color: transparent;\r\n}\r\n\r\n.static-backdrop-animation {\r\n    animation: staticBackdropAnimation 0.15s ease-in-out;\r\n}\r\n\r\n.modal-dialog-scrollable .modal-body {\r\n    max-height: calc(100vh - 200px);\r\n    overflow-y: auto;\r\n}\r\n\r\n@keyframes staticBackdropAnimation {\r\n    0% {\r\n        transform: scale(1);\r\n    }\r\n    50% {\r\n        transform: scale(1.02);\r\n    }\r\n    100% {\r\n        transform: scale(1);\r\n    }\r\n}\r\n</style>\r\n","<template>\r\n    <div\r\n        v-if=\"SelectModal.ModalInstance.showModal\"\r\n        class=\"modal show d-block\"\r\n        tabindex=\"-1\"\r\n        :aria-labelledby=\"SelectModal.ModalInstance.modalId\"\r\n        :aria-hidden=\"!SelectModal.ModalInstance.showModal\"\r\n        @click=\"handleBackgroundClick\"\r\n        :class=\"{ 'static-backdrop-animation': SelectModal.ModalInstance.animateBackdrop }\"\r\n    >\r\n        <div\r\n            class=\"modal-dialog\"\r\n            :class=\"[\r\n                SelectModal.ModalInstance.size,\r\n                SelectModal.ModalInstance.scrollable ? 'modal-dialog-scrollable' : ''\r\n            ]\"\r\n        >\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">{{ SelectModal.ModalInstance.title }}</h5>\r\n                    <button type=\"button\" class=\"btn-close\" @click=\"closeModal\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <!-- 搜尋輸入框 -->\r\n                    <div class=\"mb-3\">\r\n                        <div class=\"input-group\">\r\n                            <span class=\"input-group-text\">\r\n                                <i class=\"bi bi-search\"></i>\r\n                            </span>\r\n                            <input\r\n                                type=\"text\"\r\n                                class=\"form-control\"\r\n                                placeholder=\"搜尋文件類型名稱...\"\r\n                                v-model=\"searchInput\"\r\n                                @keyup.enter=\"handleSearch\"\r\n                            />\r\n                            <button class=\"btn btn-esun-primary\" type=\"button\" @click=\"handleSearch\">搜尋</button>\r\n                            <button\r\n                                class=\"btn btn-esun-outline\"\r\n                                type=\"button\"\r\n                                @click=\"clearSearch\"\r\n                                v-if=\"SelectModal.SearchQuery\"\r\n                            >\r\n                                清除\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"btn-group me-2 mb-3\" role=\"group\" aria-label=\"First group\">\r\n                        <button\r\n                            type=\"button\"\r\n                            class=\"btn btn-esun-outline\"\r\n                            :class=\"{ active: SelectModal.DisplayMode === 'card' }\"\r\n                            @click=\"SelectModal.DisplayMode = 'card'\"\r\n                        >\r\n                            卡片顯示\r\n                        </button>\r\n                        <button\r\n                            type=\"button\"\r\n                            class=\"btn btn-esun-outline\"\r\n                            :class=\"{ active: SelectModal.DisplayMode === 'table' }\"\r\n                            @click=\"SelectModal.DisplayMode = 'table'\"\r\n                        >\r\n                            表格顯示\r\n                        </button>\r\n                    </div>\r\n                    <div v-if=\"SelectModal.DataList.length === 0\" class=\"text-muted\">無文件類型資料</div>\r\n\r\n                    <div\r\n                        v-if=\"SelectModal.DisplayMode === 'card'\"\r\n                        class=\"d-flex flex-wrap w-100\"\r\n                        style=\"min-height: 400px\"\r\n                    >\r\n                        <div\r\n                            v-for=\"(item, index) in SelectModal.DataList\"\r\n                            :key=\"index\"\r\n                            class=\"p-2\"\r\n                            style=\"flex: 1 1 0; min-width: 33.33%; max-width: 33.33%; width: 33.33%\"\r\n                        >\r\n                            <div class=\"card\">\r\n                                <div\r\n                                    class=\"card-body p-2 d-flex flex-column justify-content-between\"\r\n                                    style=\"height: 140px\"\r\n                                >\r\n                                    <div class=\"mb-2\">\r\n                                        <div class=\"text-truncate fw-bold\" :title=\"item.docName\" style=\"width: 100%\">\r\n                                            {{ item.docName }}\r\n                                        </div>\r\n                                        <div class=\"text-muted small\">編號: {{ item.docType }}</div>\r\n                                        <div class=\"text-muted small\">\r\n                                            權限: {{ getPermissionText(item.permission) }}\r\n                                        </div>\r\n                                        <div class=\"text-muted small\">描述: {{ item.description || '-' }}</div>\r\n                                    </div>\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        class=\"btn btn-sm btn-esun-primary align-self-end\"\r\n                                        @click=\"selectDocType(item)\"\r\n                                    >\r\n                                        選擇\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div v-if=\"SelectModal.DisplayMode === 'table'\" style=\"min-height: 400px\">\r\n                        <table class=\"table table-bordered table-hover\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>文件類型編號</th>\r\n                                    <th>文件類型名稱</th>\r\n                                    <th>權限</th>\r\n                                    <th>描述</th>\r\n                                    <th>操作</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"(item, index) in SelectModal.DataList\" :key=\"index\">\r\n                                    <td>{{ item.docType }}</td>\r\n                                    <td>{{ item.docName }}</td>\r\n                                    <td>{{ getPermissionText(item.permission) }}</td>\r\n                                    <td>{{ item.description || '-' }}</td>\r\n                                    <td>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            class=\"btn btn-sm btn-esun-primary\"\r\n                                            @click=\"selectDocType(item)\"\r\n                                        >\r\n                                            選擇\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <Pagination\r\n                        v-if=\"SelectModal.DataList.length > 0\"\r\n                        v-model:modelValue=\"SelectModal.CurrentPage\"\r\n                        v-model:pageSize=\"SelectModal.PageSize\"\r\n                        :total-items=\"SelectModal.TotalItems\"\r\n                    />\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button class=\"btn btn-esun-outline\" @click.prevent=\"closeModal\">取消</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, watch } from 'vue';\r\nimport type { MyBaseModal } from '@/components/modal/BaseModal/schema';\r\nimport Pagination from '@/components/pagination/Pagination.vue';\r\nimport * as ApiClient from '@/libs/ApiClient';\r\nimport API from '@/api/v1/';\r\nimport type { DocTypeDTO } from '@/models/DTO/DocType';\r\nimport * as Common from '@/libs/Common';\r\n\r\nexport interface SelectModal {\r\n    ModalInstance: MyBaseModal;\r\n    PaginationType: 'server' | 'client';\r\n    DisplayMode: 'table' | 'card';\r\n    DataList: DocTypeDTO[];\r\n    TotalItems: number;\r\n    CurrentPage: number;\r\n    PageSize: number;\r\n    SearchQuery: string;\r\n}\r\n\r\nconst SelectModal = ref<SelectModal>(GetDefaultSelectModal());\r\n\r\n// 搜尋輸入框的值（與實際搜尋條件分離）\r\nconst searchInput = ref('');\r\n\r\nfunction GetDefaultSelectModal(): SelectModal {\r\n    return {\r\n        ModalInstance: {\r\n            modalId: 'DocTypeSelectModal',\r\n            title: '選擇文件類型',\r\n            showModal: false,\r\n            size: 'modal-xl',\r\n            staticBackdrop: true,\r\n            animateBackdrop: false,\r\n            scrollable: true\r\n        },\r\n        PaginationType: 'server',\r\n        DisplayMode: 'table',\r\n        DataList: [],\r\n        TotalItems: 0,\r\n        CurrentPage: 1,\r\n        PageSize: 10,\r\n        SearchQuery: ''\r\n    };\r\n}\r\n\r\n// 分頁監聽\r\nwatch(\r\n    () => ({\r\n        currentPage: SelectModal.value.CurrentPage,\r\n        pageSize: SelectModal.value.PageSize\r\n    }),\r\n    () => {\r\n        LoadViewData();\r\n    }\r\n);\r\n\r\n/**\r\n * 展開Modal\r\n */\r\nasync function openModal() {\r\n    SelectModal.value = GetDefaultSelectModal();\r\n    searchInput.value = ''; // 清空搜尋輸入框\r\n    await LoadViewData();\r\n    SelectModal.value.ModalInstance.showModal = true;\r\n}\r\n\r\n/**\r\n * 關閉Modal\r\n */\r\nfunction closeModal() {\r\n    SelectModal.value.ModalInstance.showModal = false;\r\n}\r\n\r\n/**\r\n * 處理點擊背景事件，觸發背景動畫\r\n */\r\nfunction handleBackgroundClick(event: MouseEvent) {\r\n    if (event.target === event.currentTarget) {\r\n        SelectModal.value.ModalInstance.animateBackdrop = true;\r\n        setTimeout(() => {\r\n            SelectModal.value.ModalInstance.animateBackdrop = false;\r\n        }, 150);\r\n    }\r\n}\r\n\r\n/**\r\n * 載入文件類型資料\r\n */\r\nconst LoadViewData = async () => {\r\n    try {\r\n        // 呼叫後端分頁 API，包含搜尋參數\r\n        const response = await API.DocTypeManagementViewData(\r\n            SelectModal.value.CurrentPage,\r\n            SelectModal.value.PageSize,\r\n            SelectModal.value.SearchQuery\r\n        );\r\n\r\n        if (response && response.status) {\r\n            SelectModal.value.DataList = response.result.items;\r\n            SelectModal.value.TotalItems = response.result.totalCount ?? 0;\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching DocType data:', error);\r\n    }\r\n};\r\n\r\n// 節流處理LoadViewData，避免按鈕被連續點擊\r\nconst throttledLoadViewData = Common.Throttle(LoadViewData, 300);\r\n\r\n/**\r\n * 選擇文件類型\r\n */\r\nfunction selectDocType(item: DocTypeDTO) {\r\n    emit('select', item.docType, item.docName);\r\n    closeModal();\r\n}\r\n\r\n/**\r\n * 格式化權限顯示文字\r\n */\r\nfunction getPermissionText(permission: string): string {\r\n    const permissionMap: { [key: string]: string } = {\r\n        '0': '不限制任何系統 (Public)',\r\n        '1': '限制註冊系統 (Protect)',\r\n        '2': '限制白名單系統 (ProtectInternal)',\r\n        '3': '自己才可存取 (Private)'\r\n    };\r\n    return permissionMap[permission] || '未知';\r\n}\r\n\r\n/**\r\n * 處理搜尋按鈕點擊\r\n */\r\nfunction handleSearch() {\r\n    // 更新搜尋條件並重置到第一頁\r\n    SelectModal.value.SearchQuery = searchInput.value;\r\n    SelectModal.value.CurrentPage = 1;\r\n    throttledLoadViewData();\r\n}\r\n\r\n/**\r\n * 清除搜尋\r\n */\r\nfunction clearSearch() {\r\n    searchInput.value = '';\r\n    SelectModal.value.SearchQuery = '';\r\n    SelectModal.value.CurrentPage = 1;\r\n    throttledLoadViewData();\r\n}\r\n\r\n// 定義事件發射器\r\nconst emit = defineEmits<{\r\n    select: [docType: number, docName: string];\r\n}>();\r\n\r\n// 將方法暴露給父元件使用\r\ndefineExpose({ openModal });\r\n</script>\r\n\r\n<style scoped>\r\n.modal {\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n.modal-dialog {\r\n    background-color: transparent;\r\n}\r\n\r\n.static-backdrop-animation {\r\n    animation: staticBackdropAnimation 0.15s ease-in-out;\r\n}\r\n\r\n.modal-dialog-scrollable .modal-body {\r\n    max-height: calc(100vh - 200px);\r\n    overflow-y: auto;\r\n}\r\n\r\n@keyframes staticBackdropAnimation {\r\n    0% {\r\n        transform: scale(1);\r\n    }\r\n    50% {\r\n        transform: scale(1.02);\r\n    }\r\n    100% {\r\n        transform: scale(1);\r\n    }\r\n}\r\n</style>\r\n","<template>\r\n    <div\r\n        v-if=\"showModal\"\r\n        class=\"modal show d-block\"\r\n        tabindex=\"-1\"\r\n        aria-hidden=\"false\"\r\n        @click=\"handleBackgroundClick\"\r\n        :class=\"{ 'static-backdrop-animation': animateBackdrop }\"\r\n    >\r\n        <div class=\"modal-dialog modal-xl modal-dialog-centered\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">圖片預覽 - {{ fileName }}</h5>\r\n                    <button type=\"button\" class=\"btn-close\" @click=\"closeModal\"></button>\r\n                </div>\r\n                <div class=\"modal-body text-center\" style=\"max-height: 70vh; overflow: auto\">\r\n                    <div v-if=\"loading\" class=\"d-flex justify-content-center align-items-center\" style=\"height: 300px\">\r\n                        <div class=\"spinner-border text-primary\" role=\"status\">\r\n                            <span class=\"visually-hidden\">載入中...</span>\r\n                        </div>\r\n                    </div>\r\n                    <div v-else-if=\"error\" class=\"alert alert-danger\">\r\n                        {{ error }}\r\n                    </div>\r\n                    <div v-else-if=\"imageData\">\r\n                        <img\r\n                            :src=\"imageData\"\r\n                            :alt=\"fileName\"\r\n                            class=\"img-fluid\"\r\n                            style=\"max-width: 100%; max-height: 60vh; object-fit: contain\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-esun-primary\" @click=\"downloadImage\" :disabled=\"!imageData\">\r\n                        <i class=\"bi bi-download me-1\"></i>下載圖片\r\n                    </button>\r\n                    <button type=\"button\" class=\"btn btn-esun-outline\" @click=\"closeModal\">關閉</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref } from 'vue';\r\nimport API from '@/api/v1/';\r\nimport type { FileInfos } from '@/models/DTO/FileInfos';\r\n\r\nconst showModal = ref(false);\r\nconst animateBackdrop = ref(false);\r\nconst loading = ref(false);\r\nconst error = ref('');\r\nconst imageData = ref('');\r\nconst fileName = ref('');\r\nconst currentFileInfo = ref<FileInfos | null>(null);\r\n\r\n/**\r\n * 打開圖片預覽模態框\r\n */\r\nasync function openModal(fileInfo: FileInfos) {\r\n    currentFileInfo.value = fileInfo;\r\n    fileName.value = fileInfo.fileName;\r\n    showModal.value = true;\r\n    loading.value = true;\r\n    error.value = '';\r\n    imageData.value = '';\r\n\r\n    try {\r\n        // 獲取圖片 blob 數據\r\n        const blob = await API.GetFileContent({ business: fileInfo.business, fileNo: fileInfo.fileNo });\r\n\r\n        // 創建 blob URL\r\n        const imageUrl = URL.createObjectURL(blob);\r\n        imageData.value = imageUrl;\r\n    } catch (err: any) {\r\n        console.error('獲取圖片失敗:', err);\r\n        error.value = '無法載入圖片，請稍後再試。';\r\n    } finally {\r\n        loading.value = false;\r\n    }\r\n}\r\n\r\n/**\r\n * 關閉模態框\r\n */\r\nfunction closeModal() {\r\n    showModal.value = false;\r\n\r\n    // 清理 blob URL 避免記憶體洩漏\r\n    if (imageData.value) {\r\n        URL.revokeObjectURL(imageData.value);\r\n        imageData.value = '';\r\n    }\r\n\r\n    currentFileInfo.value = null;\r\n    fileName.value = '';\r\n    error.value = '';\r\n}\r\n\r\n/**\r\n * 下載圖片\r\n */\r\nasync function downloadImage() {\r\n    if (!currentFileInfo.value || !imageData.value) return;\r\n\r\n    try {\r\n        // 重新獲取 blob 以確保數據正確\r\n        const blob = await API.GetFileContent({\r\n            business: currentFileInfo.value.business,\r\n            fileNo: currentFileInfo.value.fileNo\r\n        });\r\n\r\n        // 創建下載連結\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = currentFileInfo.value.fileName;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n\r\n        // 清理 URL\r\n        URL.revokeObjectURL(url);\r\n    } catch (err: any) {\r\n        console.error('下載圖片失敗:', err);\r\n        // 可以顯示錯誤提示\r\n    }\r\n}\r\n\r\n/**\r\n * 處理點擊背景事件\r\n */\r\nfunction handleBackgroundClick(event: MouseEvent) {\r\n    if (event.target === event.currentTarget) {\r\n        animateBackdrop.value = true;\r\n        setTimeout(() => {\r\n            animateBackdrop.value = false;\r\n        }, 150);\r\n    }\r\n}\r\n\r\n// 將方法暴露給父元件使用\r\ndefineExpose({ openModal });\r\n</script>\r\n\r\n<style scoped>\r\n.modal {\r\n    background-color: rgba(0, 0, 0, 0.8);\r\n}\r\n\r\n.modal-dialog {\r\n    background-color: transparent;\r\n}\r\n\r\n.static-backdrop-animation {\r\n    animation: staticBackdropAnimation 0.15s ease-in-out;\r\n}\r\n\r\n@keyframes staticBackdropAnimation {\r\n    0% {\r\n        transform: scale(1);\r\n    }\r\n    50% {\r\n        transform: scale(1.02);\r\n    }\r\n    100% {\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n/* 確保圖片在各種螢幕尺寸下都能正確顯示 */\r\n.modal-body img {\r\n    border-radius: 4px;\r\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n}\r\n</style>\r\n","import * as Common from '@/libs/Common';\r\nimport { SimplePopUp, SimplePopUpBtnType, SimplePopUpModalType } from '@/libs/SimplePopUp';\r\nconst simplePopUp = new SimplePopUp();\r\n/**\r\n * @todo 縮圖 + 自定輸出格式\r\n * @param base64Src 原圖 base64\r\n * @param maxWidth 最大寬度\r\n * @param maxHeight 最大高度\r\n * @param imgQuality 壓縮品質 (0 ~ 1)\r\n * @param imageMaxSizeMb 限制最大大小 (MB)\r\n * @param mimeType 輸出格式，預設 'image/jpeg'\r\n * @returns\r\n */\r\nexport async function ResizeImageToBase64(\r\n    srcType: 'blob' | 'base64',\r\n    blob: Blob,\r\n    base64Src: string | null,\r\n    maxWidth: number = 2048,\r\n    maxHeight: number = 2048,\r\n    imgQuality: number = 0.8,\r\n    imageMaxSizeMb: number = 8,\r\n    mimeType: string = 'image/jpeg',\r\n    isShowPopUp: boolean = true\r\n): Promise<string | null> {\r\n    try {\r\n        if (srcType === 'blob') {\r\n            const base64 = await FileToBase64(blob);\r\n            base64Src = base64;\r\n        }\r\n        if (!base64Src) {\r\n            throw new Error('Base64 source is null.');\r\n        }\r\n        const img = await Common.Base64ToImage(base64Src);\r\n        const canvas = document.createElement('canvas');\r\n        // Resize width & height\r\n        if (img.width > img.height && img.width > maxWidth) {\r\n            img.height *= maxWidth / img.width;\r\n            img.width = maxWidth;\r\n        } else if (img.height > maxHeight) {\r\n            img.width *= maxHeight / img.height;\r\n            img.height = maxHeight;\r\n        }\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n        // draw\r\n        const context = canvas.getContext('2d');\r\n        if (!context) {\r\n            throw new Error('Cannot get canvas 2D context.');\r\n        }\r\n        context.clearRect(0, 0, img.width, img.height);\r\n        context.drawImage(img, 0, 0, img.width, img.height);\r\n        const src = canvas.toDataURL(mimeType, imgQuality);\r\n        // const blob = await new Promise(resolve => canvas.toBlob(resolve,'image/jpeg', this.ImgQuality));\r\n\r\n        // 8MB Check\r\n        const fileSizeInBytes = getBase64Size(src);\r\n        const maxSize = imageMaxSizeMb * 1024 * 1024;\r\n        if (fileSizeInBytes > maxSize) {\r\n            if (isShowPopUp) {\r\n                simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', `很抱歉您上傳的照片大小超過${imageMaxSizeMb}MB請重新上傳，敬請見諒。`, [\r\n                    {\r\n                        id: 'confirm',\r\n                        type: SimplePopUpBtnType.callback,\r\n                        btnClass: 'btn-info',\r\n                        resolveParam: 'confirm',\r\n                        title: '確認'\r\n                    }\r\n                ]);\r\n            }\r\n            return null;\r\n        }\r\n        return src;\r\n    } catch (error) {\r\n        Common.ConsoleLog(error instanceof Error ? error.message : error);\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * @todo 縮圖 + 自定輸出格式\r\n * @param blob\r\n * @param maxWidth\r\n * @param maxHeight\r\n * @param imgQuality\r\n * @param imageMaxSizeMb\r\n * @param mimeType\r\n * @param isShowPopUp\r\n * @returns\r\n */\r\nexport async function ResizeImageBlobToBase64(\r\n    blob: Blob,\r\n    maxWidth: number = 2048,\r\n    maxHeight: number = 2048,\r\n    imgQuality: number = 0.8,\r\n    imageMaxSizeMb: number = 8,\r\n    mimeType: string = 'image/jpeg',\r\n    isShowPopUp: boolean = true\r\n): Promise<string | null> {\r\n    return ResizeImageToBase64('blob', blob, null, maxWidth, maxHeight, imgQuality, imageMaxSizeMb, mimeType, isShowPopUp);\r\n}\r\n\r\n/**\r\n * 縮圖 + 自定輸出格式，回傳 File 物件\r\n * @param base64Src 原圖 base64\r\n * @param fileName 檔案名稱\r\n * @param maxWidth 最大寬度\r\n * @param maxHeight 最大高度\r\n * @param imgQuality 壓縮品質\r\n * @param imageMaxSizeMb 最大大小(MB)\r\n * @param isShowPopUp 是否跳警告\r\n * @returns File 或 null\r\n */\r\nexport async function ResizeImageToFile(\r\n    srcType: 'blob' | 'base64',\r\n    fileInput: File,\r\n    base64Src: string | null,\r\n    fileName: string,\r\n    maxWidth: number = 2048,\r\n    maxHeight: number = 2048,\r\n    imgQuality: number = 0.8,\r\n    imageMaxSizeMb: number = 8,\r\n    isShowPopUp: boolean = true\r\n): Promise<File | null> {\r\n    try {\r\n        let localBase64Src = base64Src;\r\n        if (srcType === 'blob') {\r\n            const base64 = await FileToBase64(fileInput);\r\n            localBase64Src = base64;\r\n        }\r\n        if (!localBase64Src) {\r\n            throw new Error('Base64 source is null.');\r\n        }\r\n\r\n        const img = await Base64ToImage(localBase64Src);\r\n        const canvas = document.createElement('canvas');\r\n\r\n        // Resize width & height\r\n        if (img.width > img.height && img.width > maxWidth) {\r\n            img.height *= maxWidth / img.width;\r\n            img.width = maxWidth;\r\n        } else if (img.height > maxHeight) {\r\n            img.width *= maxHeight / img.height;\r\n            img.height = maxHeight;\r\n        }\r\n\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        const context = canvas.getContext('2d');\r\n        if (!context) {\r\n            throw new Error('Cannot get canvas 2D context.');\r\n        }\r\n\r\n        context.clearRect(0, 0, img.width, img.height);\r\n        context.drawImage(img, 0, 0, img.width, img.height);\r\n\r\n        const blob = await new Promise<Blob | null>((resolve) => {\r\n            canvas.toBlob((b) => resolve(b), fileInput.type, imgQuality);\r\n        });\r\n\r\n        if (!blob) {\r\n            throw new Error('Failed to create blob.');\r\n        }\r\n\r\n        // 檢查大小\r\n        const fileSizeInBytes = blob.size;\r\n        const maxSize = imageMaxSizeMb * 1024 * 1024;\r\n        if (fileSizeInBytes > maxSize) {\r\n            if (isShowPopUp) {\r\n                const simplePopUp = new SimplePopUp();\r\n                simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', `很抱歉您上傳的照片大小超過${imageMaxSizeMb}MB請重新上傳，敬請見諒。`, [\r\n                    {\r\n                        id: 'confirm',\r\n                        type: SimplePopUpBtnType.callback,\r\n                        btnClass: 'btn-info',\r\n                        resolveParam: 'confirm',\r\n                        title: '確認'\r\n                    }\r\n                ]);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // 把 Blob 轉成 File\r\n        const file = new File([blob], fileName, { type: fileInput.type });\r\n        return file;\r\n    } catch (error) {\r\n        Common.ConsoleLog(error instanceof Error ? error.message : error);\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * 縮圖 + 自定輸出格式，回傳 Blob\r\n */\r\nexport async function ResizeBase64ToBlob(\r\n    base64Src: string,\r\n    maxWidth: number = 2048,\r\n    maxHeight: number = 2048,\r\n    imgQuality: number = 0.8,\r\n    imageMaxSizeMb: number = 8,\r\n    mimeType: string = 'image/jpeg',\r\n    isShowPopUp: boolean = true\r\n): Promise<Blob | null> {\r\n    try {\r\n        const img = await Common.Base64ToImage(base64Src);\r\n        const canvas = document.createElement('canvas');\r\n\r\n        // Resize width & height\r\n        if (img.width > img.height && img.width > maxWidth) {\r\n            img.height *= maxWidth / img.width;\r\n            img.width = maxWidth;\r\n        } else if (img.height > maxHeight) {\r\n            img.width *= maxHeight / img.height;\r\n            img.height = maxHeight;\r\n        }\r\n\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        const context = canvas.getContext('2d');\r\n        if (!context) {\r\n            throw new Error('Cannot get canvas 2D context.');\r\n        }\r\n\r\n        context.clearRect(0, 0, img.width, img.height);\r\n        context.drawImage(img, 0, 0, img.width, img.height);\r\n\r\n        // 轉成 Blob\r\n        const blob = await new Promise<Blob | null>((resolve) => {\r\n            canvas.toBlob((b) => resolve(b), mimeType, imgQuality);\r\n        });\r\n\r\n        if (!blob) {\r\n            throw new Error('Failed to create blob.');\r\n        }\r\n\r\n        // Check size\r\n        const fileSizeInBytes = blob.size;\r\n        const maxSize = imageMaxSizeMb * 1024 * 1024;\r\n        if (fileSizeInBytes > maxSize) {\r\n            if (isShowPopUp) {\r\n                simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', `很抱歉您上傳的照片大小超過${imageMaxSizeMb}MB請重新上傳，敬請見諒。`, [\r\n                    {\r\n                        id: 'confirm',\r\n                        type: SimplePopUpBtnType.callback,\r\n                        btnClass: 'btn-info',\r\n                        resolveParam: 'confirm',\r\n                        title: '確認'\r\n                    }\r\n                ]);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        return blob;\r\n    } catch (error) {\r\n        Common.ConsoleLog(error);\r\n        if (error instanceof Error) {\r\n            Common.ConsoleLog(error.message);\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * @todo 取得base64 without base64Marker\r\n * @param data\r\n * @returns\r\n */\r\nexport const GetBase64Content = (data: string) => {\r\n    const base64Marker = ';base64,';\r\n    if (data.includes(base64Marker)) {\r\n        let base64Index = data.indexOf(base64Marker) + base64Marker.length;\r\n        return data.substring(base64Index);\r\n    }\r\n    return data;\r\n};\r\n\r\n/**\r\n * 計算 base64 字串的大小\r\n * @param base64String 原圖 base64\r\n * @returns 大小 (bytes)\r\n */\r\nexport function getBase64Size(base64String: string): number {\r\n    // 如果有 \"data:image/...\" 前綴，去掉\r\n    let base64Data = base64String;\r\n    const commaIndex = base64String.indexOf(',');\r\n    if (commaIndex !== -1) {\r\n        base64Data = base64String.substring(commaIndex + 1);\r\n    }\r\n\r\n    const padding = (base64Data.match(/=+$/) || [''])[0].length;\r\n    return (base64Data.length * 3) / 4 - padding;\r\n}\r\n\r\n/**\r\n * 將檔案轉換為 base64\r\n * @param file 檔案\r\n * @returns base64\r\n */\r\nexport const FileToBase64 = (file: Blob): Promise<string | any> => {\r\n    return new Promise((resolve, reject) => {\r\n        const reader = new FileReader();\r\n        reader.readAsDataURL(file);\r\n        reader.onload = (e: ProgressEvent<FileReader>) => {\r\n            resolve(e.target?.result);\r\n        };\r\n        reader.onerror = (error) => {\r\n            reject(error);\r\n        };\r\n    });\r\n};\r\n\r\n/**\r\n * 將 base64 轉換為圖片\r\n * @param base64String base64\r\n * @returns 圖片\r\n */\r\nexport const Base64ToImage = (base64String: string): Promise<HTMLImageElement> => {\r\n    return new Promise((resolve, reject) => {\r\n        const img = window.document.createElement('img');\r\n        img.onload = () => resolve(img);\r\n        img.onerror = (error) => reject(new Error('Failed to load image from base64.' + error.toString()));\r\n        img.src = base64String;\r\n    });\r\n};\r\n","<style scoped>\r\n.content {\r\n    margin-left: 250px;\r\n    transition: margin-left 0.3s;\r\n}\r\n.content.expanded {\r\n    margin-left: 0;\r\n}\r\n\r\n.fade-in {\r\n    opacity: 0;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.fade-in.active {\r\n    opacity: 1;\r\n}\r\n</style>\r\n\r\n<template>\r\n    <div class=\"p-4 mt-5\">\r\n        <!-- top button  -->\r\n        <div\r\n            class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\"\r\n        >\r\n            <h1 class=\"h2\">{{ RouteUrlList.FileInfosManagement.label }}</h1>\r\n            <div class=\"btn-toolbar justify-content-end mb-3\" role=\"toolbar\" aria-label=\"Toolbar with button groups\">\r\n                <div class=\"btn-group me-2\" role=\"group\" aria-label=\"First group\">\r\n                    <!-- 新增搜尋輸入框 -->\r\n                    <div class=\"input-group ms-3\" style=\"max-width: 300px\">\r\n                        <span class=\"input-group-text\">\r\n                            <i class=\"bi bi-search\"></i>\r\n                        </span>\r\n                        <input\r\n                            type=\"text\"\r\n                            class=\"form-control\"\r\n                            placeholder=\"搜尋檔案名稱、序號...\"\r\n                            v-model=\"FileInfosData.searchQuery\"\r\n                            @keyup.enter=\"handleSearch\"\r\n                        />\r\n                        <button class=\"btn btn-esun-primary\" type=\"button\" @click=\"throttledHandleSearch\">搜尋</button>\r\n                        <button class=\"btn btn-esun-outline\" type=\"button\" @click=\"clearSearch\">清除</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"btn-group me-2\">\r\n                    <button class=\"btn btn-esun-primary ml-3\" @click=\"openCreateModal\">新增檔案資訊</button>\r\n                </div>\r\n\r\n                <!-- 新增檔案資訊Modal -->\r\n                <JsonFormModal\r\n                    v-if=\"createModal.showModal\"\r\n                    ref=\"createModalRef\"\r\n                    :myModal=\"createModal\"\r\n                    :modelValue=\"createFileData\"\r\n                    @submit=\"handleCreateSubmit\"\r\n                    @cancel=\"createModal.showModal = false\"\r\n                />\r\n\r\n                <!-- 更新Modal -->\r\n                <JsonFormModal\r\n                    v-if=\"updateModal.showModal\"\r\n                    ref=\"updateModalRef\"\r\n                    :myModal=\"updateModal\"\r\n                    v-model=\"updateFileData\"\r\n                    @submit=\"handleEditSubmit\"\r\n                    @cancel=\"updateModal.showModal = false\"\r\n                />\r\n\r\n                <BusinessSelectModal ref=\"businessSelectModal\" @select=\"handleBusinessSelect\" />\r\n                <FileCaseSelectModal ref=\"fileCaseSelectModal\" @select=\"handleFileCaseSelect\" />\r\n                <DocTypeSelectModal ref=\"docTypeSelectModal\" @select=\"handleDocTypeSelect\" />\r\n                <ImagePreviewModal ref=\"imagePreviewModal\" />\r\n\r\n                <!-- 切換顯示模式 -->\r\n                <div class=\"btn-group\" role=\"group\">\r\n                    <button\r\n                        class=\"btn btn-esun-outline\"\r\n                        :class=\"{ active: FileInfosData.displayMode === 'card' }\"\r\n                        @click=\"FileInfosData.displayMode = 'card'\"\r\n                    >\r\n                        卡片模式\r\n                    </button>\r\n                    <button\r\n                        class=\"btn btn-esun-outline\"\r\n                        :class=\"{ active: FileInfosData.displayMode === 'table' }\"\r\n                        @click=\"FileInfosData.displayMode = 'table'\"\r\n                    >\r\n                        表格模式\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 顯示資料 -->\r\n        <Pagination\r\n            v-if=\"FileInfosData.totalItems\"\r\n            v-model:modelValue=\"FileInfosData.currentPage\"\r\n            v-model:pageSize=\"FileInfosData.pageSize\"\r\n            :total-items=\"FileInfosData.totalItems\"\r\n            :go-to-page=\"LoadViewData\"\r\n        />\r\n        <div\r\n            v-if=\"FileInfosData.displayMode === 'card'\"\r\n            class=\"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 active\"\r\n            :class=\"{ 'fade-in': FileInfosData.currentPage }\"\r\n            ref=\"dataContainer\"\r\n        >\r\n            <div class=\"col\" v-for=\"item in FileInfosData.DataList\" :key=\"item.fileNo\">\r\n                <div class=\"card card-esun h-100 esun-animate-in\">\r\n                    <div class=\"card-body\">\r\n                        <h5 class=\"card-title\">{{ item.fileName }}</h5>\r\n                        <p class=\"card-text\">\r\n                            <strong>檔案序號:</strong> {{ item.fileNo }}<br />\r\n                            <strong>案件序號:</strong> {{ item.caseNo }}<br />\r\n                            <strong>文件類型:</strong> {{ item.docType || '-' }}<br />\r\n                            <strong>啟用狀態:</strong>\r\n                            <span :class=\"item.isActive ? 'text-success' : 'text-danger'\">\r\n                                {{ item.isActive ? '啟用中' : '已停用' }} </span\r\n                            ><br />\r\n                            <strong>權限:</strong> {{ item.filePermission }}<br />\r\n                            <strong>檔案路徑:</strong> {{ item.filePath }}<br />\r\n                            <strong>定期刪除:</strong>\r\n                            <span :class=\"item.isUseRetention ? 'text-success' : 'text-danger'\">\r\n                                {{ item.isUseRetention ? '啟用' : '未啟用' }} </span\r\n                            ><br />\r\n                            <strong>刪除時間:</strong> {{ item.deleteTime || '-' }}<br />\r\n                            <strong>上傳/覆蓋時間:</strong> {{ item.uploadDate || '-' }}<br />\r\n                            <strong>描述:</strong> {{ item.description || '-' }}\r\n                        </p>\r\n\r\n                        <!-- 操作選單 -->\r\n                        <div class=\"dropdown mt-3\">\r\n                            <button\r\n                                class=\"btn btn-esun-outline dropdown-toggle w-100\"\r\n                                type=\"button\"\r\n                                data-bs-toggle=\"dropdown\"\r\n                                aria-expanded=\"false\"\r\n                            >\r\n                                <i class=\"bi bi-gear me-1\"></i> 操作選單\r\n                            </button>\r\n                            <ul class=\"dropdown-menu w-100\">\r\n                                <li>\r\n                                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handlePreviewOrDownLoad(item)\">\r\n                                        <i class=\"bi bi-download me-1 text-info\"></i> 預覽或下載\r\n                                    </a>\r\n                                </li>\r\n                                <li>\r\n                                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleEdit(item)\">\r\n                                        <i class=\"bi bi-pencil-square me-1 text-primary\"></i> 編輯\r\n                                    </a>\r\n                                </li>\r\n                                <li>\r\n                                    <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleDelete(item)\">\r\n                                        <i class=\"bi bi-trash me-1 text-danger\"></i> 刪除\r\n                                    </a>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div\r\n            v-else\r\n            :class=\"{ 'fade-in': FileInfosData.currentPage }\"\r\n            ref=\"dataContainer\"\r\n            style=\"overflow: auto\"\r\n            class=\"active\"\r\n        >\r\n            <table class=\"table table-bordered table-hover align-middle\">\r\n                <thead class=\"table-light\">\r\n                    <tr>\r\n                        <th>檔案名稱</th>\r\n                        <th>檔案序號</th>\r\n                        <th>案件序號</th>\r\n                        <th>文件類型</th>\r\n                        <th>啟用狀態</th>\r\n                        <th>權限</th>\r\n                        <th>檔案路徑</th>\r\n                        <th>定期刪除</th>\r\n                        <th>刪除時間</th>\r\n                        <th>上傳/覆蓋時間</th>\r\n                        <th>描述</th>\r\n                        <th>操作</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"item in FileInfosData.DataList\" :key=\"item.fileNo\">\r\n                        <td>{{ item.fileName }}</td>\r\n                        <td>{{ item.fileNo }}</td>\r\n                        <td>{{ item.caseNo }}</td>\r\n                        <td>{{ item.docType || '-' }}</td>\r\n                        <td>\r\n                            <span :class=\"item.isActive ? 'text-success' : 'text-danger'\">\r\n                                {{ item.isActive ? '啟用中' : '已停用' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>{{ item.filePermission }}</td>\r\n                        <td>{{ item.filePath }}</td>\r\n                        <td>\r\n                            <span :class=\"item.isUseRetention ? 'text-success' : 'text-danger'\">\r\n                                {{ item.isUseRetention ? '啟用' : '未啟用' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>{{ item.deleteTime || '-' }}</td>\r\n                        <td>{{ item.uploadDate || '-' }}</td>\r\n                        <td>{{ item.description || '-' }}</td>\r\n                        <td>\r\n                            <!-- 操作選單 -->\r\n                            <div class=\"dropdown\">\r\n                                <button\r\n                                    class=\"btn btn-esun-outline dropdown-toggle btn-sm\"\r\n                                    type=\"button\"\r\n                                    data-bs-toggle=\"dropdown\"\r\n                                    aria-expanded=\"false\"\r\n                                >\r\n                                    <i class=\"bi bi-gear me-1\"></i> 操作\r\n                                </button>\r\n                                <ul class=\"dropdown-menu\">\r\n                                    <li>\r\n                                        <a\r\n                                            class=\"dropdown-item\"\r\n                                            href=\"#\"\r\n                                            @click.prevent=\"handlePreviewOrDownLoad(item)\"\r\n                                        >\r\n                                            <i class=\"bi bi-pencil-square me-1 text-primary\"></i> 預覽或下載\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleEdit(item)\">\r\n                                            <i class=\"bi bi-pencil-square me-1 text-primary\"></i> 編輯\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a class=\"dropdown-item\" href=\"#\" @click.prevent=\"handleDelete(item)\">\r\n                                            <i class=\"bi bi-trash me-1 text-danger\"></i> 刪除\r\n                                        </a>\r\n                                    </li>\r\n                                </ul>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n        <Pagination\r\n            v-if=\"FileInfosData.totalItems\"\r\n            v-model:modelValue=\"FileInfosData.currentPage\"\r\n            v-model:pageSize=\"FileInfosData.pageSize\"\r\n            :total-items=\"FileInfosData.totalItems\"\r\n            :go-to-page=\"LoadViewData\"\r\n        />\r\n    </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, watch, computed, nextTick, reactive } from 'vue';\r\ndefineProps<{ collapsed: boolean; paginationType?: 'client' | 'server' }>();\r\nimport Pagination from '@/components/pagination/Pagination.vue';\r\nimport * as Common from '@/libs/Common';\r\nimport type { FileInfos } from '@/models/DTO/FileInfos';\r\nimport * as ApiClient from '@/libs/ApiClient';\r\nimport API from '@/api/v1/';\r\nimport JsonFormModal from '@/components/modal/JsonFormModal/JsonFormModal.vue';\r\nimport { GetCreateFileInfosModal, GetDefaultFormData, type FileInfosFormData } from './CreateFileInfosModal';\r\nimport {\r\n    GetUpdateFileInfosModal,\r\n    GetDefaultUpdateFormData,\r\n    type UpdateFileInfosFormData\r\n} from './UpdateFileInfosModal';\r\nimport type { BusinessDTO } from '@/models/DTO/BusinessDTO';\r\nimport { getFieldsGridGroupById, type MyModal } from '@/components/modal/JsonFormModal/schema';\r\nimport { RouteUrlList } from '@/libs/RouteList';\r\nimport BusinessSelectModal from './BusinessSelectModal.vue';\r\nimport FileCaseSelectModal from './FileCaseSelectModal.vue';\r\nimport DocTypeSelectModal from './DocTypeSelectModal.vue';\r\nimport ImagePreviewModal from './ImagePreviewModal.vue';\r\nimport {\r\n    SimplePopUp,\r\n    SimplePopUpBtnType,\r\n    SimplePopUpModalType,\r\n    SimplePopUpSize,\r\n    type SimplePopupResolveResult\r\n} from '@/libs/SimplePopUp';\r\n\r\ninterface IFileInfosData {\r\n    DataList: FileInfos[];\r\n    searchQuery: string;\r\n    currentPage: number;\r\n    pageSize: number;\r\n    totalItems: number;\r\n    displayMode: 'card' | 'table';\r\n}\r\nconst FileInfosData = reactive<IFileInfosData>({\r\n    DataList: [],\r\n    searchQuery: '',\r\n    currentPage: 1,\r\n    pageSize: 10,\r\n    totalItems: 0,\r\n    displayMode: 'card'\r\n});\r\n\r\n/**\r\n * @todo 載入資料 - 使用後端分頁\r\n */\r\nconst LoadViewData = async () => {\r\n    try {\r\n        // 使用後端分頁API\r\n        const response = await API.FileInfosManagementViewData({\r\n            pageNumber: FileInfosData.currentPage,\r\n            pageSize: FileInfosData.pageSize,\r\n            searchQuery: FileInfosData.searchQuery\r\n        });\r\n\r\n        if (response.status && response.result?.items) {\r\n            FileInfosData.DataList = response.result.items;\r\n            FileInfosData.totalItems = response.result.totalCount || 0;\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching fileInfos:', error);\r\n        // Handle error (e.g., show an error message)\r\n    }\r\n};\r\n\r\nonMounted(async () => {\r\n    await LoadViewData();\r\n});\r\n\r\nwatch(\r\n    () => ({\r\n        currentPage: FileInfosData.currentPage,\r\n        pageSize: FileInfosData.pageSize\r\n    }),\r\n    () => {\r\n        LoadViewData();\r\n    }\r\n);\r\n\r\n/**\r\n * 處理預覽或下載檔案\r\n * @param item 檔案資訊\r\n */\r\nasync function handlePreviewOrDownLoad(item: FileInfos) {\r\n    try {\r\n        const fileName = item.fileName.toLowerCase();\r\n        const isImage = Common.IsImageFile(fileName);\r\n\r\n        if (isImage) {\r\n            // 圖片檔案：顯示預覽模態框\r\n            imagePreviewModal.value?.openModal(item);\r\n        } else {\r\n            // 其他檔案：直接下載\r\n            await downloadFile(item);\r\n        }\r\n    } catch (error) {\r\n        console.error('處理檔案預覽/下載時發生錯誤:', error);\r\n        simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', '處理檔案時發生錯誤，請稍後再試。');\r\n    }\r\n}\r\n\r\n/**\r\n * 下載檔案\r\n * @param item 檔案資訊\r\n */\r\nasync function downloadFile(item: FileInfos) {\r\n    try {\r\n        // 顯示載入中的提示\r\n        const loadingAlert = simplePopUp.showAlert(SimplePopUpModalType.Info, '下載中', '檔案下載中，請稍候...');\r\n\r\n        // 獲取檔案 blob\r\n        const blob = await API.GetFileContent({ business: item.business, fileNo: item.fileNo });\r\n\r\n        // 創建下載連結\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = item.fileName;\r\n\r\n        // 觸發下載\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n\r\n        // 清理 URL\r\n        URL.revokeObjectURL(url);\r\n\r\n        // 關閉載入提示並顯示成功訊息\r\n        await simplePopUp.showAlert(SimplePopUpModalType.Success, '下載完成', `檔案「${item.fileName}」下載完成！`);\r\n    } catch (error) {\r\n        console.error('下載檔案失敗:', error);\r\n        await simplePopUp.showAlert(\r\n            SimplePopUpModalType.Warning,\r\n            '下載失敗',\r\n            `檔案「${item.fileName}」下載失敗，請稍後再試。`\r\n        );\r\n    }\r\n}\r\n// ------------------------------------------------------------------------------------------- //\r\n\r\n// 建立 FileInfos 相關\r\nconst createFileData = ref<FileInfosFormData>(GetDefaultFormData());\r\nconst businessSelectModal = ref<InstanceType<typeof BusinessSelectModal>>();\r\nconst fileCaseSelectModal = ref<InstanceType<typeof FileCaseSelectModal>>();\r\nconst docTypeSelectModal = ref<InstanceType<typeof DocTypeSelectModal>>();\r\nconst imagePreviewModal = ref<InstanceType<typeof ImagePreviewModal>>();\r\nconst createModal = ref<MyModal>(GetCreateFileInfosModal());\r\nconst createModalRef = ref<InstanceType<typeof JsonFormModal>>();\r\n\r\n// 更新 FileInfos 相關\r\nconst updateFileData = ref<UpdateFileInfosFormData>(GetDefaultUpdateFormData());\r\nconst updateModal = ref<MyModal>(GetUpdateFileInfosModal());\r\nconst updateModalRef = ref<InstanceType<typeof JsonFormModal>>();\r\n\r\n// 初始化 SimplePopUp\r\nconst simplePopUp = new SimplePopUp();\r\n\r\nimport * as ImageHelper from '@/libs/ImageHelper';\r\nimport { create } from 'lodash';\r\nasync function openCreateModal() {\r\n    // 重置表單資料\r\n    createFileData.value = GetDefaultFormData();\r\n\r\n    // 設定文件上傳的 callback 來自動填入檔案名稱\r\n    const fileUploadField = getFieldsGridGroupById(createModal.value, 'fileUpload');\r\n    if (fileUploadField && fileUploadField.type === 'file') {\r\n        fileUploadField.onInputCallback = async (value: File | File[] | null) => {\r\n            // 由於 multiple: false，所以應該是單個檔案\r\n            const file = Array.isArray(value) ? value[0] : value;\r\n            if (file && Common.IsImageFile(file.name)) {\r\n                // 縮圖 + 自定輸出格式  8MB Check\r\n                const src = await ImageHelper.ResizeImageBlobToBase64(file, 4096, 4096, 0.8, 8, 'image/jpeg', true);\r\n                if (!src) {\r\n                    return;\r\n                }\r\n                let fileSrc = (await Common.GetBase64Content(src)) ?? '';\r\n                createFileData.value.fileSrc = fileSrc;\r\n                createFileData.value.fileName = file.name;\r\n            } else if (file && !Common.IsImageFile(file.name)) {\r\n                let fileSrc = (await Common.FileToBase64(file)) ?? '';\r\n                createFileData.value.fileSrc = Common.GetBase64Content(fileSrc);\r\n                createFileData.value.fileName = file.name;\r\n            } else {\r\n                createFileData.value.fileSrc = '';\r\n                createFileData.value.fileName = '';\r\n            }\r\n        };\r\n    }\r\n\r\n    // 設定業務別欄位的點擊事件\r\n    const businessField = getFieldsGridGroupById(createModal.value, 'business');\r\n    if (businessField && businessField.type === 'text') {\r\n        businessField.onClickCallback = () => {\r\n            // 如果欄位被停用，不執行任何操作\r\n            if (businessField.disabled) {\r\n                //\r\n                simplePopUp.showAlert(SimplePopUpModalType.Warning, '提醒', '業務別和檔案案件只能選擇一項');\r\n                return;\r\n            }\r\n            // 打開業務別選擇模態框\r\n            businessSelectModal.value?.openModal();\r\n        };\r\n        businessField.onClearInput = () => {\r\n            // 雙擊清除業務別\r\n            clearFieldAndUpdateState('business', 'create');\r\n        };\r\n    }\r\n\r\n    // 設定文件類別序號欄位的點擊事件\r\n    const caseNoField = getFieldsGridGroupById(createModal.value, 'caseNo');\r\n    // createModal.value.fieldGroups[0].fields.find((f: any) => f.modelId === 'caseNo');\r\n    if (caseNoField && caseNoField.type === 'text') {\r\n        caseNoField.onClickCallback = () => {\r\n            // 如果欄位被停用，不執行任何操作\r\n            if (caseNoField.disabled) {\r\n                simplePopUp.showAlert(SimplePopUpModalType.Warning, '提醒', '業務別和檔案案件只能選擇一項');\r\n                return;\r\n            }\r\n            // 打開案件選擇模態框\r\n            fileCaseSelectModal.value?.openModal();\r\n        };\r\n        caseNoField.onClearInput = () => {\r\n            // 雙擊清除檔案案件\r\n            clearFieldAndUpdateState('caseNo', 'create');\r\n        };\r\n    }\r\n\r\n    // 設定文件類型欄位的點擊事件\r\n    const docTypeField = getFieldsGridGroupById(createModal.value, 'docType');\r\n    if (docTypeField && docTypeField.type === 'text') {\r\n        docTypeField.onClickCallback = () => {\r\n            // 打開文件類型選擇模態框\r\n            docTypeSelectModal.value?.openModal();\r\n        };\r\n    }\r\n\r\n    // 設定定期刪除相關欄位的監聽事件\r\n    const isUseRetentionField = getFieldsGridGroupById(createModal.value, 'isUseRetention');\r\n    if (isUseRetentionField && isUseRetentionField.type === 'radio') {\r\n        isUseRetentionField.onChangeCallback = (value: string | number | boolean) => {\r\n            // 直接使用 DOM 操作來啟用/停用欄位\r\n            const boolValue = value === true || value === 'true' || value === 1 || value === '1';\r\n\r\n            setTimeout(() => {\r\n                const deleteTimeInput = document.querySelector('#deleteTime') as HTMLInputElement;\r\n                const uploadDateInput = document.querySelector('#uploadDate') as HTMLInputElement;\r\n\r\n                if (deleteTimeInput) {\r\n                    deleteTimeInput.disabled = !boolValue;\r\n                }\r\n                if (uploadDateInput) {\r\n                    uploadDateInput.disabled = !boolValue;\r\n                }\r\n            }, 50);\r\n        };\r\n    }\r\n\r\n    createModal.value.showModal = true;\r\n\r\n    // 初始化欄位狀態\r\n    updateFieldDisabledState('create');\r\n    nextTick();\r\n}\r\n\r\n/**\r\n * 處理業務別選擇\r\n */\r\nfunction handleBusinessSelect(business: string) {\r\n    // 檢查哪個模態框正在顯示\r\n    if (createModal.value.showModal) {\r\n        createFileData.value.business = business;\r\n        // 清空檔案案件並禁用\r\n        createFileData.value.caseNo = '';\r\n        updateFieldDisabledState('create');\r\n        // 使用 JsonFormModal 的方法清除錯誤訊息\r\n        createModalRef.value?.clearFieldError('business');\r\n        createModalRef.value?.clearFieldError('caseNo');\r\n    } else if (updateModal.value.showModal) {\r\n        updateFileData.value.business = business;\r\n        // 清空檔案案件並禁用\r\n        updateFileData.value.caseNo = '';\r\n        updateFieldDisabledState('update');\r\n        // 使用 JsonFormModal 的方法清除錯誤訊息\r\n        updateModalRef.value?.clearFieldError('business');\r\n        updateModalRef.value?.clearFieldError('caseNo');\r\n    }\r\n}\r\n\r\n/**\r\n * 處理檔案案件選擇\r\n */\r\nfunction handleFileCaseSelect(caseNo: string) {\r\n    // 檢查哪個模態框正在顯示\r\n    if (createModal.value.showModal) {\r\n        createFileData.value.caseNo = caseNo;\r\n        // 清空業務別並禁用\r\n        createFileData.value.business = '';\r\n        updateFieldDisabledState('create');\r\n        // 使用 JsonFormModal 的方法清除錯誤訊息\r\n        createModalRef.value?.clearFieldError('caseNo');\r\n        createModalRef.value?.clearFieldError('business');\r\n    } else if (updateModal.value.showModal) {\r\n        updateFileData.value.caseNo = caseNo;\r\n        // 清空業務別並禁用\r\n        updateFileData.value.business = '';\r\n        updateFieldDisabledState('update');\r\n        // 使用 JsonFormModal 的方法清除錯誤訊息\r\n        updateModalRef.value?.clearFieldError('caseNo');\r\n        updateModalRef.value?.clearFieldError('business');\r\n    }\r\n}\r\n\r\n/**\r\n * 更新欄位的啟用/停用狀態\r\n */\r\nfunction updateFieldDisabledState(modalType: 'create' | 'update') {\r\n    const modal = modalType === 'create' ? createModal.value : updateModal.value;\r\n    const formData = modalType === 'create' ? createFileData.value : updateFileData.value;\r\n\r\n    // 獲取business和caseNo欄位\r\n    const businessField = document.querySelector('#business') as HTMLInputElement;\r\n    const caseNoField = document.querySelector('#caseNo') as HTMLInputElement;\r\n\r\n    if (businessField && caseNoField) {\r\n        // 如果選擇了business，則禁用caseNo\r\n        if (formData.business) {\r\n            caseNoField.disabled = true;\r\n            businessField.disabled = false;\r\n        }\r\n        // 如果選擇了caseNo，則禁用business\r\n        else if (formData.caseNo) {\r\n            businessField.disabled = true;\r\n            caseNoField.disabled = false;\r\n        }\r\n        // 如果都沒選擇，則都啟用\r\n        else {\r\n            businessField.disabled = false;\r\n            caseNoField.disabled = false;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 清除business或caseNo的值並更新狀態\r\n */\r\nfunction clearFieldAndUpdateState(fieldType: 'business' | 'caseNo', modalType: 'create' | 'update') {\r\n    const formData = modalType === 'create' ? createFileData.value : updateFileData.value;\r\n    const modalRef = modalType === 'create' ? createModalRef.value : updateModalRef.value;\r\n\r\n    if (fieldType === 'business') {\r\n        formData.business = '';\r\n        modalRef?.clearFieldError('business');\r\n    } else {\r\n        formData.caseNo = '';\r\n        modalRef?.clearFieldError('caseNo');\r\n    }\r\n\r\n    updateFieldDisabledState(modalType);\r\n}\r\n\r\n/**\r\n * 處理文件類型選擇\r\n */\r\nfunction handleDocTypeSelect(docType: number, docName: string) {\r\n    // 檢查哪個模態框正在顯示\r\n    if (createModal.value.showModal) {\r\n        createFileData.value.docType = docType;\r\n        createFileData.value.docName = docName;\r\n        // 使用 JsonFormModal 的方法清除錯誤訊息\r\n        createModalRef.value?.clearFieldError('docType');\r\n    } else if (updateModal.value.showModal) {\r\n        updateFileData.value.docType = docType;\r\n        updateFileData.value.docName = docName;\r\n        // 使用 JsonFormModal 的方法清除錯誤訊息\r\n        updateModalRef.value?.clearFieldError('docType');\r\n    }\r\n}\r\n\r\n/**\r\n * @todo 新增檔案資訊提交處理\r\n * @param formData\r\n */\r\nasync function handleCreateSubmit(formData: Record<string, any>) {\r\n    try {\r\n        const fileInfoData = formData as FileInfosFormData;\r\n\r\n        // 檢查是否有上傳檔案\r\n        if (fileInfoData.fileUpload) {\r\n            console.log('上傳的檔案:', fileInfoData.fileUpload);\r\n            console.log('檔案名稱:', fileInfoData.fileUpload.name);\r\n            console.log('檔案大小:', fileInfoData.fileUpload.size);\r\n            console.log('檔案類型:', fileInfoData.fileUpload.type);\r\n\r\n            if (!fileInfoData.fileSrc) {\r\n                // 根據檔案類型決定處理方式\r\n                try {\r\n                    let fileSrc: string;\r\n\r\n                    // 判斷是否為圖片檔案\r\n                    const fileName = fileInfoData.fileUpload.name.toLowerCase();\r\n\r\n                    if (Common.IsImageFile(fileName)) {\r\n                        // 圖片檔案：進行壓縮處理\r\n                        console.log('處理圖片檔案:', fileName);\r\n                        const processedImage = await ImageHelper.ResizeImageBlobToBase64(\r\n                            fileInfoData.fileUpload,\r\n                            4096, // maxWidth\r\n                            4096, // maxHeight\r\n                            0.8, // quality\r\n                            8, // maxSizeMB\r\n                            'image/jpeg', // outputFormat\r\n                            false // allowNonImage - 只處理圖片\r\n                        );\r\n\r\n                        if (!processedImage) {\r\n                            await simplePopUp.showAlert(\r\n                                SimplePopUpModalType.Warning,\r\n                                '錯誤',\r\n                                '圖片處理失敗，請檢查圖片格式或大小'\r\n                            );\r\n                            return;\r\n                        }\r\n\r\n                        // 移除base64 marker\r\n                        fileSrc = Common.GetBase64Content(processedImage);\r\n                        fileInfoData.fileSrc = fileSrc;\r\n                    } else {\r\n                        // 非圖片檔案：直接轉Base64\r\n                        console.log('處理非圖片檔案:', fileName);\r\n                        fileSrc = (await Common.FileToBase64(fileInfoData.fileUpload)) ?? '';\r\n                        fileInfoData.fileSrc = Common.GetBase64Content(fileSrc);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('檔案處理失敗:', error);\r\n                    await simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', '檔案處理失敗，請稍後再試');\r\n                    return;\r\n                }\r\n            } else {\r\n                fileInfoData.fileSrc = (await Common.GetBase64Content(fileInfoData.fileSrc)) ?? '';\r\n            }\r\n        }\r\n\r\n        // 實作實際的檔案上傳 API 呼叫\r\n        const response = await API.FileInfosManagementCreate({\r\n            business: fileInfoData.business,\r\n            caseNo: fileInfoData.caseNo,\r\n            docType: fileInfoData.docType || 1,\r\n            fileName: fileInfoData.fileName,\r\n            fileSrc: fileInfoData.fileSrc,\r\n            isActive: fileInfoData.isActive,\r\n            filePermission: fileInfoData.filePermission,\r\n            description: fileInfoData.description,\r\n            isUseRetention: fileInfoData.isUseRetention,\r\n            deleteTime: fileInfoData.deleteTime,\r\n            uploadDate: fileInfoData.uploadDate,\r\n            isForceFileUpload: fileInfoData.isForceFileUpload\r\n        });\r\n\r\n        if (response.status) {\r\n            let successMessage = '檔案資訊新增成功！';\r\n\r\n            // 如果回傳結果包含詳細資訊，提供更詳細的訊息\r\n            if (response.result && response.result.fileInfo && response.result.fileInfo.length > 0) {\r\n                const fileInfo = response.result.fileInfo[0];\r\n                if (fileInfo.processOk) {\r\n                    successMessage += `\\n檔案序號: ${fileInfo.fileNo}`;\r\n                    if (fileInfo.moveFileTask) {\r\n                        const task = fileInfo.moveFileTask;\r\n                        if (task.insertOrUpdateRes && task.moveToNasRes) {\r\n                            successMessage += '\\n檔案已成功上傳至系統';\r\n                        } else if (!task.insertOrUpdateRes) {\r\n                            successMessage += '\\n警告: 資料庫操作失敗';\r\n                        } else if (!task.moveToNasRes) {\r\n                            successMessage += '\\n警告: 檔案移動失敗';\r\n                        }\r\n                    }\r\n                } else {\r\n                    successMessage += '\\n注意: 檔案處理過程中發生問題';\r\n                }\r\n            }\r\n\r\n            await simplePopUp.showAlert(SimplePopUpModalType.Success, '成功', successMessage);\r\n            createModal.value.showModal = false;\r\n            // 重新載入資料\r\n            await LoadViewData();\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error creating file info:', error);\r\n        // Handle error (e.g., show an error message)\r\n    }\r\n}\r\n\r\n// 搜尋檔案名稱 - 使用後端分頁，按鈕觸發\r\nconst handleSearch = async () => {\r\n    // 重置頁碼到第一頁\r\n    FileInfosData.currentPage = 1;\r\n    // 重新載入資料\r\n    await LoadViewData();\r\n};\r\n\r\n// 節流處理LoadViewData，避免按鈕被連續點擊\r\nconst throttledHandleSearch = Common.Throttle(handleSearch, 300);\r\n\r\nconst clearSearch = async () => {\r\n    FileInfosData.searchQuery = '';\r\n    // 重置頁碼到第一頁\r\n    FileInfosData.currentPage = 1;\r\n    // 重新載入資料\r\n    await LoadViewData();\r\n};\r\n\r\n/**\r\n * 處理編輯檔案資訊\r\n */\r\nasync function handleEdit(item: FileInfos) {\r\n    // 複製資料避免直接修改原始資料\r\n    updateFileData.value = {\r\n        fileNo: item.fileNo,\r\n        business: item.business,\r\n        caseNo: item.caseNo,\r\n        docType: item.docType || null,\r\n        docName: item.docName, // 這裡可能需要根據 docType 查詢名稱\r\n        isForceFileUpload: item.isForceFileUpload,\r\n        fileUpload: null,\r\n        fileSrc: null,\r\n        fileName: item.fileName,\r\n        isActive: item.isActive,\r\n        filePermission: item.filePermission,\r\n        description: item.description,\r\n        filePath: item.filePath,\r\n        isUseRetention: item.isUseRetention,\r\n        deleteTime: item.deleteTime,\r\n        uploadDate: item.uploadDate\r\n    };\r\n\r\n    // 設定文件上傳的 callback 來自動填入檔案名稱\r\n    const fileUploadField = getFieldsGridGroupById(updateModal.value, 'fileUpload');\r\n    if (fileUploadField && fileUploadField.type === 'file') {\r\n        fileUploadField.onInputCallback = async (value: File | File[] | null) => {\r\n            // 由於 multiple: false，所以應該是單個檔案\r\n            const file = Array.isArray(value) ? value[0] : value;\r\n            if (file && Common.IsImageFile(file.name)) {\r\n                // 縮圖 + 自定輸出格式  8MB Check\r\n                const src = await ImageHelper.ResizeImageBlobToBase64(file, 4096, 4096, 0.8, 8, 'image/jpeg', true);\r\n                if (!src) {\r\n                    return;\r\n                }\r\n                updateFileData.value.fileSrc = src;\r\n                updateFileData.value.fileName = file.name;\r\n            } else if (file && !Common.IsImageFile(file.name)) {\r\n                updateFileData.value.fileSrc = await Common.FileToBase64(file);\r\n                updateFileData.value.fileName = file.name;\r\n            } else {\r\n                updateFileData.value.fileSrc = '';\r\n                updateFileData.value.fileName = '';\r\n            }\r\n        };\r\n    }\r\n\r\n    // 設定業務別欄位的點擊事件\r\n    const businessFieldUpdate = getFieldsGridGroupById(updateModal.value, 'business');\r\n    if (businessFieldUpdate && businessFieldUpdate.type === 'text') {\r\n        businessFieldUpdate.onClickCallback = () => {\r\n            // 如果欄位被停用，不執行任何操作\r\n            if (businessFieldUpdate.disabled) {\r\n                return;\r\n            }\r\n            businessSelectModal.value?.openModal();\r\n        };\r\n        businessFieldUpdate.onClearInput = () => {\r\n            // 雙擊清除業務別\r\n            clearFieldAndUpdateState('business', 'update');\r\n        };\r\n    }\r\n\r\n    // 設定文件類別序號欄位的點擊事件\r\n    const caseNoFieldUpdate = getFieldsGridGroupById(updateModal.value, 'caseNo');\r\n    if (caseNoFieldUpdate && caseNoFieldUpdate.type === 'text') {\r\n        caseNoFieldUpdate.onClickCallback = () => {\r\n            // 如果欄位被停用，不執行任何操作\r\n            if (caseNoFieldUpdate.disabled) return;\r\n            fileCaseSelectModal.value?.openModal();\r\n        };\r\n        caseNoFieldUpdate.onClearInput = () => {\r\n            // 雙擊清除檔案案件\r\n            clearFieldAndUpdateState('caseNo', 'update');\r\n        };\r\n    }\r\n\r\n    // 設定文件類型欄位的點擊事件\r\n    const docTypeFieldUpdate = updateModal.value.fieldGroups[0].fields.find((f: any) => f.modelId === 'docType');\r\n    if (docTypeFieldUpdate && docTypeFieldUpdate.type === 'text') {\r\n        docTypeFieldUpdate.onClickCallback = () => {\r\n            docTypeSelectModal.value?.openModal();\r\n        };\r\n    }\r\n\r\n    // 設定定期刪除相關欄位的監聽事件\r\n    const isUseRetentionField = updateModal.value.fieldGroups[1].fields.find(\r\n        (f: any) => f.modelId === 'isUseRetention'\r\n    );\r\n    if (isUseRetentionField && isUseRetentionField.type === 'radio') {\r\n        isUseRetentionField.onChangeCallback = (value: string | boolean | number) => {\r\n            // 直接使用 DOM 操作來啟用/停用欄位\r\n            const boolValue = value === true || value === 'true' || value === 1 || value === '1';\r\n            setTimeout(() => {\r\n                const deleteTimeInput = document.querySelector('#deleteTime') as HTMLInputElement;\r\n                const uploadDateInput = document.querySelector('#uploadDate') as HTMLInputElement;\r\n\r\n                if (deleteTimeInput) {\r\n                    deleteTimeInput.disabled = !boolValue;\r\n                }\r\n                if (uploadDateInput) {\r\n                    uploadDateInput.disabled = !boolValue;\r\n                }\r\n            }, 50);\r\n        };\r\n    }\r\n\r\n    updateModal.value.showModal = true;\r\n\r\n    // 初始化欄位狀態\r\n    updateFieldDisabledState('update');\r\n    nextTick();\r\n}\r\n\r\n/**\r\n * 處理編輯提交\r\n */\r\nasync function handleEditSubmit(formData: Record<string, any>) {\r\n    try {\r\n        const updateData = formData as UpdateFileInfosFormData;\r\n\r\n        // 檢查是否有上傳新檔案\r\n        // 檢查是否有上傳檔案\r\n        if (updateData.fileUpload) {\r\n            console.log('上傳的檔案:', updateData.fileUpload);\r\n            console.log('檔案名稱:', updateData.fileUpload.name);\r\n            console.log('檔案大小:', updateData.fileUpload.size);\r\n            console.log('檔案類型:', updateData.fileUpload.type);\r\n\r\n            if (!updateData.fileSrc) {\r\n                // 根據檔案類型決定處理方式\r\n                try {\r\n                    let fileSrc: string;\r\n\r\n                    // 判斷是否為圖片檔案\r\n                    const fileName = updateData.fileUpload.name.toLowerCase();\r\n\r\n                    if (Common.IsImageFile(fileName)) {\r\n                        // 圖片檔案：進行壓縮處理\r\n                        console.log('處理圖片檔案:', fileName);\r\n                        const processedImage = await ImageHelper.ResizeImageBlobToBase64(\r\n                            updateData.fileUpload,\r\n                            4096, // maxWidth\r\n                            4096, // maxHeight\r\n                            0.8, // quality\r\n                            8, // maxSizeMB\r\n                            'image/jpeg', // outputFormat\r\n                            false // allowNonImage - 只處理圖片\r\n                        );\r\n\r\n                        if (!processedImage) {\r\n                            await simplePopUp.showAlert(\r\n                                SimplePopUpModalType.Warning,\r\n                                '錯誤',\r\n                                '圖片處理失敗，請檢查圖片格式或大小'\r\n                            );\r\n                            return;\r\n                        }\r\n\r\n                        // 移除base64 marker\r\n                        fileSrc = ImageHelper.GetBase64Content(processedImage);\r\n                    } else {\r\n                        // 非圖片檔案：直接轉Base64\r\n                        console.log('處理非圖片檔案:', fileName);\r\n                        updateData.fileSrc = (await Common.FileToBase64(updateData.fileUpload)) ?? '';\r\n                    }\r\n                } catch (error) {\r\n                    console.error('檔案處理失敗:', error);\r\n                    await simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', '檔案處理失敗，請稍後再試');\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (updateData.fileUpload) {\r\n            console.log('更新時上傳的檔案:', updateData.fileUpload);\r\n            console.log('檔案名稱:', updateData.fileUpload.name);\r\n            console.log('檔案大小:', updateData.fileUpload.size);\r\n            console.log('檔案類型:', updateData.fileUpload.type);\r\n\r\n            // 這裡可以實作檔案上傳邏輯\r\n            // 例如：使用 FormData 上傳檔案到後端\r\n            const uploadData = new FormData();\r\n            uploadData.append('file', updateData.fileUpload);\r\n            uploadData.append('fileName', updateData.fileName);\r\n            uploadData.append('caseNo', updateData.caseNo);\r\n            uploadData.append('fileNo', updateData.fileNo);\r\n            uploadData.append('isActive', updateData.isActive?.toString() ?? '');\r\n            uploadData.append('isForceFileUpload', updateData.isForceFileUpload?.toString() ?? '');\r\n            uploadData.append('isUseRetention', updateData.isUseRetention?.toString() ?? '');\r\n            uploadData.append('filePermission', updateData.filePermission?.toString() ?? 0);\r\n\r\n            if (updateData.description) {\r\n                uploadData.append('description', updateData.description);\r\n            }\r\n            if (updateData.deleteTime) {\r\n                uploadData.append('deleteTime', updateData.deleteTime);\r\n            }\r\n            if (updateData.uploadDate) {\r\n                uploadData.append('uploadDate', updateData.uploadDate);\r\n            }\r\n\r\n            // TODO: 實作實際的檔案上傳 API 呼叫\r\n            // await API.updateFileWithUpload(uploadData);\r\n        }\r\n\r\n        const response = await API.FileInfosManagementUpdate({\r\n            business: updateData.business,\r\n            caseNo: updateData.caseNo,\r\n            docType: updateData.docType || 1,\r\n            fileSrc: updateData.fileSrc ? Common.GetBase64Content(updateData.fileSrc) : '',\r\n            fileNo: updateData.fileNo,\r\n            fileName: updateData.fileName,\r\n            isActive: updateData.isActive,\r\n            filePermission: updateData.filePermission,\r\n            description: updateData.description,\r\n            isUseRetention: updateData.isUseRetention,\r\n            deleteTime: updateData.deleteTime\r\n        });\r\n\r\n        if (response.status) {\r\n            let successMessage = '檔案資訊新增成功！';\r\n\r\n            // 如果回傳結果包含詳細資訊，提供更詳細的訊息\r\n            if (response.result && response.result.fileInfo && response.result.fileInfo.length > 0) {\r\n                const fileInfo = response.result.fileInfo[0];\r\n                if (fileInfo.processOk) {\r\n                    successMessage += `\\n檔案序號: ${fileInfo.fileNo}`;\r\n                    if (fileInfo.moveFileTask) {\r\n                        const task = fileInfo.moveFileTask;\r\n                        if (task.insertOrUpdateRes && task.moveToNasRes) {\r\n                            successMessage += '\\n檔案已成功上傳至系統';\r\n                        } else if (!task.insertOrUpdateRes) {\r\n                            successMessage += '\\n警告: 資料庫操作失敗';\r\n                        } else if (!task.moveToNasRes) {\r\n                            successMessage += '\\n警告: 檔案移動失敗';\r\n                        }\r\n                    }\r\n                } else {\r\n                    successMessage += '\\n注意: 檔案處理過程中發生問題';\r\n                }\r\n            }\r\n\r\n            await simplePopUp.showAlert(SimplePopUpModalType.Success, '成功', successMessage);\r\n            updateModal.value.showModal = false;\r\n            // 重新載入資料\r\n            await LoadViewData();\r\n        } else {\r\n            ApiClient.HandleGeneralRespError(response);\r\n        }\r\n    } catch (error) {\r\n        console.error('更新檔案資訊時發生錯誤:', error);\r\n        await simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', '更新檔案資訊時發生錯誤，請稍後再試。');\r\n    }\r\n}\r\n\r\n/**\r\n * 處理刪除檔案資訊\r\n */\r\nasync function handleDelete(item: FileInfos) {\r\n    const action: SimplePopupResolveResult<string> = await simplePopUp.showAlert(\r\n        SimplePopUpModalType.Warning,\r\n        '確認刪除',\r\n        `確定要刪除檔案「${item.fileName}」嗎？此操作無法復原。`,\r\n        [\r\n            {\r\n                id: 'cancel',\r\n                type: SimplePopUpBtnType.callback,\r\n                btnClass: 'btn-esun-outline',\r\n                resolveParam: 'cancel',\r\n                title: '取消'\r\n            },\r\n            {\r\n                id: 'confirm',\r\n                type: SimplePopUpBtnType.callback,\r\n                btnClass: 'btn-danger',\r\n                resolveParam: 'confirm',\r\n                title: '確定刪除'\r\n            }\r\n        ]\r\n    );\r\n\r\n    if (action.param === 'confirm') {\r\n        try {\r\n            const response = await API.FileInfosManagementDelete(item.fileNo);\r\n\r\n            if (response.status) {\r\n                await simplePopUp.showAlert(SimplePopUpModalType.Success, '成功', '檔案資訊刪除成功！');\r\n                // 重新載入資料\r\n                await LoadViewData();\r\n            } else {\r\n                ApiClient.HandleGeneralRespError(response);\r\n            }\r\n        } catch (error) {\r\n            console.error('刪除檔案資訊時發生錯誤:', error);\r\n            await simplePopUp.showAlert(SimplePopUpModalType.Warning, '錯誤', '刪除檔案資訊時發生錯誤，請稍後再試。');\r\n        }\r\n    }\r\n}\r\n</script>\r\n"],"names":["GetCreateFileInfosModal","value","formData","error","Common.IsValidDateTime","GetDefaultFormData","GetUpdateFileInfosModal","GetDefaultUpdateFormData","getFieldsGridGroupById","myModal","lookupId","group","field","SelectModal","ref","GetDefaultSelectModal","searchInput","watch","LoadViewData","openModal","closeModal","handleBackgroundClick","event","response","API","item","ApiClient.HandleGeneralRespError","throttledLoadViewData","Common.Throttle","selectBusiness","emit","formatDate","dateString","e","handleSearch","clearSearch","__emit","__expose","_createElementBlock","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_hoisted_6","_hoisted_7","$event","_hoisted_8","_normalizeClass","_cache","_hoisted_9","_openBlock","_hoisted_10","_Fragment","index","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_createBlock","Pagination","_hoisted_22","_a","selectFileCase","getPermissionText","permission","selectDocType","showModal","animateBackdrop","loading","imageData","fileName","currentFileInfo","fileInfo","blob","imageUrl","err","downloadImage","url","link","_hoisted_1","simplePopUp","SimplePopUp","ResizeImageToBase64","srcType","base64Src","maxWidth","maxHeight","imgQuality","imageMaxSizeMb","mimeType","isShowPopUp","FileToBase64","img","Common.Base64ToImage","canvas","context","src","fileSizeInBytes","getBase64Size","maxSize","SimplePopUpModalType","SimplePopUpBtnType","Common.ConsoleLog","ResizeImageBlobToBase64","GetBase64Content","data","base64Marker","base64Index","base64String","base64Data","commaIndex","padding","file","resolve","reject","reader","FileInfosData","reactive","onMounted","handlePreviewOrDownLoad","Common.IsImageFile","imagePreviewModal","downloadFile","loadingAlert","createFileData","businessSelectModal","fileCaseSelectModal","docTypeSelectModal","createModal","createModalRef","updateFileData","updateModal","updateModalRef","openCreateModal","fileUploadField","ImageHelper.ResizeImageBlobToBase64","fileSrc","Common.GetBase64Content","_b","Common.FileToBase64","businessField","clearFieldAndUpdateState","caseNoField","docTypeField","isUseRetentionField","boolValue","deleteTimeInput","uploadDateInput","updateFieldDisabledState","nextTick","handleBusinessSelect","business","_c","_d","handleFileCaseSelect","caseNo","modalType","fieldType","modalRef","handleDocTypeSelect","docType","docName","handleCreateSubmit","fileInfoData","processedImage","successMessage","task","throttledHandleSearch","handleEdit","businessFieldUpdate","caseNoFieldUpdate","docTypeFieldUpdate","f","handleEditSubmit","updateData","ImageHelper.GetBase64Content","uploadData","_e","_g","_f","_i","_h","handleDelete","_unref","_vModelText","args","JsonFormModal","_createVNode","BusinessSelectModal","FileCaseSelectModal","DocTypeSelectModal","ImagePreviewModal","_renderList","_withModifiers"],"mappings":"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"}